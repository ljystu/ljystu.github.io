/*! For license information please see c__LazyDocListViewer.998b48ec.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[67,102],{3147:function(t,e,r){"use strict";e.a={wrapper:"TransferDoc-module_wrapper_+Jtte",tip:"TransferDoc-module_tip_lNpqo"}},320:function(t,e,r){"use strict";r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return u}));var n=r(356),o=r.n(n),i=o()(window.appData&&window.appData.defaultSpaceHost).host;i=i.split(".").slice(-2).join(".");var a={relocate:function(t,e){e?setTimeout((function(){window.location.href=a.normalize(t)}),e):window.location.href=a.normalize(t)},normalize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",e=o()(t).host||"";if(e){if(e===window.location.host)return t;if(e===i)return t;if(!e.endsWith(i))return"/";var r=e.slice(0,-i.length);return/^[.a-zA-Z0-9_-]+\.$/.test(r)?t:"/"}return"/"!==t[0]&&(t="/".concat(t)),t}},c=(a.normalize,a.relocate);function u(){var t=window.location.hash,e=decodeURIComponent(t.split("#")[1]),r=document.getElementById(e);r&&r.scrollIntoView()}},3204:function(t,e,r){"use strict";r(92);var n=r(45),o=(r(63),r(23)),i=r(0),a=r.n(i),c=r(2),u=r.n(c),l=r(125),s=r(33),f=r(2928),d=r(3147);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(){h=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new k(o||[]);return n(a,"_invoke",{value:_(t,r,c)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function d(){}function y(){}function m(){}var v={};u(v,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(D([])));b&&b!==e&&r.call(b,i)&&(v=b);var w=m.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(n,i,a,c){var u=s(t[n],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==p(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function _(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=S(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function D(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return y.prototype=m,n(w,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:y,configurable:!0}),y.displayName=u(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},E(O.prototype),u(O.prototype,a,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=D,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:D(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==p(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===p(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function b(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){g(i,n,o,a,c,"next",t)}function c(t){g(i,n,o,a,c,"throw",t)}a(void 0)}))}}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var O=window.appData.isDesktopApp,_=function(t){var e,r=t.docIds,c=t.book,u=t.submitType,p=t.container,y=t.silentOperation,v=w(Object(i.useState)(!0),2),g=v[0],E=v[1],_=function(){E(!1),t.hide()},S=function(t){var e="highlightBookImport_".concat(t.slug,"_").concat(t.id);l.a.set(e,t.last_toc?t.last_toc.uuid:"_")},j=function(){var e=b(h().mark((function e(n){var i,u,l,f,d,p,v,g,b,w,E;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.targetBook,u=n.targetGroup,l=n.target_uuid,f=n.action,d=n.insert_to_catalog,e.next=3,s.a.docs.copy({ids:r,book_id:c.id,target_book_id:i.id,target_node_uuid:l,action:f,insert_to_catalog:d});case 3:p=e.sent,v=p.docs,g=p.toc,t.onSubmit({targetBook:m(m({},i),{},{toc:g}),docs:v}),b=c.id===i.id,y||(w=v[0],E=w?"/go/doc/".concat(v[0].id):"/".concat(u.login,"/").concat(i.slug),o.a.success(a.a.createElement("span",null,O||b?__("复制成功"):a.a.createElement(a.a.Fragment,null,__("已复制到："),a.a.createElement("a",{href:E,target:"_blank"},i.name))),3)),_();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=b(h().mark((function e(n){var i,u,l,f,d,p,v;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.targetGroup,u=void 0===i?{}:i,l=n.targetBook,f=void 0===l?{}:l,d=n.target_uuid,p=n.action,e.next=3,s.a.docs.addToCatalog({ids:r,book_id:c.id,target_node_uuid:d,action:p});case 3:return v=e.sent,e.next=6,t.onSubmit({targetBook:m(m({},f),{},{toc:v})});case 6:y||o.a.success(a.a.createElement(a.a.Fragment,null,__("已成功添加到目录")," ",!O&&a.a.createElement("a",{href:"/".concat(u.login,"/").concat(f.slug),target:"_blank"},__("查看"))),3),_();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=b(h().mark((function e(n){var i,u,l,f,d,p,m,v;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.targetGroup,u=void 0===i?{}:i,l=n.targetBook,f=void 0===l?{}:l,d=n.target_uuid,p=n.action,m=n.insert_to_catalog,f.id!==c.id){e.next=3;break}return e.abrupt("return",x(n));case 3:return e.next=5,s.a.docs.move({ids:r,book_id:c.id,target_book_id:f.id,target_node_uuid:d,action:p,insert_to_catalog:m});case 5:(v=e.sent).targetBook&&S(v.targetBook),t.onSubmit({docIds:r,targetBook:f}),y||(o.a.success(a.a.createElement("span",null,__("已移动到："),a.a.createElement("a",{href:"/".concat(u.login,"/").concat(f.slug),target:"_blank"},f.name)),3),_());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D="move"===u,T="add"===u;return e=T?__("添加到目录"):__("{submitType}到...",{submitType:D?__("移动"):__("复制")}),a.a.createElement(n.a,{className:d.a.wrapper,title:e,visible:g,width:"600px",footer:null,onCancel:_,getContainer:p},T?null:a.a.createElement("div",{className:d.a.tip},__("可{submitType}到有创建权限的知识库",{submitType:D?__("移动"):__("复制")})),a.a.createElement(f.a,{items:r.map((function(t){return{doc_id:t}})),currentGroup:t.group,currentBook:t.book,disableSelectorBooks:D?[t.book]:[],submitType:u,mode:"doc",onSubmit:function(t){return T?x(t):D?k(t):j(t)},onCancel:_,showRepoSelector:!T}))};_.defaultProps={onSubmit:function(){},silentOperation:!1},_.propTypes={docIds:u.a.array.isRequired,group:u.a.object.isRequired,book:u.a.object.isRequired,hide:u.a.func.isRequired,onSubmit:u.a.func,submitType:u.a.oneOf(["move","copy","add"]).isRequired,silentOperation:u.a.bool},_.displayName="TransferDoc",e.a=_},363:function(t,e,r){"use strict";var n=r(320);r.d(e,"a",(function(){return n.a})),r.d(e,"b",(function(){return n.b}))},4350:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return Lt}));var n=r(0),o=r.n(n),i=r(570),a=r(57),c=r(2),u=r.n(c),l=r(363),s=r(3256),f=r(3230),d=r(3740),p=r(2912),h=r(3204),y=r(44);function m(t){var e=t.activeModalType,r=t.group,n=t.book,i=t.candidateDocIds,a=t.singleCandidateDoc,c=t.onAddSubmitSuccess,u=t.onCopyDocsSuccess,l=t.onMoveDocsSuccess,s=t.onCancel;return o.a.createElement(o.a.Fragment,null,y.a.CATALOG.add.cmd===e&&o.a.createElement(h.a,{silentOperation:!0,docIds:i,group:r,book:n,submitType:"add",hide:s,onSubmit:c}),y.a.DOC.move.cmd===e&&o.a.createElement(h.a,{docIds:i,group:r,book:n,submitType:"move",hide:s,onSubmit:l}),y.a.DOC.copy.cmd===e&&o.a.createElement(h.a,{docIds:i,group:r,book:n,submitType:"copy",hide:s,onSubmit:u}),y.a.DOC.export_doc.cmd===e&&o.a.createElement(p.a,{visible:!0,doc:a,bookId:n.id,onCancel:s}))}m.propTypes={activeModalType:u.a.oneOf([y.a.CATALOG.add.cmd,y.a.DOC.move.cmd,y.a.DOC.copy.cmd,y.a.DOC.export_doc.cmd,null]),book:u.a.object.isRequired,candidateDocIds:u.a.arrayOf(u.a.number).isRequired,singleCandidateDoc:u.a.object,group:u.a.object.isRequired,onCancel:u.a.func.isRequired,onAddSubmitSuccess:u.a.func.isRequired,onCopyDocsSuccess:u.a.func.isRequired,onMoveDocsSuccess:u.a.func.isRequired};var v=m,g=(r(92),r(45)),b=(r(63),r(23)),w=r(288),E=r.n(w),O=r(314),_=r(878),S=r(33);function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function k(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){D(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function D(t,e,r){return e=function(t){var e=function(t,e){if("object"!==j(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===j(e)?e:String(e)}(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T(){T=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new x(o||[]);return n(a,"_invoke",{value:E(t,r,c)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function d(){}function p(){}function h(){}var y={};u(y,i,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(k([])));v&&v!==e&&r.call(v,i)&&(y=v);var g=h.prototype=d.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var u=s(t[n],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==j(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return D()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=O(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function k(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:D}}function D(){return{value:void 0,done:!0}}return p.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:p,configurable:!0}),p.displayName=u(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,u(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,c,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function L(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function I(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){L(i,n,o,a,c,"next",t)}function c(t){L(i,n,o,a,c,"throw",t)}a(void 0)}))}}function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return A(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function P(){}function N(t){var e=t.group,r=t.book,o=t.docs,i=t.updateDocs,a=void 0===i?P:i,c=t.updateToc,u=void 0===c?P:c,s=t.updateDoc,f=void 0===s?P:s,d=t.onAddToCatalogSuccess,p=void 0===d?P:d,h=t.scrollToItem,m=t.history,v=C(Object(n.useState)(null),2),w=v[0],j=v[1],x=C(Object(n.useState)([]),2),D=x[0],L=x[1],A=D[0]&&o.find((function(t){return t.id===D[0]})),N=C(Object(n.useState)(null),2),R=N[0],q=N[1],G=function(){L([])},F=function(t){j(t)},M=function(){j(null)};var B=function(t){e.abilities.update?(L(t.map((function(t){return t.id}))),F(y.a.DOC.move.cmd)):function(t){g.a.warning({title:__("非法操作"),content:__("仅管理员可转移{type}到其它知识库",{type:_.a.getTypeText(t)})})}(t[0].type)},V=function(){var t=I(T().mark((function t(e){var n,i,c,l,s;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.docId,i=e.title,t.prev=1,t.next=4,S.a.docs.updateMeta({id:n,title:i});case 4:c=o.map((function(t){return n===t.id?k(k({},t),{},{title:i}):t})),f(n,{title:i}),a(c),l=o.find((function(t){return t.id===n})),s=r.toc.map((function(t){return t.id===n||t.url===l.slug?k(k({},t),{},{title:i}):t})),u(s),q(null),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),b.a.error(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}(),U=function(){var t=I(T().mark((function t(e){var r;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.targetBook,u(r.toc),a(r.docs),M(),p(A),b.a.success(__("已成功添加到目录")),G();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=I(T().mark((function t(e){var n,i;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.targetBook).id===r.id?u(n.toc):(i=o.filter((function(t){return!D.includes(t.id)})),a(i)),G(),M();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=I(T().mark((function t(e){var n,i,c;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.targetBook,i=e.docs,r.id===n.id&&(a(o.concat(i)),u(n.toc),(c=i[0])&&(m.push("/".concat(r.namespace,"/").concat(c.slug)),h(c.id))),G(),M();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{state:{activeModalType:w,candidateDocIds:D,singleCandidateDoc:A,editingDocId:R},showModalByType:F,setCandidateDocIds:L,clearEditing:function(){q(null)},actionExecutor:function(t,n){var i,c,u,s,f,d,p,h,m,v,w,_,j,x=n.docs;switch(t){case y.a.DOC.copyLink.cmd:m=x[0],v=window.location,w=v.protocol,_=v.host,j="".concat(w,"//").concat(_,"/").concat(e.login,"/").concat(r.slug,"/").concat(m.slug),E()(j),b.a.success(__("链接复制成功"));break;case y.a.CATALOG.add.cmd:h=x,F(y.a.CATALOG.add.cmd),L(h.map((function(t){return t.id})));break;case y.a.DOC.copy.cmd:L(x.map((function(t){return t.id}))),F(y.a.DOC.copy.cmd);break;case y.a.DOC.move.cmd:B(x);break;case y.a.DOC.export_doc.cmd:!function(t){L([t.id]),F(y.a.DOC.export_doc.cmd)}(x[0]);break;case y.a.DOC.unshare.cmd:!function(t){L(t.map((function(t){return t.id})));var e=t.filter((function(t){return t.share&&t.share.status===O.STATUS.active})).map((function(t){return{target_type:"Doc",target_id:t.id}}));if(e.length){var r,n=__("确认关闭这 {count} 个文档的分享吗？",{count:e.length});g.a.confirm({title:n,onOk:(r=I(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.a.shares.batchUpdate({targets:e,status:O.STATUS.inactive});case 2:b.a.success(__("关闭分享成功")),G();case 4:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})})}else b.a.warn(__("请选择开启了分享的文档"))}(x);break;case y.a.DOC.delete.cmd:i=x,c={onOk:n.onOk},s=c.onOk,f=void 0===s?P:s,d=i.map((function(t){return t.id})),p=__("确认删除这 {count} 个文档？",{count:d.length}),g.a.confirm({title:p,content:__("删除后可在知识库回收站中恢复"),onOk:(u=I(T().mark((function t(){var e;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.a.docs.destroyMulti({ids:d,book_id:r.id});case 2:e=o.filter((function(t){return!d.includes(t.id)})),a(e),f();case 5:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})});break;case y.a.CATALOG.rename.cmd:!function(t){q(t.id)}(x[0]);break;case y.a.DOC.edit.cmd:!function(t){Object(l.b)("/".concat(e.login,"/").concat(r.slug,"/").concat(t.slug,"/edit"))}(x[0])}},handleCancel:function(){G(),M()},handleAddSubmitSuccess:U,handleCopyDocsSuccess:W,handleMoveDocsSuccess:z,handleEditTitleEnd:V}}N.propTypes={group:u.a.object.isRequired,book:u.a.object.isRequired,docs:u.a.arrayOf(u.a.object).isRequired,updateDocs:u.a.func,updateToc:u.a.func,updateDoc:u.a.func};var R=N;function q(t){var e=t.children,r=t.group,n=t.book,i=t.docs,a=t.toc,c=t.updateDocs,u=t.updateToc,l=t.updateDoc,s=t.onAddToCatalogSuccess,f=t.scrollToItem,d=t.history,p=R({group:r,book:n,docs:i,toc:a,updateDocs:c,updateToc:u,updateDoc:l,onAddToCatalogSuccess:s,history:d,scrollToItem:f}),h=p.state,y=h.activeModalType,m=h.candidateDocIds,g=h.singleCandidateDoc,b=h.editingDocId,w=p.actionExecutor,E=p.handleCancel,O=p.clearEditing,_=p.handleAddSubmitSuccess,S=p.handleCopyDocsSuccess,j=p.handleMoveDocsSuccess,x=p.handleEditTitleEnd;return o.a.createElement(o.a.Fragment,null,e({actionExecutor:w,editingDocId:b,clearEditing:O,handleEditTitleEnd:x}),o.a.createElement(v,{activeModalType:y,group:r,book:n,candidateDocIds:m,singleCandidateDoc:g,onCancel:E,onAddSubmitSuccess:_,onCopyDocsSuccess:S,onMoveDocsSuccess:j}))}q.propTypes={group:u.a.object.isRequired,book:u.a.object.isRequired,docs:u.a.arrayOf(u.a.object).isRequired,toc:u.a.arrayOf(u.a.object).isRequired,history:u.a.object.isRequired,scrollToItem:u.a.func.isRequired,updateDocs:u.a.func.isRequired,updateToc:u.a.func.isRequired,updateDoc:u.a.func.isRequired,onAddToCatalogSuccess:u.a.func,children:u.a.func.isRequired};var G=q,F=r(9),M=r.n(F),B=r(264),V=r(30),U=(r(279),r(136)),z=(r(166),r(31)),W=r(3105),K={menuItemContent:"menu-module_menuItemContent_F-sRQ",iconWrapper:"menu-module_iconWrapper_kNvaM"};function Y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return $(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function H(t){var e=t.children,r=t.book,i=t.doc,a=t.actionExecutor,c=t.onVisibleChange,u=Y(Object(n.useState)(!1),2),l=u[0],s=u[1],f=B.a.docListActionsInReaderPage(r,i),d=Object(n.useRef)();return o.a.createElement(U.a,{type:"menu",overlayStyle:{minWidth:126},trigger:["click"],hideWhenInactive:!0,autoAdjustOverflow:!0,arrowPointAtCenter:!0,hiddenWhenInactive:!0,visible:l,onVisibleChange:function(t){s(t),"function"==typeof c&&c(t)},getPopupContainer:function(){var t;return(null===(t=d.current)||void 0===t?void 0:t.closest("[".concat(W.c,"]")))||document.body},content:o.a.createElement(z.a,{onClick:function(t){t.domEvent.preventDefault(),t.domEvent.stopPropagation(),s(!1),t.key!==y.a.DOC.divide.cmd&&a(t.key,{docs:[i]})}},f.map((function(t,e){return t.cmd===y.a.DOC.divide.cmd?o.a.createElement(z.a.Divider,{key:t.cmd+e}):o.a.createElement(z.a.Item,{key:t.cmd},o.a.createElement("div",{className:K.menuItemContent},o.a.createElement("span",{className:K.iconWrapper},o.a.createElement(V.b,{name:t.icon,width:16,height:16})),o.a.createElement("span",{className:K.title},t.title)))})))},o.a.cloneElement(e,{ref:d}))}H.propTypes={book:u.a.object.isRequired,doc:u.a.object.isRequired,actionExecutor:u.a.func.isRequired,onVisibleChange:u.a.func};var J=H,Z=(r(104),r(38));function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function X(){X=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:E(t,r,c)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function d(){}function p(){}function h(){}var y={};u(y,i,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(x([])));v&&v!==e&&r.call(v,i)&&(y=v);var g=h.prototype=d.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var u=s(t[n],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==Q(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=O(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function x(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:k}}function k(){return{value:void 0,done:!0}}return p.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:p,configurable:!0}),p.displayName=u(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,u(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),u(g,c,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=x,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function tt(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function et(t){var e=t.isEditing,r=t.clearEditing,o=t.onEditEnd,i=t.title,a=t.docId,c=Object(n.useRef)(null),u=function(){var t,e=(t=X().mark((function t(e){var n;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e.target.value)!==i){t.next=4;break}return r(),t.abrupt("return");case 4:if(n){t.next=9;break}return b.a.error(__("名称不能为空")),c.current.focus(),r(),t.abrupt("return");case 9:return t.next=11,o({docId:a,title:n});case 11:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){tt(i,n,o,a,c,"next",t)}function c(t){tt(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}();return{inputRef:c,handleKeyUp:function(t){"Escape"!==t.key&&27!==t.keyCode||u(t)},handleEditEnd:u,handleFocus:function(t){e&&t.target.select()}}}function rt(t){var e=t.doc,r=t.isEditing,n=t.onEditEnd,i=t.clearEditing,a=et({docId:e.id,title:e.title,clearEditing:i,onEditEnd:n}),c=a.inputRef,u=a.handleFocus,l=a.handleKeyUp,s=a.handleEditEnd;return r?o.a.createElement(Z.a,{ref:c,autoFocus:!0,defaultValue:e.title,onPressEnter:s,onKeyUp:l,onBlur:s,onFocus:u,onClick:function(t){t.stopPropagation(),t.preventDefault()}}):o.a.createElement("span",null,e.title)}rt.defaultProps={onEditEnd:function(){}},rt.propTypes={doc:u.a.object.isRequired,isEditing:u.a.bool.isRequired,clearEditing:u.a.func.isRequired,onEditEnd:u.a.func};var nt=rt,ot="DocListItem-module_titleDescItem_5i1OT",it="DocListItem-module_itemContent_+9eRg",at="DocListItem-module_head_xKk+B",ct="DocListItem-module_title_u75Ej",ut="DocListItem-module_slugActive_tPuA6",lt="DocListItem-module_actionsCont_v8h3R",st="DocListItem-module_actionsContVisible_u4Ofk",ft="DocListItem-module_menuTrigger_lf85O",dt="DocListItem-module_icon_Bo-tN",pt="DocListItem-module_desc_0ZK5z";function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function yt(t,e,r){return e=function(t){var e=function(t,e){if("object"!==ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ht(e)?e:String(e)}(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return vt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gt(t){var e=t.book,r=t.doc,i=t.actionExecutor,c=t.isEditing,u=t.isSlugActive,l=t.clearEditing,s=t.onEditEnd,f=(t.isDocNotInToc,function(t){var e=t.book,r=t.doc,o=t.actionExecutor,i=mt(Object(n.useState)(!1),2),a=i[0],c=i[1],u=B.a.adminActions(e,r,!0);return{state:{url:"/".concat(e.namespace,"/").concat(r.slug),tempStoreActionsVisible:u.length>0,menuVisible:a,setMenuVisible:c},handleAddToCatalog:function(){return o(y.a.CATALOG.add.cmd,{docs:[r]})}}}(t)),d=f.state,p=d.url,h=d.tempStoreActionsVisible,m=d.menuVisible,v=d.setMenuVisible,g=function(){if(!c&&h)return o.a.createElement(J,{book:e,doc:r,actionExecutor:i,onVisibleChange:v},o.a.createElement("span",{className:ft},o.a.createElement(V.b,{name:"more",width:16,className:dt})))};return o.a.createElement("div",{className:ot},o.a.createElement(a.NavLink,{to:p,className:M()(it,yt({},ut,u)),onClick:function(t){if(t.metaKey){t.preventDefault();var e=document.createElement("a");e.setAttribute("target","_blank"),e.setAttribute("href",p),e.click()}}},o.a.createElement("div",{className:M()(at,yt({},ut,u))},o.a.createElement("div",{className:ct},o.a.createElement(nt,{isEditing:c,url:p,doc:r,clearEditing:l,onEditEnd:s})),o.a.createElement("div",{className:M()(lt,yt({},st,m)),onClick:function(t){return t.preventDefault()}},g())),o.a.createElement("div",{className:pt},r.custom_description||r.description)))}gt.defaultProps={onEditEnd:function(){}},gt.propTypes={actionExecutor:u.a.func,book:u.a.object.isRequired,doc:u.a.object.isRequired,isSlugActive:u.a.bool.isRequired,isEditing:u.a.bool.isRequired,clearEditing:u.a.func.isRequired,onEditEnd:u.a.func,isDocNotInToc:u.a.bool};var bt=o.a.memo(gt),wt="docList-module_docList_cSBI2";var Et=new Intl.Collator(void 0,{numeric:!0});function Ot(t,e){return new Date(e).getTime()-new Date(t).getTime()}function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function St(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function jt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?St(Object(r),!0).forEach((function(e){xt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function xt(t,e,r){return e=function(t){var e=function(t,e){if("object"!==_t(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==_t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===_t(e)?e:String(e)}(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kt=o.a.memo((function(t){var e=t.data,r=t.index,n=t.style,i=e.listData,a=e.book,c=e.group,u=e.currentDocSlug,l=e.updateDocs,s=e.updateToc,f=e.updateDoc,d=e.onAddToCatalogSuccess,p=e.navigateToNextDoc,h=e.history,y=e.scrollToItem,m=i[r],v=m.slug===u;return o.a.createElement("div",{style:n},o.a.createElement(G,{group:c,book:a,docs:a.docs,toc:a.toc,history:h,scrollToItem:y,updateDocs:l,updateToc:s,updateDoc:f,onAddToCatalogSuccess:d},(function(t){var e=t.actionExecutor,r=t.editingDocId,n=t.handleEditTitleEnd,i=t.clearEditing,c=r===m.id;return o.a.createElement(bt,{isSlugActive:v,isEditing:c,book:a,doc:m,actionExecutor:function(t,r){"delete"===t&&v&&(r.onOk=function(){return p(m)}),e(t,r)},onEditEnd:n,clearEditing:i})})))}),s.c);function Dt(t,e){var r=t.space,o=t.group,i=t.book,a=t.dispatch,c=t.currentDocSlug,u=t.history,s=t.virtualListRef,f=new d.a(r,o,i).getSort(),p=Object(n.useMemo)((function(){return i.docs.sort((function(t,e){switch(f){case"content_updated_at":default:return Ot(t.content_updated_at,e.content_updated_at);case"created_at":return Ot(t.created_at,e.created_at);case"title":return r=t.title,n=e.title,function(t,e,r){var n=t.compare(e,r);return 0!==n?n:e.length!==r.length?e.length<r.length?-1:1:0}(Et,r=r||"",n=n||"")}var r,n}))}),[i.docs,f]),h=i.toc||[],y=Object(n.useRef)(!1);function m(t){var e,r=p.findIndex((function(e){return e.id===t})),n=r<1?0:r-1;null===(e=s.current)||void 0===e||e.scrollToItem(n,"start")}return Object(n.useEffect)((function(){if(!y.current){var t=p.find((function(t){return t.slug===c}));t&&(m(t.id),y.current=!0)}}),[p,c]),Object(n.useImperativeHandle)(e,(function(){return{scrollToItem:m}})),{state:{allDocs:p,toc:h},updateDocs:function(t){a({type:"book/updateDocs",payload:t})},updateToc:function(t){a({type:"book/updateToc",payload:t})},updateDoc:function(t,e){var r=p.find((function(e){return e.id===t}));r&&r.slug===c&&a({type:"doc/update",payload:e})},navigateToNextDoc:function(t){var e=p.findIndex((function(e){return e.id===t.id})),r=e+1;r>p.length-1&&(r=e-1);var n=p[r];if(n){var o="/".concat(i.namespace,"/").concat(n.slug);u.push(o)}else Object(l.b)("/".concat(i.namespace))},scrollToItem:m}}var Tt=Object(n.forwardRef)((function(t,e){var r=t.group,c=t.book,u=t.currentDocSlug,l=t.onAddToCatalogSuccess,d=Object(n.useRef)(null),p=Object(i.e)(),h=Object(a.useHistory)(),y=Dt(jt(jt({},t),{},{virtualListRef:d,dispatch:p,history:h}),e),m=y.state,v=y.updateDocs,g=y.updateToc,b=y.updateDoc,w=y.navigateToNextDoc,E=y.scrollToItem,O={listData:m.allDocs,group:r,book:c,currentDocSlug:u,updateDocs:v,updateToc:g,updateDoc:b,navigateToNextDoc:w,onAddToCatalogSuccess:l,history:h,scrollToItem:E};return o.a.createElement("div",{className:wt},o.a.createElement(f.a,null,(function(t){var e=t.height,r=t.width;return o.a.createElement(s.b,{ref:d,className:"virtual-list",width:r,height:e,itemCount:m.allDocs.length,itemSize:106,itemData:O},kt)})))}));Tt.propTypes={group:u.a.object.isRequired,book:u.a.object.isRequired,onAddToCatalogSuccess:u.a.func.isRequired,currentDocSlug:u.a.string},Tt.displayName="DocListViewer";var Lt=Tt}}]);