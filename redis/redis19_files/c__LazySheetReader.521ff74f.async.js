/*! For license information please see c__LazySheetReader.521ff74f.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[91,83],{2208:function(e,t,r){var n=r(582);e.exports=function(e){return"number"==typeof e&&e==n(e)}},2257:function(e,t,r){var n=r(233),o=r(855),a=Object.prototype.hasOwnProperty,i=o((function(e,t,r){a.call(e,r)?e[r].push(t):n(e,r,[t])}));e.exports=i},2921:function(e,t,r){"use strict";r.r(t);r(280);var n=r(102),o=(r(92),r(45)),a=(r(103),r(60)),i=r(0),l=r.n(i),c=r(2),u=r.n(c),s=r(569),f=r.n(s),d=r(9),p=r.n(d),h=r(93),m=r(111),g=r(51),b=r(30),v={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w=function(e){var t=e.icon,r=e.content,n=e.style,o=e.showClose,a=y(Object(i.useState)(!0),2),c=a[0],u=a[1];return c?l.a.createElement("div",{className:v.wrap,style:n},t&&l.a.createElement("div",{className:v.icon},t),l.a.createElement("div",{className:v.content},r),o&&l.a.createElement("div",{className:v.close,onClick:function(){u(!1)}},l.a.createElement("span",{className:p()("lake-icon","lake-icon-close",v.closeIcon)}))):null};w.propTypes={icon:u.a.node,content:u.a.node.isRequired,style:u.a.object,showClose:u.a.bool};var A=w,E=r(147),_="ReaderAudit-module_closeBtn_hHU+3",O="ReaderAudit-module_detail_mWCgN",T="ReaderAudit-module_toggleDetail_pq7CA",x="ReaderAudit-module_moreLink_oxcCo",k="ReaderAudit-module_tagModeWrapper_xupeI",j="ReaderAudit-module_tagText_Womh9",N="ReaderAudit-module_pending_m3C28",R="ReaderAudit-module_illegal_B8aJ7",C="ReaderAudit-module_banned_sHuxy",L="ReaderAudit-module_isIntranet_WPBjb",D="ReaderAudit-module_tagClose_YIxR7";function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==I(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===I(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e){var t,r=H(Object(i.useState)(!1),2),c=r[0],u=r[1],s=H(Object(i.useState)(!0),2),d=s[0],v=s[1],y=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,S=e.doc,w=e.type,E=e.tagMode,I=S.audits,P=S.read_status,z=S.id,B=S.content_updated_at,F=S.abilities,Z=void 0===F?{}:F,$=window.appData,q=$.book,W=$.group,G=$.me,Y=e.isYuque||window.appData.isYuque;var J="audit_ignored_".concat(w,"_").concat(z);function V(e){null==e||e.preventDefault(),localStorage.setItem(J,Date.now()),v(!1)}function K(e){var t=e.filter((function(e){return null!==e}));return f()(t)}if(Object(i.useEffect)((function(){if(P===h.READ_STATUS.insecure)if(G.isAdmin||Z.update){if(!y){var e=localStorage.getItem(J);if(e&&B){var t=new Date(B).getTime();v(t>e)}}}else v(!1)}),[]),P<=h.READ_STATUS.ok&&(null==q?void 0:q.status)!==m.STATUS.banned&&(null==W?void 0:W.status)!==g.STATUS.blocked)return null;if(P<=h.READ_STATUS.ok&&((null==q?void 0:q.status)===m.STATUS.banned||(null==W?void 0:W.status)===g.STATUS.blocked))return null!=G&&G.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==W?void 0:W.status)===g.STATUS.blocked,", bookBlocked: ").concat((null==q?void 0:q.status)===m.STATUS.banned)),null;if(null!=W&&W.isPermanentPunished)return null!=G&&G.isAdmin&&P>h.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===w&&P<=h.READ_STATUS.ok)return null;if(!d)return null;var Q=[];I&&(I.forbidden||I.reason)&&(Q=I.forbidden||[I.reason]);var X,ee={};if(ee[h.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),ee[h.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),ee[h.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[h.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[h.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[h.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[h.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),Y)X=ee[P]||ee[h.READ_STATUS.suspect];else{var te=!E&&Q.length>0?l.a.createElement("a",{onClick:function(e){e.preventDefault(),u(!c)},className:T},c?"收起详情":"展开详情"):null,re=l.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:x},__("了解更多"));X=y||P!==h.READ_STATUS.insecure?l.a.createElement(l.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),re,te," "):l.a.createElement(l.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),re,te)}var ne=Y?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(E){if(Y){var oe,ae,ie,le,ce=(M(oe={},h.READ_STATUS.pending,__("审核中")),M(oe,h.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),M(oe,h.READ_STATUS.banned,__("该内容已屏蔽#tag")),oe);switch(P){case h.READ_STATUS.pending:case h.READ_STATUS.suspect:le=h.READ_STATUS.pending;break;case h.READ_STATUS.illegal:case h.READ_STATUS.illegal_polity:case h.READ_STATUS.illegal_ak:case h.READ_STATUS.illegal_privacy:le=h.READ_STATUS.illegal;break;case h.READ_STATUS.banned:le=h.READ_STATUS.banned;break;default:le=null}return(ie=ce[le])?l.a.createElement(a.a,{title:l.a.createElement("span",{className:j},X),placement:"bottom"},l.a.createElement("div",{className:p()(k,(ae={},M(ae,N,le===h.READ_STATUS.pending),M(ae,R,le===h.READ_STATUS.illegal),M(ae,C,le===h.READ_STATUS.banned),ae))},l.a.createElement("span",{className:j},ie))):null}return l.a.createElement("div",{className:p()(k,L),onClick:function(){o.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:l.a.createElement(l.a.Fragment,null,X,Q.length>0&&l.a.createElement("ul",{className:O},K(Q).map((function(e){return l.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){V()}})}},l.a.createElement("span",{className:j},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),l.a.createElement("div",{className:D,onClick:function(e){e.stopPropagation(),V()}},l.a.createElement(b.b,{name:"close",width:10,height:10})))}return l.a.createElement(A,{style:U({marginBottom:"Doc"===w?24:0,marginTop:4},ne),icon:l.a.createElement(b.b,{name:"doc-has-content-risk",height:17,width:15}),content:l.a.createElement(l.a.Fragment,null,!Y&&l.a.createElement(n.a,{title:__("确认忽略该提醒？"),onConfirm:V,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},l.a.createElement("span",{className:_},l.a.createElement(b.b,{name:"close",width:14}))),l.a.createElement("span",{"data-testid":"audit-tip"},X),c&&l.a.createElement("ul",{className:O},K(Q).map((function(e){return l.a.createElement("li",{key:e},e)}))))})}B.defaultProps={isYuque:window.appData.isYuque},B.propTypes={doc:u.a.object.isRequired,type:u.a.string,isYuque:u.a.bool,tagMode:u.a.bool};t.default=Object(E.b)(B)},2978:function(e,t,r){var n=r(202);e.exports=function(e,t,r){for(var o=-1,a=e.length;++o<a;){var i=e[o],l=t(i);if(null!=l&&(void 0===c?l==l&&!n(l):r(l,c)))var c=l,u=i}return u}},3004:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(2),i=r.n(a),l=r(134),c=r(878),u="EmbedHeader-module_docEmbedHeader_lYs+e",s="EmbedHeader-module_embedHeaderReference_SWdkM",f="EmbedHeader-module_embedHeaderTitle_SPNfw",d="EmbedHeader-module_embedHeaderLink_Q9Vhk";function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(e){var t=e.title,r=e.link,n=e.height,a=e.style,i=void 0===a?{}:a,p=e.doc,h=e.book,g=e.group,b=window.appData,v=b.isYuqueMobileApp,y=b.isDesktopApp;return o.a.createElement("div",{className:u,style:m({height:"".concat(n,"px")},i)},o.a.createElement("span",{className:s},__("引用自"),"："),o.a.createElement("span",{className:f},t,o.a.createElement(c.b,{group:g,book:h,doc:p})),o.a.createElement("a",{className:d,href:r,target:"_blank",onClick:function(){!function(e){if(v){var t,r,n=(null===(t=window.nebulaMobileApp)||void 0===t||null===(r=t.envInfo)||void 0===r?void 0:r.origin)||window.location.origin;return l.a.pushWebWindow({url:"".concat(n).concat(e)}),!1}if(y)window.parent.postMessage({name:"openExternalLink",args:["".concat(window.location.origin).concat(e)]},"*")}(r)}},__("查看原文")))};b.propTypes={title:i.a.string,link:i.a.string,height:i.a.number,style:i.a.object,doc:i.a.object,book:i.a.object,group:i.a.object};t.a=b},3005:function(e,t,r){"use strict";r.d(t,"a",(function(){return be})),r.d(t,"b",(function(){return R}));var n=r(68),o=r.n(n),a=r(3009),i=r.n(a),l=r(599),c=r.n(l),u=r(450),s=r.n(u),f=r(924),d=r.n(f),p=r(26),h=r.n(p),m=r(2208),g=r.n(m),b=r(24),v=r.n(b),y=r(2257),S=r.n(y);function w(e,t){return function(e){for(var t,r=e.rows,n=r.length,o=[],a=[],i=0,l=0,c=0,u=0;u<n;u++){for(var s=r[u].cells,f=0,d=0;d<s.length;d++){var p=s[d],h=p.rowSpan,m=p.colSpan;i+=h*m,f+=m,h>1&&(l+=(h-1)*m)}a[u]=f,0===u&&(t=f),c=Math.max(f,c)}if(g()(i/t)&&t===c){var b=0;if(a.forEach((function(e){b+=c-e})),b!==l){var v=l-b;if(v&&g()(v/c)){for(var y=[],S=0;S<n;S++){for(var w=r[S].cells;o[S+y.length]===c;)y.push(S+y.length);for(var A=S+y.length,E=0;E<w.length;E++){var _=w[E],O=_.rowSpan,T=_.colSpan;if(O>1)for(var x=1;x<O;x++)o[A+x]=(o[A+x]||0)+T}}y.forEach((function(t){e.insertRow(t)}))}}}}(e),function(e){var t=e.rows[0];0===t.cells.length&&t.remove(),e.rows.length>1&&1===t.cells.length&&""===t.cells[0].innerText.trim()&&0===t.cells[0].getElementsByTagName("img").length&&1===t.cells[0].colSpan&&1===t.cells[0].rowSpan&&t.remove()}(e),function(e){Array.from(e.rows).forEach((function(e){var t=e.getAttribute("style"),r=t&&t.match(/mso-xlrowspan:(\d+)/),n=e.getAttribute("height");if(r&&n){var o=parseInt(r[1]);n=parseInt(n)/o||24,e.setAttribute("height",n),e.style.height=n+"px"}if(Array.from(e.cells).forEach((function(t){var r=t.getAttribute("style");if(t.setAttribute("height",n),t.style.height=n+"px",t.colSpan>1&&r&&-1!==r.indexOf("mso-ignore:colspan")){var o=t.colSpan;t.setAttribute("colSpan",1);for(var a=1;a<o;a++){var i=t.cloneNode();e.insertBefore(i,t.nextSibling)}}})),r){var a=parseInt(r[1]);if(a<1e6)for(var i=1;i<a;i++){var l=e.cloneNode();e.parentNode.insertBefore(l,e)}}}))}(e),function(e,t){for(var r=[],n=e.rows,o=n.length,a=100,i=0;i<o;i++){var l=n[i].cells,c=l.length;r[i]=r[i]||[];for(var u=c>16300,s=0;s<c;s++){var f=l[s];if(u&&s>a&&""===f.innerHTML&&A(f))break;a=Math.max(a,s);for(var d=f.rowSpan,p=void 0===d?1:d,m=f.colSpan,g=void 0===m?1:m,b=p>1||g>1,v=s;r[i][v];)v++;if(r[i][v]={rowSpan:p,colSpan:g,isMulti:b,element:f},b)for(var y=p;y>0;){for(var S=g;S>0;){if(1!==S||1!==y){var w=i+y-1,E=v+S-1;r[w]=r[w]||[],r[w][E]={isEmpty:!0,parent:{row:i,col:v}}}S--}y--}}}var _=r.map((function(e){return e.length})),O=Math.max.apply(Math,h()(_));return r.forEach((function(e,r){if(e.length<O)for(var n=O-e.length;n--;)0!==r||t?e.push({rowSpan:1,colSpan:1,isShadow:!0,element:null}):e.unshift({rowSpan:1,colSpan:1,isShadow:!0,element:null});for(var o=0;o<O;o++)e[o]||(e[o]={rowSpan:1,colSpan:1,isShadow:!0,element:null})})),{rows:r.length,cols:O,table:r}}(e,t)}function A(e){for(var t=10;t>0&&e;){if(e.tagName&&"td"===e.tagName.toLowerCase()){if(""!==e.innerHTML)return!1;t-=1}e=e.nextSibling}return!0}function E(e,t,r){var n=e.match(/<col[^>]*>/g),o=0;if(n){var a=n[n.length-1].match(/<col[^>]*span=(\d+)[^>]*>/);a&&(o=parseInt(a[1],10))}if(o>r){var i=e.split("</tr>");e=(i=i.map((function(e){var t=e.match(/(\s*<td[^>]*>\s*<\/td>)(\s*)$/);if(t){var r=t[1].repeat(o-30);e.endsWith(r+t[2])&&(e=e.substr(0,e.length-r.length-t[2].length))}return e}))).join("</tr>")}var l=e.match(/\s*<tr[^>]*>\s*(<td[^>]*>\s*<\/td>\s*)+<\/tr>/g);if(l&&l.length>t){var c=e.match(/<td[^>]*>[^<]*[^\s<]+[^<]*<\/td>/g);if(!c)return"<table><tr><td></td></tr></table>";var u=c[c.length-1],s=e.lastIndexOf(u),f=e.slice(0,s+u.length);e=e.slice(s+u.length);var p={};l.forEach((function(e){p[e]=p[e]||{content:e,count:0},p[e].count+=1}));for(var h=Object.values(p),m=(h=d()(h,"count")).length-1;h[m];){var g=h[m];if(g.count>t){var b=g.content.replace(/([*.?+$^[\](){}|/\\])/g,(function(e){return"\\".concat(e)}));e=e.replace(new RegExp(b,"g"),"")}m--}e=f+e}return e}var _=/^\s*\(?¥\s*\(?[\d,.]+\)?$/,O=/^#+$/,T=/^\d\.\d+[Ee]\+\d+$/,x=String.fromCharCode(165),k=String.fromCharCode(36),j=String.fromCharCode(8364),N=String.fromCharCode(163);function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;e=C(e=E(e,200,200));var a=(new DOMParser).parseFromString(e,"text/html"),l=a.body,u=re(a.all,(function(e){return"STYLE"===e.tagName}));if(!l)return null;for(var s,f=l.firstChild,d=[],p=[],h={},m={},g=[],b={},v=!1;f;)if(U(f)){var y=J(f,d.length,u,o);y.mergeCells&&(p=p.concat(y.mergeCells)),y.startCell&&(s=y.startCell),y.selectOptions&&Object.assign(b,y.selectOptions),Object.assign(m,y.rows),y.columns&&Object.assign(h,y.columns),d=d.concat(y.table),y.cellsNeedFix&&(g=g.concat(y.cellsNeedFix)),f=Y(f),v=!1}else if(Z(f))B(f)&&(f.innerHTML=""),M(f)&&(f.innerHTML=f.innerHTML.replace(/\n/g,"<br/>")),f=f.firstChild||Y(f),v=!1;else if(z(f)){var S=f.innerText.trim(),w=f.getAttribute("href");I(d,d.length,S,w),v=!1,f=Y(f)}else if(H(f)){var A=f.getAttribute("src");P(d,d.length,A,o),v=!1,f=Y(f)}else if(q(f))f=f.firstChild||Y(f);else if(W(f))v=!1,f=Y(f);else if(G(f)){var _=f.data;if(""!==_.trim()||!Z(f.parentNode)){var O=v?d.length-1:d.length;D(d,O,_),v=!0}f=Y(f)}else f=Y(f);var T=L(d);p=c()(p,(function(e){return"".concat(e.row,":").concat(e.col)}));var x=i()(d.map((function(e){return e.length})))||20,k={name:r||"Sheet".concat(t+1),rowCount:n?Math.max(d.length,n.rowCount):d.length,colCount:n?Math.max(x,n.colCount):x,data:T,mergeCells:p,rows:m,columns:h,filter:{},index:t,defaults:{}};return s&&(k.startCell=s),Object.keys(b).length>0&&(k.selectOptions=b),g.length>0&&(k.cellsNeedFix=g),k}function C(e){return e.replace(/\\0022/g,"")}function L(e){var t={};return e.forEach((function(e,r){e.forEach((function(e,n){e&&0!==Object.keys(e).length&&(t[r]=t[r]||{},0!==Object.keys(e).length&&(t[r][n]=e))}))})),t}function D(e,t,r){e[t]=e[t]||[],e[t][0]?e[t][0].value+=""+r:e[t][0]={value:r}}function I(e,t,r,n){e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value={class:"link",text:r,url:n}}function P(e,t,r,n){r=function(e){return e.replace(/\?x-oss-process=image\/resize.+/,"")}(r),e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value=n?{class:"image",name:"",src:r}:{class:"image",name:"",status:"needUpload",originSrc:r}}function U(e){return"TABLE"===e.tagName}function M(e){return"PRE"===e.tagName}function H(e){return"IMG"===e.tagName}function z(e){return"A"===e.tagName}function B(e){var t=e.getAttribute("style");return t&&t.startsWith("mso-element")}var F=["BODY","ARTICLE","ASIDE","ADDRESS","DD","DL","FIELDSET","FIGCAPTION","FIGURE","FOOTER","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","P","DIV","PRE","BLOCKQUOTE","UL","OL","LI","TABLE","THEAD","TBODY","TFOOT","SECTION"];function Z(e){return 1===e.nodeType&&F.includes(e.tagName)}var $=["B","I","ABBR","CITE","CODE","DFN","DEL","EM","KBD","STRONG","SAMP","A","BDO","Q","SPAN","SUB","SUP","BUTTON","LABEL"];function q(e){return 1===e.nodeType&&$.includes(e.tagName)}function W(e){return"BR"===e.tagName}function G(e){return 3===e.nodeType}function Y(e){if(e.nextSibling)return e.nextSibling;for(var t=e.parentNode;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}return null}function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=e.cloneNode(!0);document.body.appendChild(a);var i=w(a,n),l={};r&&r.forEach((function(e){document.body.appendChild(e),Object.assign(l,ee(e.innerHTML))}));var c={table:[]},u=a.querySelectorAll("col");if(u.length>0){var s={},f=0;u.forEach((function(e){for(var t=parseInt(e.getAttribute("width")),r=e.span,n=0;n<r&&f<i.cols;)s[f]=0!==t?{size:t}:{size:0,hidden:!0,oldSize:120},f+=1,n+=1})),c.columns=s}var d=Array.from(a.rows);c.rows={},d.forEach((function(e,r){if(0===e.offsetHeight&&r!==d.length-1)c.rows[r+t]={size:0,hidden:!0,oldSize:24};else{var n=Math.max(e.offsetHeight,24)||24,o={size:n};24!==n&&(o.customSize=n),c.rows[r+t]=o}}));var p=a.getAttribute("data-startCell");if(p){var h=p.split(":");c.startCell={row:parseInt(h[0])||0,col:parseInt(h[1])||0}}var m=a.getAttribute("data-selectOptions");if(m)try{c.selectOptions=JSON.parse(decodeURIComponent(m))}catch(e){console.log(e)}return i.table.forEach((function(e,r){c.table[r]=[],e.forEach((function(e,a){if(e.element){var i=K(e.element,n),u=X(e.element),s=V(e.element),f={name:"auto"},d=!1;if(l){var p=e.element.classList&&e.element.classList[0];l[p]&&("object"===o()(l[p])?Object.assign(f,l[p]):f.name=l[p],["currency","number","percentage"].includes(f.name)&&(f.decimal=2),c.table[r][a]=c.table[r][a]||{},c.table[r][a].type=f,["text","auto"].includes(f.name)||(d=!0))}u&&(c.table[r][a]=c.table[r][a]||{},c.table[r][a].style=u),s&&(c.table[r][a]=c.table[r][a]||{},c.table[r][a].note=s),void 0!==i&&""!==i?(c.table[r][a]=c.table[r][a]||{},c.table[r][a].type=f,c.table[r][a].value=i,"string"==typeof i&&((O.test(i)||T.test(i))&&(d=!0),_.test(i)&&"auto"===f.name&&(d=!0,c.table[r][a].type.name="currency",c.table[r][a].type.symbol=x,c.table[r][a].type.decimal=2))):""===i&&c.columns&&c.columns[a]&&c.columns[a].size<=15&&c.columns[a].size>=0&&(d=!0),d&&n&&(c.cellsNeedFix=c.cellsNeedFix||[],c.cellsNeedFix.push({row:r+t,col:a})),e.isMulti&&(c.mergeCells=c.mergeCells||[],c.mergeCells.push({row:r+t,col:a,rowCount:e.rowSpan,colCount:e.colSpan}),u&&(c.table[r+e.rowSpan-1]=c.table[r+e.rowSpan-1]||[],c.table[r+e.rowSpan-1][a+e.colSpan-1]=c.table[r+e.rowSpan-1][a+e.colSpan-1]||{},c.table[r+e.rowSpan-1][a+e.colSpan-1].style=u))}}))})),a.remove(),r&&r.forEach((function(e){e.remove()})),c}function V(e){var t=e.getAttribute("data-note");if(t)try{var r=JSON.parse(decodeURIComponent(t));if(r.text)return r}catch(e){console.log(e)}}function K(e,t){var r=e.getAttribute("data-value");if(r)try{var n=JSON.parse(decodeURIComponent(r));if(function(e){return!!e.class&&("link"===e.class?e.text&&e.url:"file"===e.class||"image"===e.class?e.name&&e.src:"checkbox"===e.class?void 0!==e.value:"select"===e.class?e.value&&(e.options||e.optionId):"mention"===e.class?e.value&&e.value[0].id&&e.value[0].login:"formula"===e.class&&void 0!==e.formula)}(n))return n}catch(e){console.log(e)}for(var o=e.querySelectorAll("img"),a=o.length,i=0;i<a;i++){var l=o[i].getAttribute("src");if(l)return t?{class:"image",src:l,name:"image"}:{class:"image",status:"needUpload",originSrc:l,name:"image"}}e.innerHTML=e.innerHTML.replace(/<!--\[if[\s\S]+<!--\[endif\]-->/g,"").replace(/<rt[^>]*>[^<]*<\/rt>/g,"").replace(/\n/g,"").replace(/<br>\s*/g,"\n");var c,u=e.innerHTML.replace(/<[^>]+>/g,"").trim();u="string"!=typeof(c=u)?c:c.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&nbsp;/g," ");var s=e.querySelector("a");return s&&s.getAttribute("href")?{class:"link",text:u.replace(/\n/g,""),url:s.getAttribute("href")}:(u.endsWith(" %")&&(u=u.replace(/ %$/,"%")),u)}var Q={"-webkit-left":"left","-webkit-right":"right","-webkit-center":"center",left:"left",right:"right",center:"center","-webkit-baseline-middle":"middle",top:"top",bottom:"bottom",middle:"middle"};function X(e){try{var t=window.getComputedStyle(e),r={};1===e.childNodes.length&&"S"===e.childNodes[0].tagName&&(r.strikeThrough=!0);var n=function(e){var t;-1!==e.indexOf("pt")&&(t=parseInt(e,10));var r=12;if(-1!==e.indexOf("em")?r=parseFloat(e,14):-1!==e.indexOf("px")&&(r=parseFloat(e,10)),t=t||Math.round(r/1.3333333),te[t])return t;var n=Object.keys(te).map((function(e){return parseInt(e,10)}));n.sort();for(var o=0;n[o];){if(n[o]>t)return n[o];o++}return n[o-1]}(t.fontSize);return-1!==t.textDecoration.indexOf("underline")&&(r.underline=!0),-1!==t.textDecoration.indexOf("line-through")&&(r.strikeThrough=!0),(n>12||e.style.fontSize&&e.style.fontSize.indexOf("px")>0)&&(r.fontSize=n),["rgba(0, 0, 0)","rgb(0, 0, 0)","rgba(0, 0, 0, 0.65)","rgb(88, 90, 90)"].includes(t.color)||(r.color=t.color),"italic"===t.fontStyle&&(r.fontStyle=t.fontStyle),"normal"===t.whiteSpace&&e.classList.length>0&&(r.overflow="wrap"),["400",400,"normal"].includes(t.fontWeight)||(r.fontWeight=t.fontWeight),"middle"!==t.verticalAlign&&(r.vAlign=Q[t.verticalAlign]||"middle"),"start"!==t.textAlign&&"left"!==t.textAlign&&(r.hAlign=Q[t.textAlign]||"left"),"rgba(0, 0, 0, 0)"!==t.backgroundColor&&"rgb(255, 255, 255)"!==t.backgroundColor&&(r.backColor=t.backgroundColor),"0px"!==t.borderLeftWidth&&"rgb(204, 204, 204)"!==t.borderLeftColor&&(r.border=r.border||{},r.border.left={color:t.borderLeftColor,lineStyle:"dashed"===t.borderLeftStyle?"dash":"normal"}),"0px"!==t.borderRightWidth&&"rgb(204, 204, 204)"!==t.borderRightColor&&(r.border=r.border||{},r.border.right={color:t.borderRightColor,lineStyle:"dashed"===t.borderRightStyle?"dash":"normal"}),"0px"!==t.borderTopWidth&&"rgb(204, 204, 204)"!==t.borderTopColor&&(r.border=r.border||{},r.border.top={color:t.borderTopColor,lineStyle:"dashed"===t.borderTopStyle?"dash":"normal"}),"0px"!==t.borderBottomWidth&&"rgb(204, 204, 204)"!==t.borderBottomColor&&(r.border=r.border||{},r.border.bottom={color:t.borderBottomColor,lineStyle:"dashed"===t.borderBottomStyle?"dash":"normal"}),0===Object.keys(r).length?null:r}catch(e){return null}}function ee(e){var t=/([^{}]+){([^{}]+)}/,r=e.match(/[^{}]+{([^{}]+)}/g),n={};return r&&r.forEach((function(e){var r=e.match(t);if(r){var o=r[1].trim(),a=r[2];if(o.startsWith(".")){var i=a.match(/mso-number-format:(.+);(\n|$)/);i&&(n[o.substr(1)]=function(e){return-1!==(e=e.replace(/\/|"|\\/g,"")).indexOf("Date")?"date":-1!==e.indexOf("Time")?"time":e.endsWith("%")?"percentage":-1!==e.indexOf(N)?{name:"currency",symbol:N}:-1!==e.indexOf(j)?{name:"currency",symbol:j}:-1!==e.indexOf(x)?{name:"currency",symbol:x}:e.match(/^@$/)?"text":-1!==e.indexOf("General")||-1!==e.indexOf("Standard")||-1!==e.indexOf("Fixed")?"auto":e.match(/(年|月|日|时|分|秒|dd|y|m|h|s|md|dm)/)?e.match(/(时|分|秒|s|h)/)?"datetime":e.match(/[^d]ddd[^d]/)?{name:"datetime",formatter:"dddd"}:"date":-1!==e.indexOf(k)?{name:"currency",symbol:k}:"number"}(i[1]))}}})),0===Object.keys(n).length?null:n}var te={9:12,10:13,11:14,12:16,14:19,16:22,18:24,22:29,24:32,30:40,36:48};function re(e,t){for(var r=e.length,n=[],o=0;o<r;o++)t(e[o])&&n.push(e[o]);return n}function ne(e,t){if(t.workbook&&t.worksheets){for(var r=function(e){if(!e)return null;var t=ge(e).getElementsByTagName("c");if(0!==t.length){for(var r=[],n=0;n<t.length;n++)r.push({cell:t[n].getAttribute("r"),sheetIndex:t[n].getAttribute("i")||1});return 0===r.length?null:S()(r,"sheetIndex")}}(t.calcChain),n=ge(t.workbook).getElementsByTagName("sheet"),a={},i={},l={},c=1,u=0;u<n.length;u++){var s=parseInt(n[u].getAttribute("r:id").replace("rId","")),f=n[u].getAttribute("sheetId"),d=n[u].getAttribute("state");a[f]=s,"hidden"!==d&&(i[c]=s,l[f]=c,c+=1)}if(e.calcChain=[],r)for(var p in r){var h=a[p],m="sheet".concat(h);if(t.worksheets[m])for(var g=ge(t.worksheets[m]).getElementsByTagName("f"),b={},v=0;v<g.length;v++){var y=g[v],w=y.parentNode.getAttribute("r"),A=y.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," "),E=y.getAttribute("t"),_=y.getAttribute("ref"),O=y.getAttribute("si");"shared"===E&&(_?b[O]={baseCell:w,formula:A}:A=me(b[O],w));var T=w.match(/\d+/),x=w.match(/[A-Z]+/);T&&(T=parseInt(T[0])-1),x&&(x=de(x[0]));var k=l[p]-1;if(e.sheet[k])if(e.sheet[k].data[T]=e.sheet[k].data[T]||{},e.sheet[k].data[T][x]=e.sheet[k].data[T][x]||{},"string"==typeof A&&0===A.toLowerCase().indexOf("hyperlink(")){var j=A.substring(10,A.length-1).split(","),N=oe(j[0]),R=j.length>1?oe(j[1]):N;console.log(N,R),e.sheet[k].data[T][x].value={class:"link",url:N,text:R}}else e.sheet[k].data[T][x].value={class:"formula",formula:A,value:e.sheet[k].data[T][x].value||""},e.calcChain.push({row:T,col:x,sheet:k})}}e.sheet.forEach((function(e,r){if(e.cellsNeedFix){var n=i[r+1],a="sheet".concat(n),l=ge(t.worksheets[a]);e.cellsNeedFix.forEach((function(t){var r=t.row,n=t.col,a=he({row:{index:r},col:{index:n}}),i=l.querySelector("c[r=".concat(a,"]"));if(i){var c="s"===i.getAttribute("t"),u=i.querySelector("v");if(u&&u.innerHTML&&!c){var s=e.data[r]&&e.data[r][n]&&e.data[r][n].value,f=e.data[r]&&e.data[r][n]&&e.data[r][n].type,d=u.innerHTML;if(f&&!isNaN(1*d)){var p=1*d,h=p>=367?343:p<61?86400:0;"date"===f.name||"datetime"===f.name||"time"===f.name?d=86400*d+h:["percentage","number","currency"].includes(f.name)&&(d*=1)}s&&"formula"===s.class?s.value=d:"object"!==o()(s)&&(e.data[r]=e.data[r]||{},e.data[r][n]=e.data[r][n]||{},e.data[r][n].value=d)}}})),delete e.cellsNeedFix}}))}}function oe(e){return e.trim().replace(/'/g,"").replace(/"/g,"")}var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZ",ie=ae.length,le=[{type:"whitespace",reg:/^(?:\s+)/},{type:"string",reg:/^(?:"(\\["]|[^"])*")/},{type:"string",reg:/^(?:'(\\[']|[^'])*')/},{type:"function",reg:/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/},{type:"error",reg:/^(?:#[A-Z0-9\/]+(!|\?)?)/},{type:"sheetCell",reg:/^(?:'{1}[^']+'{1}!{1}\${0,1}[A-Za-z]+\${0,1}[0-9]+)/},{type:"sheetCell",reg:/^(?:[\u4e00-\u9fa5A-Za-z0-9]+!{1}\${0,1}[A-Za-z]+\${0,1}[0-9]+)/},{type:"absoluteCell",reg:/^(?:\$[A-Za-z]+\$[0-9]+)/},{type:"absoluteColCell",reg:/^(?:\$[A-Za-z]+[0-9]+)/},{type:"absoluteRowCell",reg:/^(?:[A-Za-z]+\$[0-9]+)/},{type:"relativeCell",reg:/^(?:[A-Za-z]+[0-9]+)/},{type:"colRange",reg:/^(?:[A-Za-z]+:[A-Za-z]+)/},{type:"colRange",reg:/^(?:'{1}[\u4e00-\u9fa5A-Za-z0-9]+'{1}!{1}[A-Za-z]+:[A-Za-z]+)/},{type:"colRange",reg:/^(?:[\u4e00-\u9fa5A-Za-z0-9]+!{1}[A-Za-z]+:[A-Za-z]+)/},{type:"rowRange",reg:/^(?:[0-9]+:[0-9]+)/},{type:"rowRange",reg:/^(?:'{1}[\u4e00-\u9fa5A-Za-z0-9]+'{1}!{1}[0-9]+:[0-9]+)/},{type:"rowRange",reg:/^(?:[\u4e00-\u9fa5A-Za-z0-9]+!{1}[0-9]+:[0-9]+)/},{type:"mixRange",reg:/^(?:[0-9]+:[0-9]+)/},{type:"function",reg:/^(?:[A-Za-z\.0-9]+(?=[(]))/},{type:"variable",reg:/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/},{type:"number",reg:/^(?:[0-9]+)/},{type:"array",reg:/^(?:\[(.*)?\])/},{type:"&",reg:/^(?:&)/},{type:"whitespace",reg:/^(?: )/},{type:"decimal",reg:/^(?:[.])/},{type:":",reg:/^(?::)/},{type:";",reg:/^(?:;)/},{type:",",reg:/^(?:,)/},{type:"*",reg:/^(?:\*)/},{type:"/",reg:/^(?:\/)/},{type:"-",reg:/^(?:-)/},{type:"+",reg:/^(?:\+)/},{type:"^",reg:"/^(?:^)/,"},{type:"(",reg:/^(?:\()/},{type:")",reg:/^(?:\))/},{type:">",reg:/^(?:>)/},{type:"<",reg:/^(?:<)/},{type:"NOT",reg:/^(?:NOT\b)/},{type:'"',reg:/^(?:")/},{type:"'",reg:/^(?:')/},{type:"!",reg:/^(?:!)/},{type:"=",reg:/^(?:=)/},{type:"%",reg:/^(?:%)/},{type:"#",reg:/^(?:[#])/},{type:"EOF",reg:/^(?:$)/}],ce=/^([\u4e00-\u9fa5A-Za-z0-9]+!{1})/,ue=/^'{1}(.+'{1}!{1})/,se=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function fe(e){var t=parseInt(e,10);return isNaN(t)?-1:Math.max(t-1,-1)}function de(e){var t=0;if("string"==typeof e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(ie,n)*(ae.indexOf(e[r])+1);return t-1}function pe(e){var t=function(e){var t=null,r=e,n=e.match(ce);return n?(r=e.substring(n[0].length),t=n[0].slice(0,-1)):(n=e.match(ue))&&(r=e.substring(n[0].length),t=n[0].slice(1,-2)),{sheet:t,label:r.toUpperCase()}}(e),r=t.label.match(se),n=v()(r,5),o=n[1],a=n[2],i=n[3],l=n[4];return{row:{index:fe(l),label:l,absolute:"$"===i},col:{index:de(a),label:a,absolute:"$"===o},sheet:t.sheet}}function he(e){var t=(e.row.absolute?"$":"")+(e.row.index+1);return function(e,t){return t?/^[A-Za-z0-9]+$/.test(t)&&!t.match(/^[A-Za-z]{1,3}[0-9]+/)?"".concat(t,"!").concat(e):"'".concat(t,"'!").concat(e):e}((e.col.absolute?"$":"")+function e(t){var r=ae.substr(t%26,1),n=Math.floor(t/26);return n>0?"".concat(e(n-1)).concat(r):r}(e.col.index)+t,e.sheet)}function me(e,t){var r=e.baseCell,n=e.formula,o=pe(r),a=pe(t);return function(e,t,r,n){var o=function(e,t){var r=[];e=(e+"").replace(/\s/g,"");for(var n=function(){var t=void 0,n=void 0,o=void 0;le.forEach((function(r){(o=e.match(r.reg))&&(!t||o[0].length>t[0].length)&&(t=o,n=r.type)})),t?(r.push({text:t[0],type:n}),e=e.slice(t[0].length)):(r.push({text:e[0],type:"other"}),e=e.slice(1)),t=null};e.length>0;)n();for(var o=r.length,a=0;a<o-2;a++)r[a].type.indexOf("Cell")>0&&":"===r[a+1].type&&r[a+2].type.indexOf("Cell")<0&&(r[a+1].type="colon");return r}(e),a="";return o.forEach((function(e){if(e.type.indexOf("Cell")>0){var n=pe(e.text);n.row.index+=n.row.absolute?0:t,n.col.index+=n.col.absolute?0:r,a+=he(n)}else a+=e.text})),a}(n,a.row.index-o.row.index,a.col.index-o.col.index)}function ge(e){return(new DOMParser).parseFromString(e,"text/xml")}function be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof e&&(e=[e]);var r={format:"lakesheet",type:"Sheet",version:"1.0",larkJson:!0,sheet:[]},n=t.names,o=void 0===n?[]:n,a=t.deflate,i=void 0!==a&&a,l=t.worksheetsDeflate,c=void 0!==l&&l,u=t.xml;if(e.forEach((function(e,t){i&&(e=s.a.inflate(e,{to:"string"}));var n=R(e,t,o[t],{rowCount:50,colCount:20},!0);n.selectOptions&&(r.selectOptions=r.selectOptions||{},Object.assign(r.selectOptions,n.selectOptions),delete n.selectOptions),r.sheet.push(n)})),u){if(c&&u.worksheets){var f={};for(var d in u.worksheets){var p=u.worksheets[d];f[d]=s.a.inflate(p,{to:"string"})}u.worksheets=f}ne(r,u)}return r.sheet=s.a.deflate(JSON.stringify(r.sheet),{to:"string"}),r}},3009:function(e,t,r){var n=r(2978),o=r(3010),a=r(240);e.exports=function(e){return e&&e.length?n(e,a,o):void 0}},3010:function(e,t){e.exports=function(e,t){return e>t}},3077:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(2),i=r.n(a),l=r(633),c=r(147),u=r(2925),s=r(241);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(){d=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,o){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),l=new x(o||[]);return n(i,"_invoke",{value:E(e,r,l)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function h(){}function m(){}function g(){}var b={};c(b,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(k([])));y&&y!==t&&r.call(y,a)&&(b=y);var S=g.prototype=h.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function o(n,a,i,l){var c=s(e[n],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==f(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,l)}),(function(e){o("throw",e,i,l)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,l)}))}l(c.arg)}var a;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return a=a?a.then(n,n):n()}})}function E(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return j()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var l=_(i,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function _(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,p;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function k(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return m.prototype=g,n(S,"constructor",{value:g,configurable:!0}),n(g,"constructor",{value:m,configurable:!0}),m.displayName=c(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},w(A.prototype),c(A.prototype,i,(function(){return this})),e.AsyncIterator=A,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new A(u(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(S),c(S,l,"Generator"),c(S,a,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=k,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}function p(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}var h,m,g=Object(l.a)({loader:function(){return Promise.all([r.e(0),r.e(1),r.e(5),r.e(4),r.e(47)]).then(r.bind(null,3231))},loading:u.a}),b=Object(l.a)({loader:(h=d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.loadModule)("larksheet");case 2:return e.abrupt("return",Promise.all([r.e(4),r.e(20),r.e(45)]).then(r.bind(null,3251)));case 3:case"end":return e.stop()}}),e)})),m=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=h.apply(e,t);function a(e){p(o,r,n,a,i,"next",e)}function i(e){p(o,r,n,a,i,"throw",e)}a(void 0)}))},function(){return m.apply(this,arguments)}),loading:u.a});function v(e){var t=e.format,r=e.content;return"spreadjs"===t?"export"===new URLSearchParams(window.location.search).get("mode")?o.a.createElement(g,{content:r,onLoad:e.onLoad}):o.a.createElement(b,{body:r,className:e.className||"",showToolbar:e.showToolbar,sheetStyle:e.geSheetStyle}):"lakesheet"===t?o.a.createElement(g,{versionMode:!!e.versionMode,abilities:e.abilities,docId:e.docId,docType:e.docType,type:e.type,content:r,onLoad:e.onLoad}):null}v.propTypes={className:i.a.string,format:i.a.string.isRequired,abilities:i.a.object,docId:i.a.number.isRequired,content:i.a.string.isRequired,versionMode:i.a.bool,showToolbar:i.a.bool,geSheetStyle:i.a.object,onLoad:i.a.func},t.a=Object(c.b)(v,!0,__("数据出错，请通过历史恢复到最近的正确版本，重新编辑"))},3375:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3005);function o(e){var t=[],r={};if(e.startsWith("<!doctype html>"))t.push(e.substring(15));else{var o=JSON.parse(e.substring(15));t=o.htmls,r=o.options}var a=Object(n.a)(t,r);return{value:JSON.stringify(a)}}},3385:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(2),i=r.n(a),l=r(3077),c=r(878),u=r(3004),s=r(2921),f={draft:"SheetEmbed-module_draft_hySRt",sheetViewer:"SheetEmbed-module_sheetViewer_LnVL7",content:"SheetEmbed-module_content_XRryY"};function d(e){var t=e.doc,r=e.book,n=e.group,a=e.match,i=e.sheetHeight,d=e.hasReadAuditTip,p=e.showHeader?i-32:i;return t.loaded?o.a.createElement("div",{className:f.wrapper},e.showHeader&&o.a.createElement(u.a,{title:t.title,doc:t,book:r,group:n,height:32,link:a&&a.url}),o.a.createElement("div",{className:f.content},e.showHeader&&o.a.createElement(c.g,{doc:t,className:f.draft}),d&&o.a.createElement(s.default,{key:"audits",doc:t,type:"Doc"}),o.a.createElement("div",{className:f.sheetViewer,style:{width:"100%",height:p,overflow:"hidden"}},o.a.createElement(l.a,{content:t.content,format:t.format,geSheetStyle:{width:"100%",height:i-40}})))):null}d.defaultProps={showHeader:!0},d.propTypes={doc:i.a.object.isRequired,book:i.a.object.isRequired,group:i.a.object.isRequired,sheetHeight:i.a.number.isRequired,match:i.a.object.isRequired,showHeader:i.a.bool,hasReadAuditTip:i.a.bool.isRequired};t.a=d},4379:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(570),i=r(2766),l=r(3077),c=r(3107),u=r(369),s=r(3375),f=r(2837),d=r(287),p=r(3385),h="SheetReader-module_wrapper_P6Ioz",m="SheetReader-module_content_BhpjY",g="SheetReader-module_sheetViewer_zdxVX";function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=Object(d.c)((function(){return r.e(131).then(r.bind(null,3084))}),{suspense:!0}),S=Object(d.c)((function(){return r.e(23).then(r.bind(null,3186))}),{suspense:!0});function w(e){var t=e.book,r=e.doc;return Object(c.a)(t,r),o.a.createElement("div",{"data-testid":""})}t.default=Object(a.d)((function(e){return{doc:e.doc}}))((function(e){var t=b(Object(n.useState)(document.body.clientHeight),2),r=t[0],a=t[1],c=Object(d.e)(),v=e.group,A=e.book,E=e.doc,_=e.history,O=e.match,T=e.shouldRenderComments,x=function(){a(document.body.clientHeight)};Object(n.useEffect)((function(){return window.addEventListener("resize",x,!1),function(){window.removeEventListener("resize",x,!1)}}),[]);var k=Object(n.useMemo)((function(){return new f.a}),[]);if(!E.loaded)return null;if(E.loaded&&"lakesheet_html"===E.format){var j=Object(s.a)(E.content);E.content=j.value,E.format="lakesheet"}var N="doc_embed"===_.location.query.view,R=N?32:60,C=98===E.read_status||99===E.read_status||100===E.read_status;C&&(R+=42);var L=r-R;return N?o.a.createElement(p.a,{doc:E,book:A,group:v,sheetHeight:L,match:O,hasReadAuditTip:C,showHeader:k.showHeader}):o.a.createElement("div",{className:h},o.a.createElement(w,{book:A,doc:E}),o.a.createElement("div",{className:m},o.a.createElement("div",{className:g,style:{width:"100%",height:L,overflow:"hidden"}},o.a.createElement(l.a,{docId:E.id,type:E.type,abilities:E.abilities,content:E.content,format:E.format,geSheetStyle:{width:"100%",height:L-40},onLoad:function(e){var t=i.a.getSheetStoredPosition(E.id);t&&e.setPosition(t),Object(u.b)(E.id,E.type),y.start(),S.start(),c.priorityTaskManager.execMedium()}}))),o.a.createElement(y,{type:"Doc",targetId:E.id,likeStatus:E.like.actioned,likeCount:E.like.count,size:"bubble",bubblePopover:!0}),o.a.createElement(S,{style:T?{bottom:"32px"}:{bottom:"86px"}}))}))}}]);