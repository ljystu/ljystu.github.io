/*! For license information please see c__LazyBookOverview.c3a0cec3.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{109:function(t,e,r){"use strict";var n=r(138),o=r.n(n),i=r(114),a=r.n(i),c=r(121),u=r.n(c),l=r(122),f=r.n(l),s=r(137),p=r.n(s),y=r(145),d=r.n(y),v=r(146),b=r.n(v),h=r(149),m=r.n(h),g=r(293),w=r.n(g),O=o.a,_=o.a.normal,k=o.a.paid,j=[d.a,b.a,p.a,m.a],E=w()(j).concat([".pdf"]),P=w()(j.map((function(t){return t.paid}))).concat([".pdf"]),S=a.a,T=a.a.normal,A=a.a.paid,C=u.a,x=u.a.paid,R=f.a,B=f.a.paid;e.a={LOCAL_DOC_EXT:E,LOCAL_DOC_EXT_NORMAL:[],LOCAL_DOC_EXT_PAID:P,FILE_EXT:O,FILE_EXT_NORMAL:_,FILE_EXT_PAID:k,IMAGE_EXT:S,IMAGE_EXT_NORMAL:T,IMAGE_EXT_PAID:A,VIDEO_EXT:C,VIDEO_EXT_NORMAL:[],VIDEO_EXT_PAID:x,AUDIO_EXT:R,AUDIO_EXT_NORMAL:[],AUDIO_EXT_PAID:B}},1349:function(t,e,r){"use strict";r.d(e,"b",(function(){return a})),r.d(e,"a",(function(){return u}));var n=r(622),o=r.n(n),i=(r(29),r(125));function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.search;if(e){var r=o.a.parse(e);return r[t]||""}return""}var c=window.self!==window.top;function u(){var t=a("mode"),e=i.a.get("topicsPageMode");return"clean"===t?(i.a.set("topicsPageMode","clean"),"clean"):"normal"===t?(i.a.remove("topicsPageMode"),"normal"):e&&"clean"===e&&c?"clean":"normal"}},1395:function(t,e,r){var n=r(1856).getInterest,o=r(452).INTEREST_CODE;t.exports=function(){return n().interests[o.open_ocr]}},1441:function(t,e,r){"use strict";var n=r(134),o=r(899),i=r(435);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===a(i)?i:String(i)),n)}var o,i}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,a,u;return e=t,a=[{key:"previewImages",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t&&t.length){var a=window.appData,c=a.isAlipayApp,u=a.isDingTalkMiniApp,l=a.isYuqueMobileApp,f=r(241),s=f.getImageBrowser,p=s();if(c)window.AlipayJSBridge.call("imageViewer",{images:t.map((function(t){return{u:t.src,t:t.msrc}})),init:e},(function(r){r.success||p.open(t,e)}));else if(u)window.dd.postMessage({name:"previewImage",params:{urls:t.map((function(t){return t.src})),current:e}});else if(l){var y=i.a.getMobileAppVersion();Object(o.compareVersion)(y,"0.3.2")?n.a.previewImage({images:t.map((function(t){return{url:t.src,thumbnailUrl:t.msrc,width:t.w,height:t.h}})),index:e}):p.open(t,e)}else p.open(t,e)}}}],a&&c(e.prototype,a),u&&c(e,u),Object.defineProperty(e,"prototype",{writable:!1}),t}(),l=new u;e.a=l},1530:function(t,e,r){"use strict";r(2433);var n=r(1534);r(2299);e.a=n.a},2749:function(t,e,r){"use strict";var n,o=r(0),i=r.n(o),a=r(106),c=r.n(a),u=r(231),l=r.n(u),f=r(84),s=r.n(f),p=r(1574),y=r.n(p),d=r(2778),v=r(873),b=r(98),h=r(2775),m=r.n(h),g=r(2776),w=r.n(g),O=r(1395),_=r.n(O),k=r(2777),j=r(433),E=r(95),P=r(125),S=r(33),T=r(2907);function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function C(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function R(){R=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new E(o||[]);return n(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var s={};function p(){}function y(){}function d(){}var v={};u(v,i,(function(){return this}));var b=Object.getPrototypeOf,h=b&&b(b(P([])));h&&h!==e&&r.call(h,i)&&(v=h);var m=d.prototype=p.prototype=Object.create(v);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var u=f(t[n],t,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==A(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(s).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function O(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return S()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=_(a,r);if(c){if(c===s)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),s;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,s;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return y.prototype=d,n(m,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:y,configurable:!0}),y.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},t}function B(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function D(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){B(i,n,o,a,c,"next",t)}function c(t){B(i,n,o,a,c,"throw",t)}a(void 0)}))}}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M(n.key),n)}}function I(t,e,r){return(e=M(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M(t){var e=function(t,e){if("object"!==A(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===A(e)?e:String(e)}var U=c()("biz:lakex_mini_editor_base"),F=(null===(n=window.appData)||void 0===n?void 0:n.me)||{},V=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};L(this,t),I(this,"getDefaultSuggestions",(function(){return e.options.getDefaultSuggestions?e.options.getDefaultSuggestions():[]})),I(this,"setEngine",(function(t){e._engine=t})),I(this,"getEngine",(function(){return e._engine})),I(this,"setValue",(function(t){var r=t;t?t.startsWith("<")?(r={type:"lake",value:t},e._engine.setDocument(r)):"string"==typeof t&&(r={type:"json",value:JSON.parse(t)},e._engine.setDocument(r)):e._engine.setDocument()})),I(this,"getValue",(function(){return e._engine?e._engine.getPureContent():e.getDefaultValue()})),I(this,"isEmpty",(function(){return!e._engine||e._engine.isEmpty()})),I(this,"getSafetyValue",D(R().mark((function t(){return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.contentReady();case 2:return t.abrupt("return",e.getValue());case 3:case"end":return t.stop()}}),t)})))),I(this,"getHtml",(function(){return e._engine?e._engine.getPureHtml():null})),I(this,"focus",(function(t){if(!e._engine)return null;e._engine.focus(t)})),I(this,"contentReady",D(R().mark((function t(){var r,n;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._engine){t.next=2;break}return t.abrupt("return",null);case 2:return r=0,n=function t(n,o){e._engine.canGetDocument()?n():r>10?o():(r++,setTimeout((function(){t(n,o)}),1e3))},t.abrupt("return",new Promise(n));case 5:case"end":return t.stop()}}),t)})))),I(this,"saveAll",(function(){if(!e.options.disableCache){var t={format:s.a.FORMAT.LAKE,value:e.getValue(),html:e.getHtml()};e.saveToCache(t)}})),this.options=r,this.from=r.from||"reply",this.targetType=r.targetType,this.belong=r.belong,this.belongType=r.belongType,this.group=r.group,this.target=r.target,this.attachType=r.attachType,this.isEditMode=!!r.target,this.type=this.getType(),this.ctoken=Object(j.a)(window);var n=this.getCacheKey();this.cacheKeys={title:"".concat(n,"/title"),content:"".concat(n,"/content")},this.editorCache=new T.a(this.cacheKeys.content),this.uuid=this.getUuid(),this._engine=null,this.initialDocument=null,this.init()}var e,r,n;return e=t,r=[{key:"init",value:function(){this.initialDocument=this.getInitialDocument(),U("init use: ",this.initialDocument)}},{key:"buildOptions",value:function(t){var e={supportTranslate:w()(),supportImgOCR:_()(),hideEmbedButton:m()(),hideVipIcon:Object(k.a)(),board:{boardWebProxyParams:{webProxy:S.a,userId:null==F?void 0:F.id,spm:b,appData:window.appData}},image:{uploadFileURL:this.getImageUploadUrl(),accept:Object(v.getImageAcceptArr)()},file:{uploadFileURL:this.getFileUploadUrl(),accept:Object(v.getFileAcceptArr)(),localdocAccept:Object(v.getLocalDocAcceptArr)(),embedButtonStatus:Object(v.getIsDiabledPreviewAndEmbed)()},transfer:{transferFilesURL:this.getTransferUrl()},localdoc:{uploadFileURL:this.getFileUploadUrl(),accept:Object(v.getLocalDocAcceptArr)()},mention:{mentionURL:E.a.patchGroupIdToUrl(this.getMentionActionUrl()),defaultList:this.getDefaultSuggestions()},lockedtext:{action:this.getCryptoUrl()},placeholder:(null==t?void 0:t.placeholder)||this.getPlaceholder(),link:{autoCompleteLink:null==t?void 0:t.autoCompleteLink},video:{uploadAction:this.getMediaUploadUrl("video"),queryAction:"/api/video",accept:Object(v.getVideoAcceptArr)()},audio:{uploadFileURL:this.getMediaUploadUrl("audio"),queryURL:"/api/video",accept:Object(v.getAudioAcceptArr)()},vote:{allowVote:!0,queryDetailUrl:"api/votes",queryCheckUrl:"api/votes/mine",voteUrl:"api/votes"},yuque:{disableEmbedView:this.getDisableYuqueCardEmbedView()},materialLibrary:{component:i.a.createElement(d.a,{storage:P.a,webProxy:S.a})},fullscreen:{enable:this.getEnableFullEditor()}},r=[],n=this.getBlockedCards();return n&&n.length>1&&(r=Array.from(new Set([].concat(C(r),C(n))))),e.disabledPlugins=r,e}},{key:"getProps",value:function(){return{format:this.getFormat(),defaultValue:this.getDefaultValue(),autoFocus:this.getAutoFocus(),isMiniSize:this.isMiniSize()}}},{key:"getType",value:function(){return this.options.type||"unknown"}},{key:"getAutoFocus",value:function(){var t=this.options.autoFocus;return null!=t?t:!!this.options.useMiniGuide}},{key:"isMiniSize",value:function(){return!1}},{key:"getEnableFullEditor",value:function(){return!0}},{key:"getBlockedCards",value:function(){return["video","checkIn","vote","audio","premium"]}},{key:"getUuid",value:function(){var t=this.cacheKeys.uuid,e=P.a.get(t);return e||(e=l()(32)+l()(32),P.a.set(t,e)),e}},{key:"getDefaultFormat",value:function(){return s.a.FORMAT.LAKE}},{key:"getFormat",value:function(){var t=this.options.format;return t||this.initialDocument.format}},{key:"getPlaceholder",value:function(){return this.options.placeholder}},{key:"getInitialDocument",value:function(){if(this.initialDocument)return this.initialDocument;var t=this.loadFromCache();if(U("cached document:",t),this.isEditMode){var e=this.getContentObject();return U("adapted content: ",e),t&&(U("merge with cached content",t),e.format=t.format||e.format,e.title=t.title||e.title,e.value=t.value||e.value),e}if(t)return t.format=t.format||this.getDefaultFormat(),t;var r=this.loadFromUrl();return r||{format:this.getDefaultFormat(),title:null,value:null}}},{key:"getContentObject",value:function(t){return{format:(t=t||this.target||{}).format||this.getDefaultFormat(),title:t.title||t.name||"",value:t.value||t.body_asl||t.content}}},{key:"getDefaultValue",value:function(){var t=this.options.defaultValue;return t||this.initialDocument.value}},{key:"getFullUrl",value:function(t){return this.isEditMode&&!this.options.useBelongAttach?"".concat(t,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(t,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}},{key:"getTransferUrl",value:function(){var t="/api/upload/copy?type=attachment",e=this.getFullUrl(t);return e||(e="".concat(t,"&attachable_uuid=").concat(this.uuid,"&from=").concat(this.from)),e}},{key:"getFileUploadUrl",value:function(){var t="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.getFullUrl(t)}},{key:"getMediaUploadUrl",value:function(t){var e="/api/video?ctoken=".concat(this.ctoken,"&format=").concat(t);return this.getFullUrl(e)}},{key:"getImageUploadUrl",value:function(){var t=this.getFileUploadUrl();return t?t.replace("&type=attachment","&type=image"):null}},{key:"getMentionActionUrl",value:function(){var t="";return this.isEditMode&&!this.options.useBelongAttach?t="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.target.id):this.belong&&(t="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.belong.id)),t}},{key:"getCryptoUrl",value:function(){return"/api/services/crypto"}},{key:"getDisableYuqueCardEmbedView",value:function(){return this.options.disableYuqueCardEmbedView}},{key:"saveToCache",value:function(t){U("save to cache:",t),t.format&&(t.title&&P.a.set(this.cacheKeys.title,t.title),this.needCacheContent(t)?this.editorCache.put(t.value,t.format):U("value is empty or the same as origin, ignore cache"))}},{key:"needCacheContent",value:function(t){if(!t.value)return!1;if(y.a.isBlank(t))return this.editorCache.clear(),!1;if(!this.target)return!0;var e=this.getContentObject();return!y.a.isContentSame(t.format,e.value,t.value)}},{key:"reset",value:function(){U("reset editor"),this.clearCache(),this._engine&&this._engine.setDocument()}},{key:"isContentChanged",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!t){var e=this.loadFromCache();e&&(t=e.value)}if(!this.target)return!0;var r="<cursor />",n=this.target.body_asl;return n.trim().replace(r,"")!==t.trim().replace(r,"")}},{key:"clearCache",value:function(){var t=this;U("clear cache"),Object.keys(this.cacheKeys).forEach((function(e){P.a.remove(t.cacheKeys[e])}))}},{key:"getCacheKey",value:function(){return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/new"):"autosave/".concat(this.type)}},{key:"loadFromUrl",value:function(){}},{key:"loadFromCache",value:function(){var t=!1,e={format:null,title:null,value:null},r=this.editorCache.retrieve();if(r&&(t=!0,e.format=r.format,e.value=r.value),this.cacheKeys.title){var n=P.a.get(this.cacheKeys.title);n&&(t=!0,e.title=n)}return t?e:null}}],n=[{key:"getEmptyDocument",value:function(){return{format:s.a.FORMAT.LAKE,value:null}}}],r&&N(e.prototype,r),n&&N(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=V},2759:function(t,e,r){"use strict";var n=r(25);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,a=void 0,a=function(t,e){if("object"!==o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===o(a)?a:String(a)),n)}var i,a}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=u(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},c.apply(this,arguments)}function u(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return s(this,r)}}function s(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(s,t);var e,r,o,u=f(s);function s(){return i(this,s),u.apply(this,arguments)}return e=s,(r=[{key:"buildOptions",value:function(t){var e=c(p(s.prototype),"buildOptions",this).call(this,t);return e.disabledPlugins.push("mobile"),n.ua.mobile&&e.disabledPlugins.push("placeholder","slash"),e}},{key:"getBlockedCards",value:function(){return["video","audio","premium","checkIn"]}}])&&a(e.prototype,r),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),s}(r(2749).a);e.a=y},2817:function(t,e,r){"use strict";r.d(e,"c",(function(){return v})),r.d(e,"a",(function(){return j})),r.d(e,"l",(function(){return L})),r.d(e,"j",(function(){return it})),r.d(e,"h",(function(){return dt})),r.d(e,"i",(function(){return kt})),r.d(e,"k",(function(){return Rt})),r.d(e,"f",(function(){return Ut})),r.d(e,"d",(function(){return zt})),r.d(e,"e",(function(){return $t})),r.d(e,"g",(function(){return ue})),r.d(e,"b",(function(){return he}));var n=r(84),o=r.n(n),i=r(1343),a=r(2749);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==c(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===c(i)?i:String(i)),n)}var o,i}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=y(t);if(e){var o=y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(c,t);var e,r,n,a=s(c);function c(){return u(this,c),a.apply(this,arguments)}return e=c,n=[{key:"getEmptyDocument",value:function(){return{format:o.a.FORMAT.LAKE,value:null}}}],(r=[{key:"getType",value:function(){var t=this.options.targetType;return t?"".concat(t,"_comment").toLowerCase():"comment"}},{key:"getCacheKey",value:function(){var t=this.options.replyId;return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(t,"/new"):"autosave/".concat(this.type)}},{key:"isMiniSize",value:function(){return this.options.useMiniGuide||this.options.isMiniSize||window.h5}},{key:"getDefaultFormat",value:function(){return i.a.getDefaultDocumentFormat(o.a.TYPE.TOPIC)}},{key:"getEnableFullEditor",value:function(){return"Artboard"!==this.targetType}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(a.a),v=d;function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==b(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===b(i)?i:String(i)),n)}var o,i}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=_(t);if(e){var o=_(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return O(this,r)}}function O(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(i,t);var e,r,n,o=w(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h(this,i),t.attachType="Resource",t.useBelongAttach=!0,t.from="reply",o.call(this,t)}return e=i,(r=[{key:"getType",value:function(){return"area_comment"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&m(e.prototype,r),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(v),j=k;function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==E(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===E(i)?i:String(i)),n)}var o,i}function T(){return T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=A(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},T.apply(this,arguments)}function A(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=B(t)););return t}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=B(t);if(e){var o=B(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R(this,r)}}function R(t,e){if(e&&("object"===E(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(i,t);var e,r,n,o=x(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return P(this,i),t.attachType="Doc",t.useBelongAttach=!0,t.from="reply",o.call(this,t)}return e=i,(r=[{key:"buildOptions",value:function(t){var e,r=T(B(i.prototype),"buildOptions",this).call(this,t);return r.image.showMiniToolbarWhen="never",null===(e=r.disabledPlugins)||void 0===e||e.push("slash"),r}},{key:"getType",value:function(){return"word_comment"}},{key:"getAutoFocus",value:function(){return!1}},{key:"isMiniSize",value:function(){return!0}},{key:"getEnableFullEditor",value:function(){return!1}}])&&S(e.prototype,r),n&&S(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(v),L=D,N=r(1349),I=r(125),M=r(2759);function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==U(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===U(i)?i:String(i)),n)}var o,i}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Y(t);if(e){var o=Y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return X(this,r)}}function X(t,e){if(e&&("object"===U(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}M.a;var q=r(29),z=r.n(q);function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function K(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function W(t,e,r){return(e=Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Z(n.key),n)}}function Z(t){var e=function(t,e){if("object"!==H(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===H(e)?e:String(e)}function $(t,e){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$(t,e)}function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=rt(t);if(e){var o=rt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return et(this,r)}}function et(t,e){if(e&&("object"===H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}var nt={daily:{title:"#prefix# #day# 日报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>建议 TL 每天组织日会，将一天的重点事项安排于此</p><p>每位同学下班前，在此提交日报</p><p><br /></p><p>日报不要记流水账，尽量在 200 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的日报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},weekly:{title:"#prefix# #day# 周报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>将一周的工作总结回复于此</p><p><br /></p><p>不要记流水账，尽量在 800 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的周报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},vote:{title:"一起来投票吧",content:'<!doctype lake><meta name="doc-version" content="1" /><card type="block" name="vote" value="data:%7B%22margin%22%3Atrue%2C%22id%22%3A%22jTHWG%22%2C%22type%22%3A%22single%22%7D"></card><p><br /><cursor /></p>'},default:{title:"",content:"<!doctype lake><p></p>"}},ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$(t,e)}(i,t);var e,r,n,o=tt(i);function i(){return J(this,i),o.apply(this,arguments)}return e=i,n=[{key:"getTemplate",value:function(t,e){var r=nt[t];if(!r)return{title:null,content:null};var n=z()(new Date).format("YYYY-MM-DD"),o=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?K(Object(r),!0).forEach((function(e){W(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},r);return o.title=o.title.replace("#prefix#",e),o.title=o.title.replace("#day#",n),o}}],(r=[{key:"getType",value:function(){return"thread"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var t="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode?"".concat(t,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(t,"&attachable_type=").concat(this.belongType||"Book","&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):this.group?"".concat(t,"&attachable_type=User&attachable_id=").concat(this.group.id,"&from=").concat(this.from):null}},{key:"getFileCopyUrl",value:function(){var t="/api/upload/copy?type=attachment";return this.isEditMode?"".concat(t,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):"".concat(t,"&attachable_uuid=").concat(this.uuid,"&from=").concat(this.from)}}])&&Q(e.prototype,r),n&&Q(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(M.a),it=ot;function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==at(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===at(i)?i:String(i)),n)}var o,i}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=pt(t);if(e){var o=pt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return st(this,r)}}function st(t,e){if(e&&("object"===at(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pt(t){return pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pt(t)}var yt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(i,t);var e,r,n,o=ft(i);function i(){return ct(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"getType",value:function(){return"thread_board"}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var t="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode&&!this.options.useBelongAttach?"".concat(t,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(t,"&attachable_type=").concat(this.belongType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}}])&&ut(e.prototype,r),n&&ut(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a.a),dt=yt;function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==vt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===vt(i)?i:String(i)),n)}var o,i}function mt(t,e){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mt(t,e)}function gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ot(t);if(e){var o=Ot(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return wt(this,r)}}function wt(t,e){if(e&&("object"===vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}var _t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mt(t,e)}(i,t);var e,r,n,o=gt(i);function i(){return bt(this,i),o.apply(this,arguments)}return e=i,(r=[{key:"getType",value:function(){return"thread_comment"}}])&&ht(e.prototype,r),n&&ht(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(v),kt=_t;function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==jt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===jt(i)?i:String(i)),n)}var o,i}function Pt(){return Pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=St(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Pt.apply(this,arguments)}function St(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xt(t)););return t}function Tt(t,e){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tt(t,e)}function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=xt(t);if(e){var o=xt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ct(this,r)}}function Ct(t,e){if(e&&("object"===jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xt(t){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(t)}var Rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tt(t,e)}(i,t);var e,r,n,o=At(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.attachType="User",t.useBelongAttach=!0,o.call(this,t)}return e=i,(r=[{key:"buildOptions",value:function(t){var e=Pt(xt(i.prototype),"buildOptions",this).call(this,t);return e.typography={mustTypography:"classic",typography:"classic",paragraphSpacing:"relax"},e}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&Et(e.prototype,r),n&&Et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a.a);function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function Dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==Bt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Bt(i)?i:String(i)),n)}var o,i}function Lt(t,e){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lt(t,e)}function Nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Mt(t);if(e){var o=Mt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return It(this,r)}}function It(t,e){if(e&&("object"===Bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Mt(t){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mt(t)}var Ut=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}(i,t);var e,r,n,o=Nt(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.from="group_custom",t.attachType="User",t.useBelongAttach=!0,o.call(this,t)}return e=i,(r=[{key:"getType",value:function(){return"group_custom"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&Dt(e.prototype,r),n&&Dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a.a);function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function Vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==Ft(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Ft(i)?i:String(i)),n)}var o,i}function Gt(t,e){return Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gt(t,e)}function Xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=qt(t);if(e){var o=qt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Yt(this,r)}}function Yt(t,e){if(e&&("object"===Ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}var zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gt(t,e)}(i,t);var e,r,n,o=Xt(i);function i(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=t.feedback;return t.attachType="User",t.useBelongAttach=!0,t.from="feedback",t.placeholder={tip:e&&e.abilities.manage?"你将要代表语雀回复用户，请使用官方口吻，慎重填写":"",emptyParagraphTip:""},o.call(this,t)}return e=i,(r=[{key:"getType",value:function(){return"feedback_comment"}},{key:"getCacheKey",value:function(){var t=this.getType();if(this.target)return"autosave/".concat(t,"/").concat(this.target.id,"/edit");var e=this.options.feedback;return e?"autosave/".concat(t,"/").concat(e.id,"/new"):"autosave/".concat(t)}},{key:"getContentObject",value:function(){var t=this.target.content||{source:"",format:"lake"};return{format:t.format,value:t.source||""}}},{key:"isMiniSize",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}}])&&Vt(e.prototype,r),n&&Vt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(M.a);function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Kt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==Ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Ht(i)?i:String(i)),n)}var o,i}function Wt(t,e){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wt(t,e)}function Jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Zt(t);if(e){var o=Zt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Qt(this,r)}}function Qt(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zt(t){return Zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zt(t)}var $t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wt(t,e)}(i,t);var e,r,n,o=Jt(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.attachType="User",t.useBelongAttach=!0,t.placeholder={tip:"",emptyParagraphTip:""},t.from="feedback",o.call(this,t)}return e=i,(r=[{key:"getType",value:function(){return"feedback_remark"}},{key:"getContentObject",value:function(){return{format:"lake",value:this.target.remark||""}}},{key:"getCacheKey",value:function(){return this.target?"autosave/".concat(this.type,"/").concat(this.target.id):"autosave/".concat(this.type)}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&Kt(e.prototype,r),n&&Kt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(M.a);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==te(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===te(i)?i:String(i)),n)}var o,i}function re(){return re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=ne(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},re.apply(this,arguments)}function ne(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ce(t)););return t}function oe(t,e){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oe(t,e)}function ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ce(t);if(e){var o=ce(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ae(this,r)}}function ae(t,e){if(e&&("object"===te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ce(t){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ce(t)}var ue=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oe(t,e)}(i,t);var e,r,n,o=ie(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.target&&(t.attachType="Doclet"),o.call(this,t)}return e=i,(r=[{key:"getCards",value:function(){return this.options.target?re(ce(i.prototype),"getCards",this).call(this):["label"]}},{key:"getFullCards",value:function(){return this.options.target?re(ce(i.prototype),"getFullCards",this).call(this):["label"]}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return!1}}])&&ee(e.prototype,r),n&&ee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a.a);function le(t){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(t)}function fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==le(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===le(i)?i:String(i)),n)}var o,i}function se(){return se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=pe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},se.apply(this,arguments)}function pe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=be(t)););return t}function ye(t,e){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ye(t,e)}function de(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=be(t);if(e){var o=be(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ve(this,r)}}function ve(t,e){if(e&&("object"===le(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function be(t){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},be(t)}var he=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ye(t,e)}(i,t);var e,r,n,o=de(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),t.attachType="Doclet",o.call(this,t)}return e=i,(r=[{key:"buildOptions",value:function(t){var e=se(be(i.prototype),"buildOptions",this).call(this,t);return e.typography={typography:"classic",paragraphSpacing:"relax"},e}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&fe(e.prototype,r),n&&fe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(a.a)},2907:function(t,e,r){"use strict";var n=r(106),o=r.n(n),i=r(125),a=r(1574),c=r.n(a);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===u(i)?i:String(i)),n)}var o,i}var f=o()("editor:cache"),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e}var e,r,n;return e=t,(r=[{key:"retrieve",value:function(){var t={format:null,value:null};f("[retrieve]key: ",this.key);var e=i.a.get(this.key);if(!e)return null;f("[retrieve]find text: ",e);var r=c.a.guessFormat(e);return t.format=r,t.value=e,f("[retrieve]doc: ",t),t}},{key:"put",value:function(t,e){f("[put]content cached: ","".concat(this.key," -> ").concat(t)),i.a.set(this.key,t)}},{key:"clear",value:function(){i.a.remove(this.key)}}])&&l(e.prototype,r),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=s},3792:function(t,e,r){},3904:function(t,e,r){"use strict";var n,o;r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return o})),function(t){t.Toc="toc",t.CreatedAt="created_at",t.UpdatedAt="updated_at"}(n||(n={})),function(t){t.Book="Book",t.Card="Card",t.Column="Column",t.Custom="Custom"}(o||(o={}))},3905:function(t,e,r){"use strict";e.a={containerWrapper:"BookOverview-module_containerWrapper_DgnNE",upload:"BookOverview-module_upload_oDqT-",container:"BookOverview-module_container_1XOeO",bookHead:"BookOverview-module_bookHead_+4tu8",bookTitle:"BookOverview-module_bookTitle_dJHa-",bookIcon:"BookOverview-module_bookIcon_wlbhc",editable:"BookOverview-module_editable_qciTg",bookName:"BookOverview-module_bookName_+UPrt",action:"BookOverview-module_action_Syxj1",bookAction:"BookOverview-module_bookAction_ROIf-",bookActionItem:"BookOverview-module_bookActionItem_sbPH8",needSave:"BookOverview-module_needSave_pVuxm",update:"BookOverview-module_update_HbybS",star:"BookOverview-module_star_uvjUk",share:"BookOverview-module_share_gT2zn",statistics:"BookOverview-module_statistics_uHBns",docCount:"BookOverview-module_docCount_rTm77",wordCount:"BookOverview-module_wordCount_-Mcic",count:"BookOverview-module_count_4RxbQ",bookContributor:"BookOverview-module_bookContributor_yQxOn",editor:"BookOverview-module_editor_T56aC",viewer:"BookOverview-module_viewer_wHZhn",none:"BookOverview-module_none_Ec8cF",togglePanel:"BookOverview-module_togglePanel_mPWOh",title:"BookOverview-module_title_ok4h8",desc:"BookOverview-module_desc_mHhnV",toggleItem:"BookOverview-module_toggleItem_c4bNf",catalogHeaderTitle:"BookOverview-module_catalogHeaderTitle_6yl+P",tocContainer:"BookOverview-module_tocContainer_GR86Z",headerSwitch:"BookOverview-module_headerSwitch_xlCUf",switchBtnBg:"BookOverview-module_switchBtnBg_Gj+Gg",treeSelected:"BookOverview-module_treeSelected_tqaat",cardSelected:"BookOverview-module_cardSelected_S9EbS",columnSelected:"BookOverview-module_columnSelected_5Qn-T",switchButtons:"BookOverview-module_switchButtons_tH51-",switchBtn:"BookOverview-module_switchBtn_IVGhh",switchIcon:"BookOverview-module_switchIcon_5iInw",switchBtnSelected:"BookOverview-module_switchBtnSelected_IfORb",catalogModule:"BookOverview-module_catalogModule_xPRJ4",catalogMoreIcon:"BookOverview-module_catalogMoreIcon_tV7z9",empty:"BookOverview-module_empty_CmmT6",mt_26:"BookOverview-module_mt_26_iuvqB",selectPanel:"BookOverview-module_selectPanel_iQlU8",selectTitle:"BookOverview-module_selectTitle_nHGBR",selectItem:"BookOverview-module_selectItem_kWvPj",divider:"BookOverview-module_divider_FyGF3"}},3906:function(t,e,r){"use strict";r(1208);var n=r(630);r(3792);e.a=n.a},4326:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return ot}));r(3792);var n=r(3906),o=(r(2299),r(1530)),i=(r(103),r(60)),a=(r(1508),r(1340)),c=(r(166),r(31)),u=(r(279),r(136)),l=(r(953),r(443)),f=(r(62),r(21)),s=(r(63),r(23)),p=(r(429),r(152)),y=r(0),d=r.n(y),v=r(570),b=r(2908),h=r(490),m=r(750),g=r(747),w=r(746),O=r(749),_=r(646),k=r(9),j=r.n(k),E=r(4327),P=r.n(E),S=r(105),T=r(125),A=r(111),C=r(368),x=r(18),R=r(287),B=r(30),D=r(2817),L=r(3904),N=r(3905);function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function U(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?M(Object(r),!0).forEach((function(e){q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function F(){F=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new E(o||[]);return n(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var s={};function p(){}function y(){}function d(){}var v={};u(v,i,(function(){return this}));var b=Object.getPrototypeOf,h=b&&b(b(P([])));h&&h!==e&&r.call(h,i)&&(v=h);var m=d.prototype=p.prototype=Object.create(v);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var u=f(t[n],t,i);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==I(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(s).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function O(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return S()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=_(a,r);if(c){if(c===s)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),s;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,s;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return y.prototype=d,n(m,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:y,configurable:!0}),y.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(m),u(m,c,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},t}function V(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function G(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){V(i,n,o,a,c,"next",t)}function c(t){V(i,n,o,a,c,"throw",t)}a(void 0)}))}}function X(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function q(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==I(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===I(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var z=Object(R.b)((function(){return Promise.resolve().then(r.bind(null,3753))}),{suspense:!0}),H=Object(R.b)((function(){return r.e(123).then(r.bind(null,4332))}),{suspense:!0}),K=Object(R.b)((function(){return r.e(119).then(r.bind(null,3083))}),{suspense:!0}),W=Object(R.b)((function(){return r.e(120).then(r.bind(null,3058))}),{suspense:!0}),J=Object(R.b)((function(){return Promise.all([r.e(0),r.e(1),r.e(26)]).then(r.bind(null,2984)).then((function(t){return t.ShareButton}))}),{suspense:!0}),Q=Object(R.b)((function(){return Promise.all([r.e(0),r.e(1),r.e(4),r.e(6),r.e(129)]).then(r.bind(null,2831))}),{suspense:!0}),Z=Object(R.b)((function(){return Promise.all([r.e(0),r.e(1),r.e(4),r.e(6),r.e(130)]).then(r.bind(null,1458))}),{suspense:!0}),$=Object(R.b)((function(){return Promise.all([r.e(24),r.e(121)]).then(r.bind(null,4328))}),{suspense:!0}),tt=function(t){var e=t.sections;return d.a.createElement("div",{className:N.a.selectPanel},e.map((function(t,r){return d.a.createElement("div",{key:r},e.length>1&&r>0&&r<e.length&&d.a.createElement(p.a,{className:N.a.divider}),d.a.createElement("div",{className:N.a.selectSection},t.title&&d.a.createElement("div",{className:N.a.selectTitle},t.title),t.content))})))},et=function(t){var e=t.order,r=t.onChangeOrder;return d.a.createElement(tt,{sections:[{title:__("排序"),content:d.a.createElement("div",{className:N.a.selectList},[{name:__("按目录顺序"),value:L.b.Toc},{name:__("按创建时间"),value:L.b.CreatedAt},{name:__("按更新时间"),value:L.b.UpdatedAt}].map((function(t){return d.a.createElement("div",{className:N.a.selectItem,onClick:function(){return r(t.value)},key:t.value},d.a.createElement("span",null,t.name),e===t.value&&d.a.createElement(h.a,null))})))}]})},rt=function(t){var e,r=t.layout,n=t.maxLevel,o=t.displayValue,i=t.onChangeLevel,a=t.tailType,c=t.onChangeTailType,u=t.onChangeOrder,l=t.order;return(e={},q(e,L.a.Book,d.a.createElement(tt,{sections:[{title:__("默认展示"),content:d.a.createElement("div",{className:N.a.selectList},[{name:__("全部层级"),value:"all"}].concat(Array.from({length:n},(function(t,e){return{name:__("第 {level} 级",{level:e+1}),value:e.toString()}}))).map((function(t){return d.a.createElement("div",{className:N.a.selectItem,onClick:function(){return i(t.value)},key:t.value},d.a.createElement("span",null,t.name),o===t.value&&d.a.createElement(h.a,null))})))},{title:__("显示"),content:d.a.createElement("div",{className:N.a.selectList},[{name:__("创建时间"),value:A.TOC_TAIL_TYPES.CREATED_AT},{name:__("更新时间"),value:A.TOC_TAIL_TYPES.UPDATED_AT},{name:__("作者"),value:A.TOC_TAIL_TYPES.AUTHOR},{name:__("文档路径"),value:A.TOC_TAIL_TYPES.SLUG}].map((function(t){return d.a.createElement("div",{className:N.a.selectItem,onClick:function(){return c(t.value)},key:t.value},d.a.createElement("span",null,t.name),a===t.value&&d.a.createElement(h.a,null))})))}]})),q(e,L.a.Card,d.a.createElement(et,{order:l,onChangeOrder:u})),q(e,L.a.Column,d.a.createElement(et,{order:l,onChangeOrder:u})),e)[r]},nt=function(t){var e=t.enable,r=t.editable,n=t.editComponent,o=t.viewComponent,i=t.className;if(!e)return null;var a=r?n:o;return d.a.createElement("div",{className:i},a)};function ot(){var t,e,r,p,h,k,E,A=Object(v.e)(),R=Object(v.f)((function(t){return{book:t.book,me:t.me,group:t.group}})),I=R.book,M=R.me,V=R.group,Y=Object(y.useRef)(null),tt=Object(y.useRef)(null),et="bookOverview/doclet/".concat(I.id),ot=X(Object(y.useState)(!0),2),it=ot[0],at=ot[1],ct=X(Object(y.useState)(!0),2),ut=ct[0],lt=ct[1],ft=X(Object(y.useState)(!1),2),st=ft[0],pt=ft[1],yt=X(Object(y.useState)(null),2),dt=yt[0],vt=yt[1],bt=X(Object(y.useState)(""),2),ht=bt[0],mt=bt[1],gt=X(Object(y.useState)(!1),2),wt=gt[0],Ot=gt[1],_t=X(Object(y.useState)(L.a.Book),2),kt=_t[0],jt=_t[1],Et=X(Object(y.useState)(!1),2),Pt=Et[0],St=Et[1],Tt=X(Object(y.useState)(!1),2),At=Tt[0],Ct=Tt[1],xt=X(Object(y.useState)(!1),2),Rt=xt[0],Bt=xt[1],Dt=X(Object(y.useState)({wordCount:0,enableCustomBody:!0,enableCatalog:!0,order:L.b.Toc}),2),Lt=Dt[0],Nt=Dt[1],It=Lt.wordCount,Mt=Lt.enableCustomBody,Ut=Lt.enableCatalog,Ft=Lt.order,Vt=X(Object(y.useState)([]),2),Gt=Vt[0],Xt=Vt[1],Yt={order:Ft,book:I,inTocDocs:Gt,catalogLoading:ut,layout:kt,group:V,isEdit:wt};Object(y.useEffect)((function(){G(F().mark((function t(){var e,r,n,o,i,a,c,u,l,f;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.webProxy.books.getOverviewInfo({id:I.id});case 2:return e=t.sent,r=e.wordCount,n=e.contributors,o=e.enableCustomBody,i=e.enableCatalog,a=e.layout,c=e.customIndex,u=e.order,l=e.enableUserFeed,window.appData.enableUserFeed=l,Nt({wordCount:r,enableCustomBody:o,enableCatalog:i,order:u}),a===L.a.Custom?jt(L.a.Book):jt(a),vt(c),mt(c.body_asl),Y.current=new D.b({defaultValue:c.body_asl,target:c}),A({type:"book/update",payload:{contributors:n}}),a===L.a.Book&&(at(!1),lt(!1)),t.next=21,S.webProxy.docs.find({book_id:I.id});case 21:f=t.sent,A({type:"book/update",payload:{docs:f}}),Xt(te(f.filter((function(t){return!Object(C.isDocNotInToc)(t,I.toc)})).filter(Boolean),u)),at(!1),lt(!1);case 26:case"end":return t.stop()}}),t)})))()}),[]),Object(y.useEffect)((function(){G(F().mark((function t(){var e,r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=null,!M.id){t.next=6;break}return t.next=4,S.webProxy.mine.marks.findOne({target_type:"Book",id:I.id});case 4:r=t.sent,e=r.markAction;case 6:A({type:"book/update",payload:{mark:e}});case 7:case"end":return t.stop()}}),t)})))()}),[]);var qt=Object(y.useMemo)((function(){var t,e=I.catalog_display_level||10,r=1;return null===(t=I.toc)||void 0===t||t.forEach((function(t){r=Math.max(r,t.level)})),r<2&&(r=Math.max(r,2)),"all"!==e&&(r=Math.max(e,r)),r}),[I.toc,I.catalog_display_level]),zt=function(){var t=G(F().mark((function t(){var e;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=Y&&Y.current){t.next=2;break}return t.abrupt("return");case 2:T.a.set(et,null==Y||null===(e=Y.current)||void 0===e?void 0:e.getValue()),Ct(!0);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ht=function(){var t=G(F().mark((function t(){var e,r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(dt){t.next=2;break}return t.abrupt("return");case 2:if(T.a.remove(et),Y.current){t.next=5;break}return t.abrupt("return");case 5:if((e=Y.current.getValue())!==ht){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,S.webProxy.doclets.updateContent({id:null==dt?void 0:dt.id,body_asl:e,format:"lake",draft_version:null==dt?void 0:dt.draft_version});case 10:return t.next=12,S.webProxy.doclets.publish({id:dt.id});case 12:return t.next=14,S.webProxy.doclets.findOne({id:dt.id});case 14:r=t.sent,mt(r.body_asl),vt(r),Y.current=new D.b({defaultValue:r.body_asl,target:r});case 18:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Kt=function(){var t=G(F().mark((function t(){var e,r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=Y&&Y.current){t.next=2;break}return t.abrupt("return");case 2:e=T.a.get(et),r=e||ht,Y.current.setValue(r);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Wt=function(){var t=G(F().mark((function t(){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ht().finally((function(){Ot(!1),Ct(!1)}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Jt=function(){var t=G(F().mark((function t(e){var r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.webProxy.books.update({id:I.id,cover:e});case 2:return Bt(!1),t.next=5,S.webProxy.books.findOne({id:I.id,find_by_id:!0});case 5:r=t.sent,A({type:"book/update",payload:{cover:r.cover}});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Qt=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A({type:"book/updateSettingProps",payload:{book_icon:e}}),t.next=3,S.webProxy.books.update({id:I.id,book_icon:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Zt=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return St(!1),A({type:"book/update",payload:U(U({},I),{},{catalog_display_level:e})}),t.next=4,S.webProxy.catalogNodes.updateSettings({book_id:I.id,catalog_display_level:e});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),$t=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return St(!1),A({type:"book/update",payload:U(U({},I),{},{catalog_tail_type:e})}),t.next=4,S.webProxy.catalogNodes.updateSettings({book_id:I.id,catalog_tail_type:e});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),te=function(t,e){if(L.b.Toc===e){var r,n=P()(t.map((function(t){return[t.id,t]})));return null===(r=I.toc)||void 0===r?void 0:r.filter((function(t){return"DOC"===t.type})).map((function(t){return n[t.doc_id]})).filter(Boolean)}return L.b.CreatedAt===e?t.sort((function(t,e){return new Date(e.created_at).getTime()-new Date(t.created_at).getTime()})):L.b.UpdatedAt===e?t.sort((function(t,e){return new Date(e.content_updated_at).getTime()-new Date(t.content_updated_at).getTime()})):[]},ee=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return St(!1),Nt(U(U({},Lt),{},{order:e})),Xt(te(Gt,e)),t.next=5,S.webProxy.books.updateSettings({id:I.id,order:e});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),re=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Nt(U(U({},Lt),{},{enableCustomBody:e})),t.next=3,S.webProxy.books.updateSettings({id:I.id,enable_custom_body:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ne=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Nt(U(U({},Lt),{},{enableCatalog:e})),t.next=3,S.webProxy.books.updateSettings({id:I.id,enable_catalog:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),oe=function(){var t=G(F().mark((function t(e){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return jt(e),t.next=3,S.webProxy.books.updateSettings({id:I.id,layout:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ie=function(){var t=G(F().mark((function t(e){var r;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.webProxy.books.update(e,{ignoreGlobalMessage:!0});case 2:r=t.sent,A({type:"book/update",payload:{public:r.public,password:r.password,indexed_level:r.indexed_level,privacy_migrated:r.privacy_migrated}}),Object.keys(e).includes("public")&&(r.public===x.PRIVACY.private?s.a.success(__("已关闭分享知识库里的所有内容")):s.a.success(__("已对知识库里所有内容生效")));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return d.a.createElement("div",{className:N.a.containerWrapper},wt&&d.a.createElement("div",{className:N.a.upload,onClick:function(){return Bt(!0)}},d.a.createElement("span",null,__("替换背景"))),d.a.createElement("div",{className:N.a.container},d.a.createElement(a.a,{avatar:{shape:"square",size:36},title:{width:200},paragraph:{rows:2},active:!0,loading:it},d.a.createElement("div",{className:N.a.bookHead},d.a.createElement("div",{className:N.a.bookTitle},d.a.createElement(b.a,{className:j()(N.a.bookIcon,q({},N.a.editable,wt)),value:I.book_icon,updateIcon:Qt,width:38,height:46,disabled:!wt}),d.a.createElement("span",{className:N.a.bookName},I.name)),d.a.createElement("div",{className:N.a.action},d.a.createElement("div",{className:N.a.bookAction},!wt&&d.a.createElement(W,{className:j()(N.a.bookActionItem,N.a.star),iconSize:16,book:I}),((null===(t=I.abilities)||void 0===t?void 0:t.share)||(null===(e=I.abilities)||void 0===e?void 0:e.create_collaborator))&&!wt&&d.a.createElement(d.a.Fragment,null,d.a.createElement(J,{shareViewType:"BOOK",key:"share-book-".concat(I.id),targetResource:I,onChangeShare:ie,organization:window.appData.organization,book:I,group:V,me:M,canShare:null===(r=I.abilities)||void 0===r?void 0:r.share,canCollaborator:null===(p=I.abilities)||void 0===p?void 0:p.create_collaborator},d.a.createElement(f.a,{className:j()(N.a.bookActionItem,N.a.share)},d.a.createElement("span",null,__("分享"))))),wt&&d.a.createElement(u.a,{trigger:"click",placement:"bottomRight",content:d.a.createElement("div",{className:N.a.togglePanel},d.a.createElement("div",{className:N.a.title},__("页面设置")),d.a.createElement("p",{className:N.a.desc},__("选择是否显示以下模块，打开即为显示")),d.a.createElement("div",{className:N.a.toggleItem},d.a.createElement("span",null,__("自定义模块")),d.a.createElement(l.a,{checked:Mt,onChange:re})),d.a.createElement("div",{className:N.a.toggleItem},d.a.createElement("span",null,__("目录模块")),d.a.createElement(l.a,{checked:Ut,onChange:ne})))},d.a.createElement("div",{className:j()(N.a.bookActionItem,N.a.setting)},d.a.createElement(m.a,{width:18,height:18}))),(null===(h=I.abilities)||void 0===h?void 0:h.create_doc)&&!wt&&d.a.createElement(z,{book:I,group:V,placement:"bottomRight",className:N.a.bookActionItem,prepend:(null===(k=I.abilities)||void 0===k?void 0:k.modify_setting)&&d.a.createElement(c.a.Item,{key:"edit",className:N.a.menuItem,onClick:function(){return Ot(!0)},icon:d.a.createElement(B.b,{width:16,name:"edit-border"})},__("编辑首页"))}),wt&&d.a.createElement("div",{className:j()(N.a.bookActionItem,N.a.update,At?N.a.needSave:""),onClick:Wt},__("更新"))))),d.a.createElement("div",{className:N.a.statistics},d.a.createElement("span",{className:N.a.docCount},d.a.createElement("b",{className:N.a.count},Gt.length||0)," ",__("文档")),d.a.createElement("span",{className:N.a.wordCount},d.a.createElement("b",{className:N.a.count},It)," ",__("字"))),d.a.createElement(K,{className:N.a.bookContributor,users:I.contributors,canEdit:I.abilities.modify_setting&&wt,bookId:I.id})),d.a.createElement(nt,{editable:(null==Y?void 0:Y.current)&&wt,enable:Mt,editComponent:d.a.createElement("div",{className:N.a.editor},d.a.createElement(Q,{editor:Y.current,tplDoc:{type:"repoHomePage"},placeholder:{tip:__("直接输入正文，也可选择一个模板："),emptyParagraphTip:__("输入 / 唤起更多")},needCreateGuide:!0,onChange:zt,onSubmit:Ht,onLoad:Kt})),viewComponent:d.a.createElement(a.a,{className:N.a.viewer,title:!1,paragraph:{rows:3},active:!0,loading:it},d.a.createElement("div",{className:j()(N.a.viewer,q({},N.a.none,st))},d.a.createElement(Z,{forwardedRef:tt,content:ht,genOutline:!1,genAnchor:!1,simpleUI:!0,onReady:function(){var t,e,r;wt&&pt(null==Y||null===(r=Y.current)||void 0===r?void 0:r.isEmpty());pt((null==tt||null===(t=tt.current)||void 0===t||null===(e=t.viewer)||void 0===e?void 0:e.queryCommandValue("isEmpty"))||!1)}})))}),d.a.createElement(nt,{className:N.a.catalogModule,editable:wt,enable:Ut,editComponent:d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:N.a.headerSwitch},d.a.createElement("div",{className:j()(N.a.switchBtnBg,(E={},q(E,N.a.treeSelected,kt===L.a.Book),q(E,N.a.cardSelected,kt===L.a.Card),q(E,N.a.columnSelected,kt===L.a.Column),E))}),d.a.createElement("div",{className:N.a.switchButtons},d.a.createElement(i.a,{placement:"bottom",title:__("目录视图")},d.a.createElement("div",{className:j()(N.a.switchBtn,q({},N.a.switchBtnSelected,kt===L.a.Book)),onClick:function(){return oe(L.a.Book)}},d.a.createElement(g.a,{className:N.a.switchIcon}))),d.a.createElement(i.a,{placement:"bottom",title:__("卡片视图")},d.a.createElement("div",{className:j()(N.a.switchBtn,q({},N.a.switchBtnSelected,kt===L.a.Card)),onClick:function(){return oe(L.a.Card)}},d.a.createElement(w.a,{className:N.a.switchIcon}))),d.a.createElement(i.a,{placement:"bottom",title:__("专栏视图")},d.a.createElement("div",{className:j()(N.a.switchBtn,q({},N.a.switchBtnSelected,kt===L.a.Column)),onClick:function(){return oe(L.a.Column)}},d.a.createElement(O.a,{className:N.a.switchIcon}))))),d.a.createElement(u.a,{trigger:"click",placement:"bottomRight",visible:Pt,onVisibleChange:function(t){return St(t)},content:d.a.createElement(rt,{layout:kt,maxLevel:qt,displayValue:I.catalog_display_level,onChangeLevel:Zt,tailType:I.catalog_tail_type,onChangeTailType:$t,order:Ft,onChangeOrder:ee})},d.a.createElement("div",{className:N.a.catalogMoreIcon,onClick:function(){return St(!0)}},d.a.createElement(_.a,{width:16,height:16})," "))),viewComponent:d.a.createElement("div",{className:N.a.catalogHeaderTitle})}),d.a.createElement(nt,{enable:Ut,viewComponent:d.a.createElement($,Yt)}),wt||Mt||Ut?null:d.a.createElement(n.a,{className:N.a.empty,image:"https://gw.alipayobjects.com/mdn/prod_resou/afts/img/A*wPMVTriBo40AAAAAAAAAAAAAARQnAQ",description:d.a.createElement(o.a,null,__("暂无内容"))})),Rt&&d.a.createElement(H,{cover:I.cover,bookId:I.id,visible:Rt,onCancel:function(){return Bt(!1)},onSubmit:Jt}))}},4327:function(t,e){t.exports=function(t){for(var e=-1,r=null==t?0:t.length,n={};++e<r;){var o=t[e];n[o[0]]=o[1]}return n}},873:function(t,e,r){"use strict";r.r(e),r.d(e,"getFileAccept",(function(){return O})),r.d(e,"getImageAccept",(function(){return _})),r.d(e,"EmbedButtonStatus",(function(){return k})),r.d(e,"getIsDiabledPreviewAndEmbed",(function(){return j})),r.d(e,"getLocalDocAcceptArr",(function(){return E})),r.d(e,"getFileAcceptArr",(function(){return P})),r.d(e,"getImageAcceptArr",(function(){return S})),r.d(e,"getVideoAcceptArr",(function(){return T})),r.d(e,"getAudioAcceptArr",(function(){return A}));var n=r(109),o=r(164),i=n.a.LOCAL_DOC_EXT,a=n.a.LOCAL_DOC_EXT_NORMAL,c=n.a.LOCAL_DOC_EXT_PAID,u=n.a.FILE_EXT,l=n.a.FILE_EXT_NORMAL,f=n.a.FILE_EXT_PAID,s=n.a.IMAGE_EXT,p=n.a.IMAGE_EXT_NORMAL,y=n.a.IMAGE_EXT_PAID,d=n.a.VIDEO_EXT,v=n.a.VIDEO_EXT_NORMAL,b=n.a.VIDEO_EXT_PAID,h=n.a.AUDIO_EXT,m=n.a.AUDIO_EXT_NORMAL,g=n.a.AUDIO_EXT_PAID,w=function(){var t="undefined"!=typeof navigator?navigator.userAgent:"";return/android/i.test(t)};function O(){return w()?"*/*":(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?f.join(","):l.join(","):u.join(",")}function _(){return w()?"image/*":(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?y.join(","):p.join(","):s.join(",")}var k={NORMAL:0,DISABLE:1,PREVENT:2};function j(){return!(window.appData||{}).isYuque||Object(o.isPaidCheckAll)()?k.NORMAL:k.PREVENT}function E(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?c:a:i}function P(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?f:l:u}function S(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?y:p:s}function T(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?b:v:d}function A(){return(window.appData||{}).isYuque?Object(o.isPaidCheckAll)()?g:m:h}},899:function(t,e,r){"use strict";t.exports={compareVersion:function(t,e){if(!t||!e)return!1;if(t===e)return!1;for(var r=t.split("."),n=e.split("."),o=0;o<r.length;o++){if(Number(r[o])>Number(n[o]))return!0;if(Number(r[o]<Number(n[o])))return!1;if(r.length<n.length)return!1}return!1}}}}]);