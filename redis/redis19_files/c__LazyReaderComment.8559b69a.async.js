/*! For license information please see c__LazyReaderComment.8559b69a.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[84,78,83,108],{1349:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return u}));var n=r(622),o=r.n(n),i=(r(29),r(125));function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.search;if(t){var r=o.a.parse(t);return r[e]||""}return""}var c=window.self!==window.top;function u(){var e=a("mode"),t=i.a.get("topicsPageMode");return"clean"===e?(i.a.set("topicsPageMode","clean"),"clean"):"normal"===e?(i.a.remove("topicsPageMode"),"normal"):t&&"clean"===t&&c?"clean":"normal"}},1356:function(e,t,r){"use strict";r.r(t);r(466);var n=r(253),o=(r(166),r(31)),i=(r(62),r(21)),a=r(0),c=r.n(a),u=r(2),l=r.n(u),s=r(9),f=r.n(s),p=r(1374),m=r(30),d="index-module_belongs_A3uam",y="index-module_meta_Jn6WP",h="index-module_truncation_g-6vp";function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==v(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===v(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _={};_.Login=function(e){var t=e.goto,r=e.registerWithScene,n=t?"/login?goto=".concat(encodeURIComponent(t)):"/login";return r&&(n="/login?register_with_scene=true"),Object(a.useEffect)((function(){Object(p.b)()}),[]),c.a.createElement(i.a,{href:n,size:e.size,type:"primary","data-aspm-click":"d65962"},__("登录 / 注册"))},_.Login.propTypes={size:l.a.oneOf(["small","large"]),goto:l.a.string},_.Job=function(e){var t=e.user,r=e.truncation;if(t)return c.a.createElement("span",{className:f()(y,w({},h,r))},c.a.createElement(m.b,{name:"user-job",width:16,height:16}),c.a.createElement("span",null,t.job_title||__("未填写")))},_.Job.propTypes={user:l.a.object.isRequired,truncation:l.a.bool},_.Location=function(e){var t=e.user,r=e.truncation,n=e.size,o=void 0===n?16:n;return t=t||{},c.a.createElement("span",{className:f()(y,w({},h,r))},c.a.createElement(m.b,{name:"user-location",width:o,height:o}),c.a.createElement("span",null,t.location||__("未填写")))},_.Location.propTypes={size:l.a.object.number,user:l.a.object.isRequired,truncation:l.a.bool},_.Department=function(e){var t,r=e.user,n=e.truncation;if(r)return c.a.createElement("div",null,null!==(t=r.departments)&&void 0!==t&&t.length?r.departments.map((function(e){return c.a.createElement("span",{className:f()(y,w({},h,n))},c.a.createElement(m.b,{name:"department",width:16,height:16}),c.a.createElement("span",null,e))})):c.a.createElement("span",{className:f()(y,w({},h,n))},c.a.createElement(m.b,{name:"department",width:16,height:16}),c.a.createElement("span",null,r.department||__("未填写"))))},_.Department.propTypes={user:l.a.object.isRequired,truncation:l.a.bool},_.Link=function(e){var t=e.user,r=e.className;return c.a.createElement("a",{href:"/".concat(t.login),title:t.name,className:r},t.name)},_.Link.propTypes={user:l.a.object.isRequired,className:l.a.string},_.Name=function(e){var t=e.user,r=e.className;return c.a.createElement("span",{title:t.name,className:r},t.name)},_.Name.propTypes={user:l.a.object.isRequired,className:l.a.string};var E=function(e){var t=e.belongs,r=e.onChange,i=b(Object(a.useState)(__("管理员")),2),u=i[0],l=i[1];return c.a.createElement(n.a,{trigger:["click"],overlay:c.a.createElement(o.a,{className:"dashboard-dropdown-menu",selectedKeys:[]},t.map((function(e,t){return c.a.createElement(o.a.Item,{key:e.type},c.a.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),function(e){r(e.type),l(e.text)}(e)}},e.text))})))},c.a.createElement("span",null,u,c.a.createElement("span",{className:f()("larkicon","larkicon-arrow-down",d)})))};E.propTypes={belongs:l.a.array.isRequired,onChange:l.a.func.isRequired},_.BelongMenu=E;t.default=_},1374:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return i}));var n=r(125),o="register/source";function i(){var e=new URLSearchParams(window.location.search).get("source");if(e)return e;var t=n.a.get(o);if(t)return t;var r,i=(window.Tracert||{})._refSpm,a=(r=i)&&r.split(".")[1];return a||null}function a(){var e=(window.Tracert||{}).spmBPos;e&&"new_session"!==e&&"register"!==e&&n.a.set(o,e)}function c(){"complete"===document.readyState?setTimeout(a,2e3):window.addEventListener("load",(function(){setTimeout(a,2e3)}))}},2272:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(191),o={doc:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_DOC_CREATION,board:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_BOARD_CREATION,table:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_TABLE_CREATION,sheet:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_SHEET_CREATION,repoHomePage:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_REPO_HOME_PAGE,teamHomePage:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_TEAM_HOME_PAGE,personalHomePage:n.OFFICIAL_TEMPLATE_CHANNEL.TEMPLATE_GUIDE_4_PERSONAL_HOME_PAGE}},2749:function(e,t,r){"use strict";var n,o=r(0),i=r.n(o),a=r(106),c=r.n(a),u=r(231),l=r.n(u),s=r(84),f=r.n(s),p=r(1574),m=r.n(p),d=r(2778),y=r(873),h=r(98),v=r(2775),b=r.n(v),g=r(2776),w=r.n(g),_=r(1395),E=r.n(_),O=r(2777),S=r(433),j=r(95),C=r(125),T=r(33),P=r(2907);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function k(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x(){x=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==R(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function A(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){A(i,n,o,a,c,"next",e)}function c(e){A(i,n,o,a,c,"throw",e)}a(void 0)}))}}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function D(e,t,r){return(t=F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===R(t)?t:String(t)}var U=c()("biz:lakex_mini_editor_base"),G=(null===(n=window.appData)||void 0===n?void 0:n.me)||{},q=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};M(this,e),D(this,"getDefaultSuggestions",(function(){return t.options.getDefaultSuggestions?t.options.getDefaultSuggestions():[]})),D(this,"setEngine",(function(e){t._engine=e})),D(this,"getEngine",(function(){return t._engine})),D(this,"setValue",(function(e){var r=e;e?e.startsWith("<")?(r={type:"lake",value:e},t._engine.setDocument(r)):"string"==typeof e&&(r={type:"json",value:JSON.parse(e)},t._engine.setDocument(r)):t._engine.setDocument()})),D(this,"getValue",(function(){return t._engine?t._engine.getPureContent():t.getDefaultValue()})),D(this,"isEmpty",(function(){return!t._engine||t._engine.isEmpty()})),D(this,"getSafetyValue",N(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.contentReady();case 2:return e.abrupt("return",t.getValue());case 3:case"end":return e.stop()}}),e)})))),D(this,"getHtml",(function(){return t._engine?t._engine.getPureHtml():null})),D(this,"focus",(function(e){if(!t._engine)return null;t._engine.focus(e)})),D(this,"contentReady",N(x().mark((function e(){var r,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._engine){e.next=2;break}return e.abrupt("return",null);case 2:return r=0,n=function e(n,o){t._engine.canGetDocument()?n():r>10?o():(r++,setTimeout((function(){e(n,o)}),1e3))},e.abrupt("return",new Promise(n));case 5:case"end":return e.stop()}}),e)})))),D(this,"saveAll",(function(){if(!t.options.disableCache){var e={format:f.a.FORMAT.LAKE,value:t.getValue(),html:t.getHtml()};t.saveToCache(e)}})),this.options=r,this.from=r.from||"reply",this.targetType=r.targetType,this.belong=r.belong,this.belongType=r.belongType,this.group=r.group,this.target=r.target,this.attachType=r.attachType,this.isEditMode=!!r.target,this.type=this.getType(),this.ctoken=Object(S.a)(window);var n=this.getCacheKey();this.cacheKeys={title:"".concat(n,"/title"),content:"".concat(n,"/content")},this.editorCache=new P.a(this.cacheKeys.content),this.uuid=this.getUuid(),this._engine=null,this.initialDocument=null,this.init()}var t,r,n;return t=e,r=[{key:"init",value:function(){this.initialDocument=this.getInitialDocument(),U("init use: ",this.initialDocument)}},{key:"buildOptions",value:function(e){var t={supportTranslate:w()(),supportImgOCR:E()(),hideEmbedButton:b()(),hideVipIcon:Object(O.a)(),board:{boardWebProxyParams:{webProxy:T.a,userId:null==G?void 0:G.id,spm:h,appData:window.appData}},image:{uploadFileURL:this.getImageUploadUrl(),accept:Object(y.getImageAcceptArr)()},file:{uploadFileURL:this.getFileUploadUrl(),accept:Object(y.getFileAcceptArr)(),localdocAccept:Object(y.getLocalDocAcceptArr)(),embedButtonStatus:Object(y.getIsDiabledPreviewAndEmbed)()},transfer:{transferFilesURL:this.getTransferUrl()},localdoc:{uploadFileURL:this.getFileUploadUrl(),accept:Object(y.getLocalDocAcceptArr)()},mention:{mentionURL:j.a.patchGroupIdToUrl(this.getMentionActionUrl()),defaultList:this.getDefaultSuggestions()},lockedtext:{action:this.getCryptoUrl()},placeholder:(null==e?void 0:e.placeholder)||this.getPlaceholder(),link:{autoCompleteLink:null==e?void 0:e.autoCompleteLink},video:{uploadAction:this.getMediaUploadUrl("video"),queryAction:"/api/video",accept:Object(y.getVideoAcceptArr)()},audio:{uploadFileURL:this.getMediaUploadUrl("audio"),queryURL:"/api/video",accept:Object(y.getAudioAcceptArr)()},vote:{allowVote:!0,queryDetailUrl:"api/votes",queryCheckUrl:"api/votes/mine",voteUrl:"api/votes"},yuque:{disableEmbedView:this.getDisableYuqueCardEmbedView()},materialLibrary:{component:i.a.createElement(d.a,{storage:C.a,webProxy:T.a})},fullscreen:{enable:this.getEnableFullEditor()}},r=[],n=this.getBlockedCards();return n&&n.length>1&&(r=Array.from(new Set([].concat(k(r),k(n))))),t.disabledPlugins=r,t}},{key:"getProps",value:function(){return{format:this.getFormat(),defaultValue:this.getDefaultValue(),autoFocus:this.getAutoFocus(),isMiniSize:this.isMiniSize()}}},{key:"getType",value:function(){return this.options.type||"unknown"}},{key:"getAutoFocus",value:function(){var e=this.options.autoFocus;return null!=e?e:!!this.options.useMiniGuide}},{key:"isMiniSize",value:function(){return!1}},{key:"getEnableFullEditor",value:function(){return!0}},{key:"getBlockedCards",value:function(){return["video","checkIn","vote","audio","premium"]}},{key:"getUuid",value:function(){var e=this.cacheKeys.uuid,t=C.a.get(e);return t||(t=l()(32)+l()(32),C.a.set(e,t)),t}},{key:"getDefaultFormat",value:function(){return f.a.FORMAT.LAKE}},{key:"getFormat",value:function(){var e=this.options.format;return e||this.initialDocument.format}},{key:"getPlaceholder",value:function(){return this.options.placeholder}},{key:"getInitialDocument",value:function(){if(this.initialDocument)return this.initialDocument;var e=this.loadFromCache();if(U("cached document:",e),this.isEditMode){var t=this.getContentObject();return U("adapted content: ",t),e&&(U("merge with cached content",e),t.format=e.format||t.format,t.title=e.title||t.title,t.value=e.value||t.value),t}if(e)return e.format=e.format||this.getDefaultFormat(),e;var r=this.loadFromUrl();return r||{format:this.getDefaultFormat(),title:null,value:null}}},{key:"getContentObject",value:function(e){return{format:(e=e||this.target||{}).format||this.getDefaultFormat(),title:e.title||e.name||"",value:e.value||e.body_asl||e.content}}},{key:"getDefaultValue",value:function(){var e=this.options.defaultValue;return e||this.initialDocument.value}},{key:"getFullUrl",value:function(e){return this.isEditMode&&!this.options.useBelongAttach?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}},{key:"getTransferUrl",value:function(){var e="/api/upload/copy?type=attachment",t=this.getFullUrl(e);return t||(t="".concat(e,"&attachable_uuid=").concat(this.uuid,"&from=").concat(this.from)),t}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.getFullUrl(e)}},{key:"getMediaUploadUrl",value:function(e){var t="/api/video?ctoken=".concat(this.ctoken,"&format=").concat(e);return this.getFullUrl(t)}},{key:"getImageUploadUrl",value:function(){var e=this.getFileUploadUrl();return e?e.replace("&type=attachment","&type=image"):null}},{key:"getMentionActionUrl",value:function(){var e="";return this.isEditMode&&!this.options.useBelongAttach?e="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.target.id):this.belong&&(e="/api/users/complete?target_type=".concat(this.attachType,"&target_id=").concat(this.belong.id)),e}},{key:"getCryptoUrl",value:function(){return"/api/services/crypto"}},{key:"getDisableYuqueCardEmbedView",value:function(){return this.options.disableYuqueCardEmbedView}},{key:"saveToCache",value:function(e){U("save to cache:",e),e.format&&(e.title&&C.a.set(this.cacheKeys.title,e.title),this.needCacheContent(e)?this.editorCache.put(e.value,e.format):U("value is empty or the same as origin, ignore cache"))}},{key:"needCacheContent",value:function(e){if(!e.value)return!1;if(m.a.isBlank(e))return this.editorCache.clear(),!1;if(!this.target)return!0;var t=this.getContentObject();return!m.a.isContentSame(e.format,t.value,e.value)}},{key:"reset",value:function(){U("reset editor"),this.clearCache(),this._engine&&this._engine.setDocument()}},{key:"isContentChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e){var t=this.loadFromCache();t&&(e=t.value)}if(!this.target)return!0;var r="<cursor />",n=this.target.body_asl;return n.trim().replace(r,"")!==e.trim().replace(r,"")}},{key:"clearCache",value:function(){var e=this;U("clear cache"),Object.keys(this.cacheKeys).forEach((function(t){C.a.remove(e.cacheKeys[t])}))}},{key:"getCacheKey",value:function(){return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/new"):"autosave/".concat(this.type)}},{key:"loadFromUrl",value:function(){}},{key:"loadFromCache",value:function(){var e=!1,t={format:null,title:null,value:null},r=this.editorCache.retrieve();if(r&&(e=!0,t.format=r.format,t.value=r.value),this.cacheKeys.title){var n=C.a.get(this.cacheKeys.title);n&&(e=!0,t.title=n)}return e?t:null}}],n=[{key:"getEmptyDocument",value:function(){return{format:f.a.FORMAT.LAKE,value:null}}}],r&&I(t.prototype,r),n&&I(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=q},2759:function(e,t,r){"use strict";var n=r(25);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=n.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),n)}var i,a}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=u(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},c.apply(this,arguments)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(f,e);var t,r,o,u=s(f);function f(){return i(this,f),u.apply(this,arguments)}return t=f,(r=[{key:"buildOptions",value:function(e){var t=c(p(f.prototype),"buildOptions",this).call(this,e);return t.disabledPlugins.push("mobile"),n.ua.mobile&&t.disabledPlugins.push("placeholder","slash"),t}},{key:"getBlockedCards",value:function(){return["video","audio","premium","checkIn"]}}])&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),f}(r(2749).a);t.a=m},2773:function(e,t,r){"use strict";var n=r(176),o=r.n(n),i=r(51);function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u={adaptAbilities:function(e){var t=e.me,r=e.comment,n=e.target_type,o=e.target,i={edit:!1,delete:!1};return t&&t.id===r.user_id?(i.edit=!0,i.delete=!0):"Doc"===n&&(i.delete=o.abilities&&o.abilities.destroy_comment),i},getPostActions:function(e,t){var r=[];return r.push({cmd:"copy_link",title:__("复制链接")}),r.push({cmd:"reply",title:__("评论")}),e.edit&&r.push({cmd:"edit",title:__("编辑")}),e.delete&&r.push({cmd:"delete",title:__("删除"),confirm:!0}),t&&r.push({cmd:"content_report",title:__("举报")}),r},includesHashAnchoredComment:function(e,t){if(!t||!t.startsWith("#comment-"))return!1;var r=parseInt(t.substring("#comment-".length),10);return!!e.find((function(e){return e.id===r}))},getParticipants:function(e,t,r){var n=r.groupMembers,c=r.targetType,u=[];return"Topic"===c?u.push(e.user):"Doc"!==c&&"Resource"!==c||(e.contributors=e.contributors||[],u=a(e.contributors)),t&&t.length>0&&t.forEach((function(e){var t=u.find((function(t){return t&&e.user&&t.id===e.user.id}));e.user&&!t&&u.push(e.user)})),n&&n.length>0&&n.forEach((function(e){u.push(e.user)})),u=o()(u,"login"),window.appData.isYuque&&(u=u&&u.filter((function(e){return e.status!==i.STATUS.terminated}))),u},getAnchorId:function(e,t){return"".concat("Topic"===t?"reply-":"comment-").concat(e)},TARGET_TYPES:["Doc","DocVersion","Resource","Topic","Artboard","Note"]};t.a=u},2803:function(e,t,r){"use strict";var n=r(33),o={epv:function(e){var t=e.type,r=e.id;n.a.logs.activity({type:t,action:"epv",id:r})}};t.a=o},2812:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(0),o=r.n(n),i=r(435),a=r(164);function c(e){var t=window.appData||{},r=t.isYuque,n=t.organization,c=t.group,u=void 0===c?{}:c,l=t.me,s=void 0===l?{}:l,f=null==n?void 0:n.id;if(!r||Object(a.isPaid)())throw new Error("should not be show this");var p=!(i.a.isAlipayApp()||i.a.isAndroid()||i.a.isIOS()||i.a.isDingtalk()||i.a.getMobileAppVersion());if(f){var m,d=null==n||null===(m=n.abilities)||void 0===m?void 0:m.destroy;if(d&&p){var y="/r/organizations/dashboard/cashier?action=renew";return void e(o.a.createElement("span",{},[__("升级为付费版空间后可嵌入文件"),o.a.createElement("a",{style:{marginLeft:5},rel:"noreferrer",href:y,target:"_blank",onClick:function(e){window.openExternalLink&&(window.openExternalLink(y,!0),e.preventDefault())}},[__("立即升级")])]))}return e(d?__("升级为付费版空间后可嵌入文件"):__("联系管理员升级为付费版空间后可嵌入文件"))}if(window.appData.group&&u.id!==s.id)return e(__("联系知识库所有者开通会员后可嵌入文件"));if(p){var h="pay_source=file_embed";window.openExternalLink&&(h+="&pay_referer=desktop_app");var v="/settings/member?".concat(h,"#renew");return e(o.a.createElement("span",{},[__("开通会员后可嵌入文件"),o.a.createElement("a",{style:{marginLeft:5},rel:"noreferrer",href:v,target:"_blank",onClick:function(e){window.openExternalLink&&(window.openExternalLink(v,!0),e.preventDefault())}},[__("开通会员")])]))}return e(__("开通会员后可嵌入文件"))}},2817:function(e,t,r){"use strict";r.d(t,"c",(function(){return y})),r.d(t,"a",(function(){return S})),r.d(t,"l",(function(){return M})),r.d(t,"j",(function(){return ie})),r.d(t,"h",(function(){return de})),r.d(t,"i",(function(){return Oe})),r.d(t,"k",(function(){return xe})),r.d(t,"f",(function(){return Ue})),r.d(t,"d",(function(){return He})),r.d(t,"e",(function(){return Xe})),r.d(t,"g",(function(){return ut})),r.d(t,"b",(function(){return vt}));var n=r(84),o=r.n(n),i=r(1343),a=r(2749);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===c(i)?i:String(i)),n)}var o,i}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var o=m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(c,e);var t,r,n,a=f(c);function c(){return u(this,c),a.apply(this,arguments)}return t=c,n=[{key:"getEmptyDocument",value:function(){return{format:o.a.FORMAT.LAKE,value:null}}}],(r=[{key:"getType",value:function(){var e=this.options.targetType;return e?"".concat(e,"_comment").toLowerCase():"comment"}},{key:"getCacheKey",value:function(){var e=this.options.replyId;return this.isEditMode&&this.target&&this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(this.target.id,"/edit"):this.belong?"autosave/".concat(this.type,"/").concat(this.belong.id,"/").concat(e,"/new"):"autosave/".concat(this.type)}},{key:"isMiniSize",value:function(){return this.options.useMiniGuide||this.options.isMiniSize||window.h5}},{key:"getDefaultFormat",value:function(){return i.a.getDefaultDocumentFormat(o.a.TYPE.TOPIC)}},{key:"getEnableFullEditor",value:function(){return"Artboard"!==this.targetType}}])&&l(t.prototype,r),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(a.a),y=d;function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===h(i)?i:String(i)),n)}var o,i}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _(this,r)}}function _(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(i,e);var t,r,n,o=w(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return v(this,i),e.attachType="Resource",e.useBelongAttach=!0,e.from="reply",o.call(this,e)}return t=i,(r=[{key:"getType",value:function(){return"area_comment"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&b(t.prototype,r),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(y),S=O;function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==j(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===j(i)?i:String(i)),n)}var o,i}function P(){return P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=R(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},P.apply(this,arguments)}function R(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=A(e);if(t){var o=A(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return x(this,r)}}function x(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(i,e);var t,r,n,o=L(i);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return C(this,i),e.attachType="Doc",e.useBelongAttach=!0,e.from="reply",o.call(this,e)}return t=i,(r=[{key:"buildOptions",value:function(e){var t,r=P(A(i.prototype),"buildOptions",this).call(this,e);return r.image.showMiniToolbarWhen="never",null===(t=r.disabledPlugins)||void 0===t||t.push("slash"),r}},{key:"getType",value:function(){return"word_comment"}},{key:"getAutoFocus",value:function(){return!1}},{key:"isMiniSize",value:function(){return!0}},{key:"getEnableFullEditor",value:function(){return!1}}])&&T(t.prototype,r),n&&T(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(y),M=N,I=r(1349),D=r(125),F=r(2759);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==U(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===U(i)?i:String(i)),n)}var o,i}function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},q(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Y(e);if(t){var o=Y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return V(this,r)}}function V(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}F.a;var z=r(29),H=r.n(z);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e,t,r){return(t=Q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q(n.key),n)}}function Q(e){var t=function(e,t){if("object"!==W(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===W(t)?t:String(t)}function X(e,t){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},X(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=re(e);if(t){var o=re(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return te(this,r)}}function te(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}var ne={daily:{title:"#prefix# #day# 日报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>建议 TL 每天组织日会，将一天的重点事项安排于此</p><p>每位同学下班前，在此提交日报</p><p><br /></p><p>日报不要记流水账，尽量在 200 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的日报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},weekly:{title:"#prefix# #day# 周报汇总",content:'<!doctype lake><meta name="doc-version" content="1" /><p>将一周的工作总结回复于此</p><p><br /></p><p>不要记流水账，尽量在 800 字以内</p><p>重点项目或工作要及时总结和提报，尤其风险点要及时提报</p><p>可以写写思考和感想</p><p><br /></p><p>写完自己的周报，也看看大家的</p><p>每一位同学的努力，都值得认真阅读与交流</p><p><br /></p><p><span style="color: #FA541C;"><span>注意不要提及保密项目和敏感数据</span></span></p>'},vote:{title:"一起来投票吧",content:'<!doctype lake><meta name="doc-version" content="1" /><card type="block" name="vote" value="data:%7B%22margin%22%3Atrue%2C%22id%22%3A%22jTHWG%22%2C%22type%22%3A%22single%22%7D"></card><p><br /><cursor /></p>'},default:{title:"",content:"<!doctype lake><p></p>"}},oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(i,e);var t,r,n,o=ee(i);function i(){return J(this,i),o.apply(this,arguments)}return t=i,n=[{key:"getTemplate",value:function(e,t){var r=ne[e];if(!r)return{title:null,content:null};var n=H()(new Date).format("YYYY-MM-DD"),o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){$(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r);return o.title=o.title.replace("#prefix#",t),o.title=o.title.replace("#day#",n),o}}],(r=[{key:"getType",value:function(){return"thread"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.belongType||"Book","&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):this.group?"".concat(e,"&attachable_type=User&attachable_id=").concat(this.group.id,"&from=").concat(this.from):null}},{key:"getFileCopyUrl",value:function(){var e="/api/upload/copy?type=attachment";return this.isEditMode?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):"".concat(e,"&attachable_uuid=").concat(this.uuid,"&from=").concat(this.from)}}])&&Z(t.prototype,r),n&&Z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(F.a),ie=oe;function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==ae(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ae(i)?i:String(i)),n)}var o,i}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=pe(e);if(t){var o=pe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return fe(this,r)}}function fe(e,t){if(t&&("object"===ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}var me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(i,e);var t,r,n,o=se(i);function i(){return ce(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"getType",value:function(){return"thread_board"}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"getFileUploadUrl",value:function(){var e="/api/upload/attach?ctoken=".concat(this.ctoken,"&type=attachment");return this.isEditMode&&!this.options.useBelongAttach?"".concat(e,"&attachable_type=").concat(this.attachType,"&attachable_id=").concat(this.target.id,"&from=").concat(this.from):this.belong?"".concat(e,"&attachable_type=").concat(this.belongType,"&attachable_id=").concat(this.belong.id,"&from=").concat(this.from):null}}])&&ue(t.prototype,r),n&&ue(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a),de=me;function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==ye(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===ye(i)?i:String(i)),n)}var o,i}function be(e,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},be(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_e(e);if(t){var o=_e(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return we(this,r)}}function we(e,t){if(t&&("object"===ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _e(e){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(i,e);var t,r,n,o=ge(i);function i(){return he(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"getType",value:function(){return"thread_comment"}}])&&ve(t.prototype,r),n&&ve(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(y),Oe=Ee;function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==Se(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Se(i)?i:String(i)),n)}var o,i}function Ce(){return Ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=Te(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},Ce.apply(this,arguments)}function Te(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Le(e)););return e}function Pe(e,t){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pe(e,t)}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Le(e);if(t){var o=Le(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ke(this,r)}}function ke(e,t){if(t&&("object"===Se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pe(e,t)}(i,e);var t,r,n,o=Re(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="User",e.useBelongAttach=!0,o.call(this,e)}return t=i,(r=[{key:"buildOptions",value:function(e){var t=Ce(Le(i.prototype),"buildOptions",this).call(this,e);return t.typography={mustTypography:"classic",typography:"classic",paragraphSpacing:"relax"},t}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&je(t.prototype,r),n&&je(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==Ae(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Ae(i)?i:String(i)),n)}var o,i}function Me(e,t){return Me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Me(e,t)}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Fe(e);if(t){var o=Fe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return De(this,r)}}function De(e,t){if(t&&("object"===Ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fe(e)}var Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Me(e,t)}(i,e);var t,r,n,o=Ie(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.from="group_custom",e.attachType="User",e.useBelongAttach=!0,o.call(this,e)}return t=i,(r=[{key:"getType",value:function(){return"group_custom"}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete?target_type=Group&target_id=".concat(this.group.id)}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&Ne(t.prototype,r),n&&Ne(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==Ge(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Ge(i)?i:String(i)),n)}var o,i}function Be(e,t){return Be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Be(e,t)}function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ze(e);if(t){var o=ze(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ye(this,r)}}function Ye(e,t){if(t&&("object"===Ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ze(e)}var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Be(e,t)}(i,e);var t,r,n,o=Ve(i);function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var t=e.feedback;return e.attachType="User",e.useBelongAttach=!0,e.from="feedback",e.placeholder={tip:t&&t.abilities.manage?"你将要代表语雀回复用户，请使用官方口吻，慎重填写":"",emptyParagraphTip:""},o.call(this,e)}return t=i,(r=[{key:"getType",value:function(){return"feedback_comment"}},{key:"getCacheKey",value:function(){var e=this.getType();if(this.target)return"autosave/".concat(e,"/").concat(this.target.id,"/edit");var t=this.options.feedback;return t?"autosave/".concat(e,"/").concat(t.id,"/new"):"autosave/".concat(e)}},{key:"getContentObject",value:function(){var e=this.target.content||{source:"",format:"lake"};return{format:e.format,value:e.source||""}}},{key:"isMiniSize",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}}])&&qe(t.prototype,r),n&&qe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(F.a);function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==We(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===We(i)?i:String(i)),n)}var o,i}function $e(e,t){return $e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$e(e,t)}function Je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Qe(e);if(t){var o=Qe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ze(this,r)}}function Ze(e,t){if(t&&("object"===We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qe(e){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qe(e)}var Xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$e(e,t)}(i,e);var t,r,n,o=Je(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="User",e.useBelongAttach=!0,e.placeholder={tip:"",emptyParagraphTip:""},e.from="feedback",o.call(this,e)}return t=i,(r=[{key:"getType",value:function(){return"feedback_remark"}},{key:"getContentObject",value:function(){return{format:"lake",value:this.target.remark||""}}},{key:"getCacheKey",value:function(){return this.target?"autosave/".concat(this.type,"/").concat(this.target.id):"autosave/".concat(this.type)}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"getAutoFocus",value:function(){return!0}},{key:"isMiniSize",value:function(){return!0}}])&&Ke(t.prototype,r),n&&Ke(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(F.a);function et(e){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et(e)}function tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==et(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===et(i)?i:String(i)),n)}var o,i}function rt(){return rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=nt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},rt.apply(this,arguments)}function nt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ct(e)););return e}function ot(e,t){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ot(e,t)}function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ct(e);if(t){var o=ct(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return at(this,r)}}function at(e,t){if(t&&("object"===et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ct(e){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ct(e)}var ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ot(e,t)}(i,e);var t,r,n,o=it(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.target&&(e.attachType="Doclet"),o.call(this,e)}return t=i,(r=[{key:"getCards",value:function(){return this.options.target?rt(ct(i.prototype),"getCards",this).call(this):["label"]}},{key:"getFullCards",value:function(){return this.options.target?rt(ct(i.prototype),"getFullCards",this).call(this):["label"]}},{key:"getAutoFocus",value:function(){return!0}},{key:"getMentionActionUrl",value:function(){return"/api/users/complete"}},{key:"isMiniSize",value:function(){return!1}}])&&tt(t.prototype,r),n&&tt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==lt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===lt(i)?i:String(i)),n)}var o,i}function ft(){return ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=pt(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ft.apply(this,arguments)}function pt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ht(e)););return e}function mt(e,t){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mt(e,t)}function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ht(e);if(t){var o=ht(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return yt(this,r)}}function yt(e,t){if(t&&("object"===lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}var vt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mt(e,t)}(i,e);var t,r,n,o=dt(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e.attachType="Doclet",o.call(this,e)}return t=i,(r=[{key:"buildOptions",value:function(e){var t=ft(ht(i.prototype),"buildOptions",this).call(this,e);return t.typography={typography:"classic",paragraphSpacing:"relax"},t}},{key:"isMiniSize",value:function(){return this.options.small}},{key:"getAutoFocus",value:function(){return!0}}])&&st(t.prototype,r),n&&st(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(a.a)},2831:function(e,t,r){"use strict";r.r(t);r(63);var n=r(23),o=r(0),i=r.n(o),a=r(2),c=r.n(a),u=r(2803),l=r(1417),s=r(2812),f=r(2922),p=r(771),m=r(345),d=r(98),y=r(1346),h=(r(251),r(116)),v=r(106),b=r.n(v),g=r(324),w=r.n(g),_=r(84),E=r.n(_),O=r(778),S=r(33);function j(e){return[E.a.FORMAT.MARKDOWN,E.a.FORMAT.ASL].includes(e)}var C="EditorBase-module_init_eZbjJ",T="EditorBase-module_editor_zrggr";function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function R(){R=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==P(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function k(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var A=b()("editor:lakex_mini");function N(e){var t=e.editor,r=e.onChange,n=e.onSubmit,a=e.onLoad,c=t.getProps(),u=c.format,l=c.autoFocus,s=c.isMiniSize,f=c.defaultValue,p=L(Object(o.useState)(j(u)),2),m=p[0],d=p[1],y=L(Object(o.useState)(f),2),v=y[0],b=y[1],g=L(Object(o.useState)(!1),2),_=g[0],P=g[1],x=Object(o.useMemo)((function(){return i.a.createRef()}),[m]),N=i.a.createRef();Object(o.useEffect)((function(){if(j(u)){if(A("convert: ".concat(u," -> lake")),!f)return d(!1),void b("");S.a.docs.convertContent({from:u,to:E.a.FORMAT.LAKE,content:f}).then((function(e){A("convert done:",e),d(!1),b(e.content),P(!0)})).catch((function(e){A("convert fail:",e.message),d(!1)}))}}),[]),Object(o.useEffect)((function(){var e="⌘+enter, ctrl+enter";return w()(e,(function(e){N.current&&N.current.isFocus&&n&&n(e)})),function(){w.a.unbind(e)}}),[]);var M=function(){var n,o=(n=R().mark((function n(){var o,i,c;return R().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(x.current){n.next=2;break}return n.abrupt("return");case 2:if(x.current){n.next=4;break}return n.abrupt("return");case 4:o=s?O.createMicroEditor:O.createMinorEditor,i=t.buildOptions(e),c=o(x.current,i),window.__miniEngine=c,N.current=c,t.setEngine(c),t.setValue(v),c.on("fullscreenStatusChange",(function(e){var t=new CustomEvent("neEditorFullscreenStatusChange",{detail:{isFullscreen:e,engine:c,editorNode:c.editorNode}});window.dispatchEvent(t)})),c.on("change",(function(){r&&r(),t.saveAll()})),a&&a(c),l&&c.focus(!1);case 15:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){k(i,r,o,a,c,"next",e)}function c(e){k(i,r,o,a,c,"throw",e)}a(void 0)}))});return function(){return o.apply(this,arguments)}}();Object(o.useEffect)((function(){M()}),[m,_]);return m?i.a.createElement("div",{id:"larkx-mini-editor",className:C},i.a.createElement(h.a,null)):u===E.a.FORMAT.LAKE||_?i.a.createElement("div",{id:"lark-mini-editor",className:T,ref:x}):i.a.createElement("div",{id:"lark-mini-editor",className:C},i.a.createElement("h4",null,__("内容格式异常，暂无法编辑")),i.a.createElement("pre",null,e.defaultValue))}N.propTypes={editor:c.a.object,onChange:c.a.func,onLoad:c.a.func,onSubmit:c.a.func};var M=N,I="index-module_lakeCreateGuide_VutDm";function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function F(){F=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==D(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function U(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function G(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){U(i,n,o,a,c,"next",e)}function c(e){U(i,n,o,a,c,"throw",e)}a(void 0)}))}}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var V=!1;function Y(e){var t=Object(o.useRef)(),r=q(Object(o.useState)(!1),2),a=r[0],c=r[1],h=Object(o.useRef)(!1),v=function(){var e=t.current.isEmpty();h.current!==e&&(c(e),h.current=e)},b=Object(o.useCallback)(function(){var e=G(F().mark((function e(t){var r;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.l)(t.id);case 2:if((r=e.sent).format!==m.FORMAT.LAKETABLE&&!/<card.*name=\"dataTable\"/.test(r.doclet.body_asl)){e.next=5;break}return e.abrupt("return",{content:""});case 5:return Object(d.spmClick)(y.a.TEMPLATE_USAGE,{id:r.id,type:r.type,format:r.format,name:r.name,platform:"pc"}),e.abrupt("return",{content:r.format===m.TYPE_FORMAT_MAP.Doc?r.doclet.body_asl:r.doclet.body});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),g=Object(o.useCallback)(function(){var r=G(F().mark((function r(n){var o;return F().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,b(n);case 2:if(null!=(o=r.sent)&&o.content){r.next=5;break}return r.abrupt("return");case 5:t.current.setDocument("lake",o.content),c(!1),h.current=!1,e.onChange();case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[b,e.onChange]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{autoFocus:!0,editor:e.editor,autoCompleteLinks:e.autoCompleteLinks,onChange:function(){e.onChange(),v(),V||(V=!0,u.a.epv({type:"MiniEditor"}))},onLoad:function(r){t.current=r,e.onLoad(r),v(),r.on("unSupportFileUpload",(function(e){var t;n.a.warning(Object(l.a)(null==e||null===(t=e.extName)||void 0===t?void 0:t.toLowerCase()))})),r.on("clickEmbedButton",(function(){Object(s.a)(n.a.warning.bind(n.a))}))},onSubmit:e.onSubmit,isMiniSize:e.isMiniSize,placeholder:e.placeholder}),e.needCreateGuide&&a?i.a.createElement("div",{className:I},i.a.createElement(f.default,{doc:e.tplDoc,showRecent:!1,needMore:!1,isFullWidth:!0,visible:!0,includePersonal:!1,onUseTemplate:g})):null)}Y.defaultProps={onLoad:function(){},onChange:function(){}},Y.propTypes={editor:c.a.object.isRequired,tplDoc:c.a.object,onChange:c.a.func,onSubmit:c.a.func,onLoad:c.a.func,autoCompleteLinks:c.a.bool,isMiniSize:c.a.bool,placeholder:c.a.object,needCreateGuide:c.a.bool};t.default=Y},2907:function(e,t,r){"use strict";var n=r(106),o=r.n(n),i=r(125),a=r(1574),c=r.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===u(i)?i:String(i)),n)}var o,i}var s=o()("editor:cache"),f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t}var t,r,n;return t=e,(r=[{key:"retrieve",value:function(){var e={format:null,value:null};s("[retrieve]key: ",this.key);var t=i.a.get(this.key);if(!t)return null;s("[retrieve]find text: ",t);var r=c.a.guessFormat(t);return e.format=r,e.value=t,s("[retrieve]doc: ",e),e}},{key:"put",value:function(e,t){s("[put]content cached: ","".concat(this.key," -> ").concat(e)),i.a.set(this.key,e)}},{key:"clear",value:function(){i.a.remove(this.key)}}])&&l(t.prototype,r),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.a=f},2913:function(e,t,r){"use strict";var n,o=[{id:1,title:__("加油")},{id:2,title:__("开心")},{id:3,title:__("很忙")},{id:4,title:__("想哭")},{id:5,title:__("生气")}],i=(n={},o.forEach((function(e){n[e.id]=e})),n),a=[{id:"thumbs_up",title:__("支持"),icon:"https://gw.alipayobjects.com/zos/basement_prod/40dd7f62-e6ad-48c6-b2c1-aeed729ff753.svg"},{id:"thumbs_down",title:__("反对"),icon:"https://gw.alipayobjects.com/zos/basement_prod/49753f89-a52b-47f8-8dff-ca2b7d5ab29e.svg"},{id:"applause",title:__("喝彩"),icon:"https://gw.alipayobjects.com/zos/basement_prod/39b96288-777c-4ad9-8065-fe27ee2366d5.svg"},{id:"momo",title:__("摸摸"),icon:"https://gw.alipayobjects.com/zos/basement_prod/486defba-93e3-4151-8b23-6fb09dfb7f97.svg"},{id:"+1",title:__("+1"),icon:"https://gw.alipayobjects.com/zos/bmw-prod/cd3682d7-3cc9-44a1-87d3-1feb83baee73.svg"},{id:"OK",title:"OK",icon:"https://gw.alipayobjects.com/zos/bmw-prod/70ec25dc-2ad6-42f3-b802-76ba015becde.svg"}],c=function(){var e={};return a.forEach((function(t){e[t.id]=t})),e}(),u={REACTIONS:a,getMoodTitleById:function(e){return(i[e]||{}).title||""},getPostUrl:function(e){var t=window.location.hash||"",r=window.location.href;return r=r.substring(0,r.length-t.length),"".concat(r,"#comment-").concat(e)},classifyReactions:function(e){var t=Object.keys(c),r={};return t.forEach((function(e){r[e]={count:0,user_ids:[]}})),e.forEach((function(e){e.action_option.split(",").forEach((function(t){r[t]&&(r[t].count++,r[t].user_ids.push(e.user_id))}))})),r},getReactionById:function(e){return c[e]}};t.a=u},2915:function(e,t,r){var n=r(1464)("toLowerCase");e.exports=n},2921:function(e,t,r){"use strict";r.r(t);r(280);var n=r(102),o=(r(92),r(45)),i=(r(103),r(60)),a=r(0),c=r.n(a),u=r(2),l=r.n(u),s=r(569),f=r.n(s),p=r(9),m=r.n(p),d=r(93),y=r(111),h=r(51),v=r(30),b={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=function(e){var t=e.icon,r=e.content,n=e.style,o=e.showClose,i=g(Object(a.useState)(!0),2),u=i[0],l=i[1];return u?c.a.createElement("div",{className:b.wrap,style:n},t&&c.a.createElement("div",{className:b.icon},t),c.a.createElement("div",{className:b.content},r),o&&c.a.createElement("div",{className:b.close,onClick:function(){l(!1)}},c.a.createElement("span",{className:m()("lake-icon","lake-icon-close",b.closeIcon)}))):null};_.propTypes={icon:l.a.node,content:l.a.node.isRequired,style:l.a.object,showClose:l.a.bool};var E=_,O=r(147),S="ReaderAudit-module_closeBtn_hHU+3",j="ReaderAudit-module_detail_mWCgN",C="ReaderAudit-module_toggleDetail_pq7CA",T="ReaderAudit-module_moreLink_oxcCo",P="ReaderAudit-module_tagModeWrapper_xupeI",R="ReaderAudit-module_tagText_Womh9",k="ReaderAudit-module_pending_m3C28",L="ReaderAudit-module_illegal_B8aJ7",x="ReaderAudit-module_banned_sHuxy",A="ReaderAudit-module_isIntranet_WPBjb",N="ReaderAudit-module_tagClose_YIxR7";function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){F(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==M(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===M(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q(e){var t,r=U(Object(a.useState)(!1),2),u=r[0],l=r[1],s=U(Object(a.useState)(!0),2),p=s[0],b=s[1],g=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,w=e.doc,_=e.type,O=e.tagMode,M=w.audits,I=w.read_status,G=w.id,q=w.content_updated_at,B=w.abilities,V=void 0===B?{}:B,Y=window.appData,z=Y.book,H=Y.group,W=Y.me,K=e.isYuque||window.appData.isYuque;var $="audit_ignored_".concat(_,"_").concat(G);function J(e){null==e||e.preventDefault(),localStorage.setItem($,Date.now()),b(!1)}function Z(e){var t=e.filter((function(e){return null!==e}));return f()(t)}if(Object(a.useEffect)((function(){if(I===d.READ_STATUS.insecure)if(W.isAdmin||V.update){if(!g){var e=localStorage.getItem($);if(e&&q){var t=new Date(q).getTime();b(t>e)}}}else b(!1)}),[]),I<=d.READ_STATUS.ok&&(null==z?void 0:z.status)!==y.STATUS.banned&&(null==H?void 0:H.status)!==h.STATUS.blocked)return null;if(I<=d.READ_STATUS.ok&&((null==z?void 0:z.status)===y.STATUS.banned||(null==H?void 0:H.status)===h.STATUS.blocked))return null!=W&&W.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==H?void 0:H.status)===h.STATUS.blocked,", bookBlocked: ").concat((null==z?void 0:z.status)===y.STATUS.banned)),null;if(null!=H&&H.isPermanentPunished)return null!=W&&W.isAdmin&&I>d.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===_&&I<=d.READ_STATUS.ok)return null;if(!p)return null;var Q=[];M&&(M.forbidden||M.reason)&&(Q=M.forbidden||[M.reason]);var X,ee={};if(ee[d.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),ee[d.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),ee[d.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[d.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),ee[d.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[d.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),ee[d.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),K)X=ee[I]||ee[d.READ_STATUS.suspect];else{var te=!O&&Q.length>0?c.a.createElement("a",{onClick:function(e){e.preventDefault(),l(!u)},className:C},u?"收起详情":"展开详情"):null,re=c.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:T},__("了解更多"));X=g||I!==d.READ_STATUS.insecure?c.a.createElement(c.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),re,te," "):c.a.createElement(c.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),re,te)}var ne=K?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(O){if(K){var oe,ie,ae,ce,ue=(F(oe={},d.READ_STATUS.pending,__("审核中")),F(oe,d.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),F(oe,d.READ_STATUS.banned,__("该内容已屏蔽#tag")),oe);switch(I){case d.READ_STATUS.pending:case d.READ_STATUS.suspect:ce=d.READ_STATUS.pending;break;case d.READ_STATUS.illegal:case d.READ_STATUS.illegal_polity:case d.READ_STATUS.illegal_ak:case d.READ_STATUS.illegal_privacy:ce=d.READ_STATUS.illegal;break;case d.READ_STATUS.banned:ce=d.READ_STATUS.banned;break;default:ce=null}return(ae=ue[ce])?c.a.createElement(i.a,{title:c.a.createElement("span",{className:R},X),placement:"bottom"},c.a.createElement("div",{className:m()(P,(ie={},F(ie,k,ce===d.READ_STATUS.pending),F(ie,L,ce===d.READ_STATUS.illegal),F(ie,x,ce===d.READ_STATUS.banned),ie))},c.a.createElement("span",{className:R},ae))):null}return c.a.createElement("div",{className:m()(P,A),onClick:function(){o.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:c.a.createElement(c.a.Fragment,null,X,Q.length>0&&c.a.createElement("ul",{className:j},Z(Q).map((function(e){return c.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){J()}})}},c.a.createElement("span",{className:R},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),c.a.createElement("div",{className:N,onClick:function(e){e.stopPropagation(),J()}},c.a.createElement(v.b,{name:"close",width:10,height:10})))}return c.a.createElement(E,{style:D({marginBottom:"Doc"===_?24:0,marginTop:4},ne),icon:c.a.createElement(v.b,{name:"doc-has-content-risk",height:17,width:15}),content:c.a.createElement(c.a.Fragment,null,!K&&c.a.createElement(n.a,{title:__("确认忽略该提醒？"),onConfirm:J,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},c.a.createElement("span",{className:S},c.a.createElement(v.b,{name:"close",width:14}))),c.a.createElement("span",{"data-testid":"audit-tip"},X),u&&c.a.createElement("ul",{className:j},Z(Q).map((function(e){return c.a.createElement("li",{key:e},e)}))))})}q.defaultProps={isYuque:window.appData.isYuque},q.propTypes={doc:l.a.object.isRequired,type:l.a.string,isYuque:l.a.bool,tagMode:l.a.bool};t.default=Object(O.b)(q)},2922:function(e,t,r){"use strict";r.r(t),r.d(t,"DocCreationGuide",(function(){return L})),r.d(t,"default",(function(){return x}));var n=r(2915),o=r.n(n),i=r(0),a=r(306),c=r(312),u=r(191),l=r(771),s=r(2923),f=r(2929),p=r(2272),m=r(991);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(){y=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new T(o||[]);return n(a,"_invoke",{value:O(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function h(){}var v={};u(v,i,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(P([])));g&&g!==t&&r.call(g,i)&&(v=g);var w=h.prototype=p.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==d(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function O(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=S(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function S(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return m.prototype=h,n(w,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:m,configurable:!0}),m.displayName=u(h,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},_(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function h(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){h(i,n,o,a,c,"next",e)}function c(e){h(i,n,o,a,c,"throw",e)}a(void 0)}))}}var b=new(r.n(m).a)(5);function g(e,t){return w.apply(this,arguments)}function w(){return w=v(y().mark((function e(t,r){var n,o,i,a=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>2&&void 0!==a[2]?a[2]:5e3,!(o=b.get(t))){e.next=4;break}return e.abrupt("return",Promise.resolve(o));case 4:return e.next=6,r();case 6:return i=e.sent,b.set(t,i,{maxAge:n}),e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}var E=["group","book","onUseTemplate","height","doc","isFullWidth","showRecent","needMore"],O=["visible","className","style"];function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S.apply(this,arguments)}function j(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L=function(e){var t=e.group,r=e.book,n=e.onUseTemplate,m=e.height,d=(e.doc,e.isFullWidth),y=void 0===d||d,h=e.showRecent,v=void 0===h||h,b=e.needMore,w=void 0===b||b,_=j(e,E),O=function(e){var t=e.book,r=e.group,n=e.doc,a=e.showRecent,s=void 0===a||a,f=e.includePersonal,m=void 0===f||f,d=R(i.useState([]),2),y=d[0],h=d[1],v=R(i.useState({data:[],meta:{}}),2),b=v[0],w=v[1],_=(null==n?void 0:n.type)||"Doc";return i.useEffect((function(){var e;if(s){var r=function(){return c.a.editor.recentlyUpdatedDocs({book_id:t.id,type:_})};null!=t&&t.id&&null!=t&&null!==(e=t.abilities)&&void 0!==e&&e.create_doc?g("getRecentDocs-".concat(t.id,"-").concat(_),r,5e3).then((function(e){h(e)})):r().then((function(e){return h(e)}))}}),[t,s]),i.useEffect((function(){var e=p.a[o()(_)];g("getAllTemplates-".concat((null==t?void 0:t.id)||"","-").concat((null==r?void 0:r.id)||"","-").concat((null==t?void 0:t.organization_id)||"","-").concat(_||"","-").concat(e||""),(function(){return Object(l.j)(T(T({},Object(l.m)(t,r,m)),{},{official_channel:e,limit:5,format:u.TYPE_FORMAT_MAP[_]}))}),5e3).then((function(e){w(e)}))}),[t,_]),{recentDocs:y,templateConfig:b}}(e),C=O.recentDocs,P=O.templateConfig,k=R(i.useState(0),2),L=k[0],x=k[1],A=y?{}:{maxWidth:"890px",marginLeft:"auto",marginRight:"auto",paddingLeft:"70px",paddingRight:"70px"};return i.createElement("div",S({},_,{style:A}),i.createElement(a.a,{onResize:function(e){e.height&&x(e.height)}},i.createElement(s.c,{templateConfig:P,book:r,group:t,needMore:w,onUseTemplate:n})),v&&i.createElement(f.b,{height:m-L,recentDocs:C,book:r,group:t,onUseTemplate:n}))};function x(e){var t=e.visible,r=e.className,n=e.style,o=j(e,O);return t?i.createElement(L,S({},o,{className:r,style:n})):null}},2949:function(e,t,r){},2960:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return s}));var n=r(0),o=r.n(n),i=r(2),a=r(95),c="index-module_bookTips_cZ25F",u="index-module_groupTips_znta0",l="index-module_commentTips_eS4uK";function s(e){var t=e.targetType,r=o.a.createElement("a",{href:"https://www.yuque.com/yuque/cdgcvd/zsw0w0",className:"wording-comment-link",target:"_blank",style:{marginLeft:"8px"}},__("了解更多"));switch(t){case"Book":return o.a.createElement("span",{className:c,"data-testid":"forbid-tip"},__("注册 7 天后可设置为互联网可见 {learnMoreLink}",{learnMoreLink:r}));case"Group":return o.a.createElement("div",{className:u,"data-testid":"forbid-tip"},__("注册 7 天后，即可创建知识小组 {learnMoreLink}",{learnMoreLink:r}));default:return o.a.createElement("span",{className:l,"data-testid":"forbid-tip"},__("注册 7 天后即可参与{action} {learnMoreLink}",{action:"Topic"===t?__("讨论"):__("评论"),learnMoreLink:r}))}}function f(e,t){var r,n=window.appData,o=n.settings,i=void 0===o?{}:o,c=n.organization,u=n.isPublicCloud,l=t||{},s=l.me,f=void 0===s?window.appData.me||{}:s,p=l.group,m=void 0===p?window.appData.group:p,d=c&&c.id;m&&a.a.isGroupOrPublication(m)&&(r=m.abilities&&m.abilities.read_private);var y=e&&e.abilities&&e.abilities.update;return!!(u&&!d&&i.enable_new_user_public_ability_forbid&&f.isNewbie&&!r&&!y)}s.propTypes={targetType:i.PropTypes.string}},2961:function(e,t,r){e.exports=r(2967)},2967:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),i=c(o),a=c(r(2));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.scrollListener=r.scrollListener.bind(r),r.eventListenerOptions=r.eventListenerOptions.bind(r),r.mousewheelListener=r.mousewheelListener.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){this.pageLoaded=this.props.pageStart,this.options=this.eventListenerOptions(),this.attachScrollListener()}},{key:"componentDidUpdate",value:function(){if(this.props.isReverse&&this.loadMore){var e=this.getParentElement(this.scrollComponent);e.scrollTop=e.scrollHeight-this.beforeScrollHeight+this.beforeScrollTop,this.loadMore=!1}this.attachScrollListener()}},{key:"componentWillUnmount",value:function(){this.detachScrollListener(),this.detachMousewheelListener()}},{key:"isPassiveSupported",value:function(){var e=!1,t={get passive(){e=!0}};try{document.addEventListener("test",null,t),document.removeEventListener("test",null,t)}catch(e){}return e}},{key:"eventListenerOptions",value:function(){this.props.useCapture;return this.isPassiveSupported()?{useCapture:this.props.useCapture,passive:!0}:{passive:!1}}},{key:"setDefaultLoader",value:function(e){this.defaultLoader=e}},{key:"detachMousewheelListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.scrollComponent.parentNode),e.removeEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture)}},{key:"detachScrollListener",value:function(){var e=window;!1===this.props.useWindow&&(e=this.getParentElement(this.scrollComponent)),e.removeEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),e.removeEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture)}},{key:"getParentElement",value:function(e){var t=this.props.getScrollParent&&this.props.getScrollParent();return null!=t?t:e&&e.parentNode}},{key:"filterProps",value:function(e){return e}},{key:"attachScrollListener",value:function(){var e=this.getParentElement(this.scrollComponent);if(this.props.hasMore&&e){var t=window;!1===this.props.useWindow&&(t=e),t.addEventListener("mousewheel",this.mousewheelListener,this.options?this.options:this.props.useCapture),t.addEventListener("scroll",this.scrollListener,this.options?this.options:this.props.useCapture),t.addEventListener("resize",this.scrollListener,this.options?this.options:this.props.useCapture),this.props.initialLoad&&this.scrollListener()}}},{key:"mousewheelListener",value:function(e){1!==e.deltaY||this.isPassiveSupported()||e.preventDefault()}},{key:"scrollListener",value:function(){var e=this.scrollComponent,t=window,r=this.getParentElement(e),n=void 0;if(this.props.useWindow){var o=document.documentElement||document.body.parentNode||document.body,i=void 0!==t.pageYOffset?t.pageYOffset:o.scrollTop;n=this.props.isReverse?i:this.calculateOffset(e,i)}else n=this.props.isReverse?r.scrollTop:e.scrollHeight-r.scrollTop-r.clientHeight;n<Number(this.props.threshold)&&e&&null!==e.offsetParent&&(this.detachScrollListener(),this.beforeScrollHeight=r.scrollHeight,this.beforeScrollTop=r.scrollTop,"function"==typeof this.props.loadMore&&(this.props.loadMore(this.pageLoaded+=1),this.loadMore=!0))}},{key:"calculateOffset",value:function(e,t){return e?this.calculateTopPosition(e)+(e.offsetHeight-t-window.innerHeight):0}},{key:"calculateTopPosition",value:function(e){return e?e.offsetTop+this.calculateTopPosition(e.offsetParent):0}},{key:"render",value:function(){var e=this,t=this.filterProps(this.props),r=t.children,n=t.element,o=t.hasMore,a=(t.initialLoad,t.isReverse),c=t.loader,u=(t.loadMore,t.pageStart,t.ref),l=(t.threshold,t.useCapture,t.useWindow,t.getScrollParent,function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["children","element","hasMore","initialLoad","isReverse","loader","loadMore","pageStart","ref","threshold","useCapture","useWindow","getScrollParent"]));l.ref=function(t){e.scrollComponent=t,u&&u(t)};var s=[r];return o&&(c?a?s.unshift(c):s.push(c):this.defaultLoader&&(a?s.unshift(this.defaultLoader):s.push(this.defaultLoader))),i.default.createElement(n,l,s)}}]),t}(o.Component);u.propTypes={children:a.default.node.isRequired,element:a.default.node,hasMore:a.default.bool,initialLoad:a.default.bool,isReverse:a.default.bool,loader:a.default.node,loadMore:a.default.func.isRequired,pageStart:a.default.number,ref:a.default.func,getScrollParent:a.default.func,threshold:a.default.number,useCapture:a.default.bool,useWindow:a.default.bool},u.defaultProps={element:"div",hasMore:!1,initialLoad:!0,pageStart:0,ref:null,threshold:250,useWindow:!0,isReverse:!1,useCapture:!1,loader:null,getScrollParent:null},t.default=u,e.exports=t.default},2972:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(0),o=r.n(n),i=r(2),a=r.n(i);function c(e){var t=e.disableLink,r=e.url,n=e.children,i=e.className,a=e.target,c=e.rel,u=e.dataAspmClick,l=e.title;return o.a.createElement("a",{href:t?"#":r,className:i,target:a,rel:c,title:l,"data-aspm-click":u},n)}c.propTypes={disableLink:a.a.bool,url:a.a.string,children:a.a.arrayOf(a.a.element),className:a.a.string,rel:a.a.string,target:a.a.string,dataAspmClick:a.a.string,title:a.a.string}},2975:function(e,t,r){"use strict";r(103);var n=r(60),o=(r(279),r(136)),i=r(0),a=r.n(i),c=r(2),u=r.n(c),l=r(790),s=r.n(l),f=r(9),p=r.n(f),m=r(30),d="CornerBubble-module_cornerBubble_2kGnu",y="CornerBubble-module_cornerCount_O3YTX",h="CornerBubble-module_cornerCountLarge_3x8Br",v="CornerBubble-module_cornerCountHover_x2J7h",b="CornerBubble-module_cornerIcon_N8Ibc",g="CornerBubble-module_badge_SQuZN";function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===w(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var E=function(e){var t,r,i,c=e.count,u=e.style,l=e.onClick,f=e.iconName,w=e.iconSize,E=e.countPopoverContent,O=e.countPopoverClassName,S=e.renderBadge,j=e.tooltipText;return a.a.createElement(n.a,{title:j},a.a.createElement("div",{className:d,onClick:l,style:u},s()(c)&&c>0&&(r=!!E,i=a.a.createElement("div",{className:p()((t={},_(t,y,!0),_(t,v,r),_(t,h,c>99),t))},c>99?"99+":c),r?a.a.createElement(o.a,{placement:"topRight",trigger:"hover",overlayClassName:O,content:E},i):i),S&&a.a.createElement("div",{className:g},S()),a.a.createElement(m.b,{className:b,name:f,width:w||20})))};E.propTypes={iconName:u.a.string.isRequired,iconSize:u.a.number,count:u.a.number,style:u.a.object,onClick:u.a.func,countPopoverContent:u.a.element,countPopoverClassName:u.a.string,renderBadge:u.a.func,tooltipText:u.a.string};t.a=E},2979:function(e,t,r){},2988:function(e,t,r){"use strict";r.r(t);r(63);var n=r(23),o=(r(62),r(21)),i=(r(263),r(67)),a=(r(104),r(38)),c=r(0),u=r.n(c),l=r(2),s=r.n(l),f=r(570),p=r(622),m=r.n(p),d=r(228),y="ReportForm-module_container_CFFvb",h="ReportForm-module_title_NFreI",v="ReportForm-module_subtitle_iS17z",b="ReportForm-module_reportType_F9Aq+",g="ReportForm-module_reportTypeItem_fcNpj",w="ReportForm-module_btns_P3Kpd",_="ReportForm-module_reportReason_Ll05f",E="ReportForm-module_backBtn_Epa1y";function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function S(){S=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new T(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(P([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==O(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function j(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I(n.key),n)}}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=N(e);if(t){var o=N(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return x(this,r)}}function x(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function M(e,t,r){return(t=I(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===O(t)?t:String(t)}var D=[{name:__("含有广告等引导性内容"),type:"normal",code:d.REPORT_TYPE.ad},{name:__("含有辱骂等不友善内容"),type:"normal",code:d.REPORT_TYPE.abuse},{name:__("含有色情、淫秽内容"),type:"normal",code:d.REPORT_TYPE.vulgar},{name:__("含有反社会、血腥暴力等内容"),type:"normal",code:d.REPORT_TYPE.political},{name:__("“清朗”系列专项举报"),type:"normal",code:d.REPORT_TYPE.clearnet},{name:__("传播不实信息（政治类、财经类、疫情类等）"),type:"normal",code:d.REPORT_TYPE.infact},{name:__("国家企业敏感信息泄露"),type:"normal",code:d.REPORT_TYPE.sensitive},{name:__("其他违法犯罪（如毒品、枪支、违规借贷等）"),type:"normal",code:d.REPORT_TYPE.illegal},{name:__("侵犯知识产权"),type:"tort"}],F=[{name:__("个人侵权"),type:"tort",code:d.REPORT_TYPE.personal_tort},{name:__("企业侵权"),type:"tort",code:d.REPORT_TYPE.enterprise_tort}],U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(l,e);var t,r,n,c=L(l);function l(){var e;P(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return M(A(e=c.call.apply(c,[this].concat(r))),"handleSubmit",(function(t){t.preventDefault();var r=e.props,n=r.onOk;(0,r.form.validateFields)((function(e,t){e||n(t)}))})),e}return t=l,(r=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(i.a,null,u.a.createElement("div",{className:v},__("具体说明")),u.a.createElement(i.a.Item,{required:!1},e("reason",{validateFirst:!0,rules:[{required:!0,max:500,message:__("请输入举报原因（字数不多于500）")}]})(u.a.createElement(a.a.TextArea,{className:_,rows:5,maxLength:500,placeholder:__("举报原因（字数不多于 500）")}))),u.a.createElement("div",{className:w},u.a.createElement(o.a,{block:!0,onClick:this.props.onCancel},__("返回")),u.a.createElement(o.a,{block:!0,type:"primary",htmlType:"submit",onClick:this.handleSubmit},__("提交"))))}}])&&R(t.prototype,r),n&&R(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(u.a.PureComponent);M(U,"propTypes",{onOk:s.a.func.isRequired,onCancel:s.a.func.isRequired,form:s.a.object.isRequired});var G=i.a.create()(U),q=function(e){var t=e.onCancel,r=e.onOk;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:v},window.h5?__("侵权类举报请到 PC 端完成"):__("请选择类型")),!window.h5&&u.a.createElement("ul",{className:b},F.map((function(e,t){return u.a.createElement("li",{key:e.code||t,className:g,onClick:function(){return function(e){r(e)}(e)}},e.name)}))),u.a.createElement(o.a,{block:!0,className:E,onClick:function(){t()}},__("返回")))};q.propTypes={onOk:s.a.func.isRequired,onCancel:s.a.func.isRequired};var B=function(e){var t=C(Object(c.useState)(),2),r=t[0],o=t[1];function i(e,t){t.preventDefault(),o(e)}var a=function(t){return function(){var r,o=(r=S().mark((function r(o){var i,a;return S().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=window.appData.sharePage&&window.appData.share.token,"tort"!==t.type){r.next=6;break}return e.onClose(),a=m.a.stringify({report_type:o.code,target_id:e.targetId,target_type:e.targetType,token:i}),window.open("/r/content_reports?".concat(a)),r.abrupt("return");case 6:return r.next=8,e.dispatch({type:"proxy.web/contentReport.create",payload:{data:{report_type:t.code,target_id:e.targetId,target_type:e.targetType,token:i,meta:{reason:o.reason,referer_url:window.location.href}}}});case 8:e.onClose(),n.a.success(__("已收到你的举报，感谢反馈"));case 10:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){j(i,n,o,a,c,"next",e)}function c(e){j(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(e){return o.apply(this,arguments)}}()};function l(){o(null)}return r?u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:h},r.name),"tort"===r.type?u.a.createElement(q,{onOk:a(r),onCancel:l}):u.a.createElement(G,{onOk:a(r),onCancel:l})):u.a.createElement("div",{className:y},u.a.createElement("div",{className:h},__("举报")),u.a.createElement("div",{className:v},__("请选举报原因")),u.a.createElement("ul",{className:b},D.map((function(e,t){return u.a.createElement("li",{key:e.code||t,onClick:i.bind(null,e)},u.a.createElement("div",{className:g},e.name))}))))};B.propTypes={targetId:s.a.number.isRequired,targetType:s.a.oneOf(["Doc"]).isRequired,onClose:s.a.func.isRequired};t.default=Object(f.d)()(B)},2991:function(e,t,r){"use strict";r(92);var n=r(45),o=r(0),i=r.n(o),a=r(2),c=r.n(a),u=r(198),l=r.n(u),s=r(570),f=r(2988);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var m=["children"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(){v=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),c=new T(o||[]);return n(a,"_invoke",{value:O(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function m(){}function d(){}function y(){}var h={};u(h,i,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(P([])));g&&g!==t&&r.call(g,i)&&(h=g);var w=y.prototype=m.prototype=Object.create(h);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==p(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function O(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=S(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function S(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=y,n(w,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:d,configurable:!0}),d.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},_(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b.apply(this,arguments)}function g(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function w(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){w(i,n,o,a,c,"next",e)}function c(e){w(i,n,o,a,c,"throw",e)}a(void 0)}))}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var S=function(e){var t=E(Object(o.useState)(!1),2),r=t[0],a=t[1];function c(){a(!1)}function u(){return(u=_(v().mark((function t(){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dispatch({type:"proxy.web/contentReport.check",payload:{data:{target_id:e.targetId,target_type:e.targetType,token:window.appData.sharePage&&window.appData.share.token}}});case 2:a(!0);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var l=e.children,s=g(e,m);return i.a.createElement(i.a.Fragment,null,l({onShowPanel:function(){return u.apply(this,arguments)}}),i.a.createElement(n.a,{destroyOnClose:!0,title:null,footer:null,visible:r,onCancel:c},i.a.createElement(f.default,b({},s,{onClose:c}))))};S.propTypes=y(y({},l()(f.default.propTypes,["targetId","targetType"])),{},{token:c.a.string,children:c.a.func.isRequired}),t.a=Object(s.d)()(S)},2998:function(e,t,r){"use strict";r(62);var n=r(21),o=(r(103),r(60)),i=r(0),a=r.n(i),c=r(2),u=r.n(c),l=r(9),s=r.n(l),f=r(106),p=r.n(f),m=r(84),d=r.n(m),y=r(2960),h=r(2773),v=r(254),b=r(2817),g=r(2831);r(2979);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=C(e);if(t){var o=C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}function S(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return j(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function T(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){var t=function(e,t){if("object"!==w(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===w(t)?t:String(t)}var R=p()("comment:editor.ui"),k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(u,e);var t,r,i,c=O(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),T(j(t=c.call(this,e)),"focusEditor",(function(){t.editor.focus(!0)})),T(j(t),"onLoad",(function(){t.onChange()})),T(j(t),"onChange",(function(){t.setState({hasValue:!t.editor.isEmpty()})})),T(j(t),"handleSubmit",(function(){t.editor.contentReady().then((function(){if(!t.editor.isEmpty()){var e={format:d.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};R("submit: ",e),t.props.onSubmit(e,(function(){t.reset()}))}}))})),T(j(t),"handleReplyTopicStatusSwitch",(function(){t.state.hasValue?t.editor.contentReady().then((function(){var e={format:d.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};t.props.onSubmit(e,(function(){t.reset(),t.props.toggleTopicStatus()}))})):t.props.toggleTopicStatus()})),T(j(t),"renderEditor",(function(){return a.a.createElement(g.default,{key:"".concat(t.state.editorInstanceId),editor:t.editor,onLoad:t.onLoad,onChange:t.onChange,onSubmit:t.handleSubmit})})),T(j(t),"renderReplyTo",(function(){var e=t.props,r=e.type,n=e.replyId,i=e.showReply;if(!n||!i)return null;var c,u=(t.props.comments||[]).find((function(e){return e.id===n}));if(!u)return R("comment ".concat(n," not exists")),null;c=u.user?u.user.name:__("用户已注销");var l="Topic"===r?"reply-":"comment-";return a.a.createElement("div",{className:"reply-tip"},__("回复")," ",a.a.createElement("a",{href:"#".concat(l).concat(u.id)},"@",c),a.a.createElement(o.a,{title:__("取消回复")},a.a.createElement("span",{className:"remove-reply",onClick:t.props.cancelReplyTo},a.a.createElement("span",{className:"larkicon larkicon-close"}))))})),T(j(t),"renderTopicAction",(function(){var e=t.props,r=e.type,o=e.target;return"Topic"===r&&o.abilities.update?a.a.createElement(n.a,{className:"btn-status",onClick:t.handleReplyTopicStatusSwitch},o.closed_at?a.a.createElement("span",null,t.state.hasValue?__("回复并重新开启"):__("重新开启")):a.a.createElement("span",null,t.state.hasValue?__("回复并关闭"):__("关闭主题"))):null})),t.editor=new b.c({disableYuqueCardEmbedView:e.disableYuqueCardEmbedView,belong:e.target,targetType:e.type,attachType:e.type,getDefaultSuggestions:e.getDefaultSuggestions,useMiniGuide:e.useMiniGuide,isMiniSize:e.isMiniSize,placeholder:e.placeholder||" ",replyId:e.replyId||""}),t.initialDocument=t.editor.getInitialDocument(),R("init use: ",t.initialDocument),t.state={hasValue:!1,editorInstanceId:"reply_main_".concat(e.replyId||"")},t}return t=u,(r=[{key:"componentDidUpdate",value:function(e){var t=this.props.replyId;t&&e.replyId!==t&&this.focusEditor(),e.replyId!==t&&this.editor._engine.engine.iRenderer.updatePlaceholder(this.props.placeholder)}},{key:"reset",value:function(){var e="reply_main_".concat(this.props.replyId||"","_").concat((new Date).getTime());this.editor.reset(),this.initialDocument=b.c.getEmptyDocument(),this.editor.initialDocument=this.initialDocument,this.setState({hasValue:!1,editorInstanceId:e}),R("reset editor, new instance: ".concat(e,", document: "),this.initialDocument)}},{key:"render",value:function(){var e=this.props,t=e.me,r=e.submitting,o=e.showAvatar,i=e.useMiniGuide,c=e.isMiniSize,u=e.group,l=e.reverseReplyButton,f=this.editor.isEditMode,p=s()({"comments-form-wrapper":!0,"edit-mode":f,"no-avatar":!o,"mini-size":c}),m=Object(y.b)(this.props.target,{me:t,group:u}),d=c?24:32;return a.a.createElement("div",{className:"comments-form-editor"},o&&a.a.createElement("div",{className:"avatar"},a.a.createElement(v.a,{src:t.avatar_url,size:d,name:t.name})),a.a.createElement("div",{className:p},a.a.createElement("div",{className:"editor-wrapper"},a.a.createElement("div",{className:"editor"},this.renderReplyTo(),this.renderEditor())),l?a.a.createElement("div",{className:"action clearfix",style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},(i||this.props.cancelable)&&a.a.createElement(n.a,{style:{marginRight:6},onClick:this.props.onCancelCreate},__("取消")),r?a.a.createElement(n.a,{disabled:"disabled"},a.a.createElement("span",null,__("提交中..."))):a.a.createElement(n.a,{disabled:this.state.hasValue&&!m?"":"disabled",onClick:this.handleSubmit},f?__("确定"):__("评论")),this.renderTopicAction(),m&&a.a.createElement(y.a,null)):a.a.createElement("div",{className:"action clearfix"},r?a.a.createElement(n.a,{disabled:"disabled",style:{marginRight:12}},a.a.createElement("span",null,__("提交中..."))):a.a.createElement(n.a,{type:"primary",disabled:this.state.hasValue&&!m?"":"disabled",onClick:this.handleSubmit,style:{marginRight:12}},f?__("确定"):__("回复")),(i||this.props.cancelable)&&a.a.createElement("a",{className:"btn-cancel",onClick:this.props.onCancelCreate},__("取消")),this.renderTopicAction(),m&&a.a.createElement(y.a,null))))}}])&&_(t.prototype,r),i&&_(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component);k.defaultProps={showAvatar:!0,useMiniGuide:!1,cancelable:!1,showReply:!0},k.propTypes={me:u.a.object.isRequired,type:u.a.oneOf(h.a.TARGET_TYPES),group:u.a.object,target:u.a.object.isRequired,targetType:u.a.object,replyId:u.a.number,comments:u.a.array,cancelReplyTo:u.a.func,onSubmit:u.a.func,toggleTopicStatus:u.a.func,getDefaultSuggestions:u.a.func,submitting:u.a.bool,showAvatar:u.a.bool,useMiniGuide:u.a.bool,onCancelCreate:u.a.func,isMiniSize:u.a.bool,cancelable:u.a.bool,disableYuqueCardEmbedView:u.a.bool,placeholder:u.a.string,showReply:u.a.bool,reverseReplyButton:u.a.bool},t.a=k},3023:function(e,t,r){"use strict";r(279);var n=r(136),o=r(0),i=r.n(o),a=r(2),c=r.n(a),u=r(9),l=r.n(u);r(2949);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){var t=e.reaction,r=e.users,a=e.myReaction,c=s(Object(o.useState)(!1),2),u=c[0],f=c[1];return i.a.createElement(n.a,{className:"post-reaction-detail",overlayClassName:"post-reaction-detail-popover",getPopupContainer:function(e){return e.parentNode},mouseEnterDelay:.618,trigger:["hover"],placement:"bottomLeft",onVisibleChange:function(r){f(r),!1===r?e.reset(t.id):e.loadUsers(t.id)},visible:u,content:i.a.createElement("ul",{className:"post-reaction-users"},r.map((function(e){return i.a.createElement("li",{key:e.id},i.a.createElement("a",{href:"/".concat(e.login),target:"_blank"},e.name))})))},i.a.createElement("div",{onClick:e.onReactionClick,className:l()({"post-reaction-detail-type":!0,"post-reaction-detail-active":a&&a.reaction_types&&a.reaction_types.includes(t.id)})},i.a.createElement("img",{className:"post-interaction-icon",src:t.icon,height:20}),i.a.createElement("span",{className:"post-interaction-num"},e.total)))}p.defaultProps={onReactionClick:function(){}},p.propTypes={myReaction:c.a.object,users:c.a.array.isRequired,total:c.a.number.isRequired,reaction:c.a.object.isRequired,loadUsers:c.a.func.isRequired,reset:c.a.func.isRequired,onReactionClick:c.a.func},t.a=p},3024:function(e,t,r){"use strict";r(279);var n=r(136),o=r(0),i=r.n(o),a=r(2),c=r.n(a),u=r(2913),l=r(30);r(2949);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p=u.a.REACTIONS;function m(e){var t=e.active,r=e.totalReaction,a=e.reactionIcon,c=s(Object(o.useState)(!1),2),u=c[0],f=c[1];return i.a.createElement("div",{className:"post-reaction"},i.a.createElement(n.a,{getPopupContainer:function(e){return e.parentNode},trigger:window.h5?["click"]:["hover"],placement:e.placement,autoAdjustOverflow:!1,visible:u,arrowPointAtCenter:!0,onVisibleChange:function(e){f(e)},content:i.a.createElement("div",null,i.a.createElement("ul",{className:"post-reaction-items"},p.map((function(r){return i.a.createElement("li",{className:t.includes(r.id)?"post-reaction-active":"",key:r.id},i.a.createElement("img",{src:r.icon,onClick:function(){var n;n=r,t.includes(n.id)?e.onCancelReaction(n.id):e.onReaction(n.id),e.onReactionUpdate(n),f(!1)}}))}))))},i.a.createElement("div",null,i.a.createElement("span",{className:"post-reaction-entry"},a||i.a.createElement(l.b,{name:"comment-reaction",width:20,height:20})),r>0&&i.a.createElement("span",{className:"post-interaction-action-total"},r))))}m.defaultProps={onReactionUpdate:function(){}},m.propTypes={active:c.a.array,onReaction:c.a.func.isRequired,onCancelReaction:c.a.func.isRequired,onReactionUpdate:c.a.func,totalReaction:c.a.number,reactionIcon:c.a.element,placement:c.a.string},t.a=m},3025:function(e,t,r){"use strict";var n=r(0),o=r(106),i=r.n(o),a=r(105);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===c(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d=new i.a("thread:post.port");t.a=function(e){var t=e.me,r=e.comment,o=e.onReactionUpdate,i=f(Object(n.useState)(r.reactions||[]),2),c=i[0],p=i[1],m=f(Object(n.useState)({}),2),y=m[0],h=m[1],v=f(Object(n.useState)(!1),2),b=v[0],g=v[1],w="Comment";Object(n.useEffect)((function(){p(r.reactions||[])}),[r]);var _=function(){var e=null;return t&&t.id&&(e=c.find((function(e){return e.user_id===t.id})))&&(e.reaction_types=e.action_option.split(",")),e},E=function(e){return a.webProxy.actions.create({target_id:r.id,target_type:w,action_type:"reaction",action_option:e}).then((function(r){d("success",r);var n=c.filter((function(e){return e.user_id!==t.id}));n.push({user_id:t.id,action_type:"reaction",action_option:e}),p(n),o&&o(n,{actionType:"create",userId:t.id,actionOption:e})}))};return{state:{reactions:c,reactionUserMap:y},reaction:function(e){d("reaction",e);var t=e,r=_();if(r){var n=s(r.reaction_types);if(n.includes(e))return Promise.resolve({});n.push(e),t=n.join(",")}return E(t)},cancelReaction:function(e){d("cancel reaction:",e);var n=_();if(!n)return Promise.resolve({});var i=n.reaction_types.filter((function(t){return t!==e}));if(i.length>0){var u=i.join(",");return d("update action_option",i.join(",")),E(u)}return a.webProxy.actions.destroy({target_id:r.id,target_type:w,action_type:"reaction"}).then((function(){var r=c.filter((function(e){return e.user_id!==t.id}));p(r),o&&o(r,{actionType:"delete",userId:t.id,reactionType:e})}))},loadReactionUser:function(e){d("load users for reaction",e),b||(g(!0),a.webProxy.actions.users({target_id:r.id,target_type:w,action_type:"reaction",action_option:"".concat(e),limit:30}).then((function(t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},y);r[e]=t,g(!1),h(r)})))},resetReactionUser:function(e){h({})},getMyReaction:_}}},3051:function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f}));var n=r(34);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=n.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(a)?a:String(a)),n)}var i,a}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var f={SCROLL:"SCROLL"},p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(l,e);var t,r,n,o=u(l);function l(){return a(this,l),o.apply(this,arguments)}return t=l,r&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(r.n(n).a),m=new p;function d(){return m}},3063:function(e,t,r){"use strict";r(62);var n=r(21),o=r(0),i=r.n(o),a=r(2),c=r.n(a),u=r(9),l=r.n(u),s=r(106),f=r.n(s),p=r(84),m=r.n(p),d=r(2817),y=r(2831);r(2979);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=E(e);if(t){var o=E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function O(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}var j=f()("comment:update.editor.ui"),C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(c,e);var t,r,o,a=g(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),O(_(t=a.call(this,e)),"onLoad",(function(){t.onChange()})),O(_(t),"onChange",(function(){t.setState({hasValue:!t.editor.isEmpty()})})),O(_(t),"handleCancel",(function(){t.reset(),t.props.onCancel()})),O(_(t),"handleSubmit",(function(){var e=t.props,r=e.comment,n=e.commentMoodChanged;t.editor.contentReady().then((function(){var e={format:m.a.FORMAT.LAKE,value:t.editor.getValue(),html:t.editor.getHtml()};j("on save: ".concat(r.id,", document: "),e),n||t.editor.isContentChanged()?t.props.onSave(r.id,e,(function(){t.handleCancel()})):t.handleCancel()}))})),O(_(t),"renderEditor",(function(){return i.a.createElement(y.default,{editor:t.editor,onLoad:t.onLoad,onChange:t.onChange,onSubmit:t.handleSubmit,key:"".concat(t.state.editorInstanceId)})}));var r=e.comment;return t.editor=new d.c({target:r,belong:e.target,attachType:e.type,useBelongAttach:!0,from:"reply",useMiniGuide:e.useMiniGuide,getDefaultSuggestions:e.getDefaultSuggestions,autoFocus:!0}),t.initialDocument=t.editor.getInitialDocument(),j("init use: ",t.initialDocument),t.state={hasValue:!0,editorInstanceId:"reply_update_".concat(r.id)},t}return t=c,(r=[{key:"reset",value:function(){this.editor.reset()}},{key:"render",value:function(){var e=l()({"comments-form-wrapper":!0,"edit-mode":!0});return i.a.createElement("div",{className:"comments-form-editor"},i.a.createElement("div",{className:e},i.a.createElement("div",{className:"editor-wrapper"},i.a.createElement("div",{className:"editor"},this.renderEditor())),i.a.createElement("div",{className:"action clearfix"},this.state.submitting?i.a.createElement(n.a,{disabled:"disabled"},i.a.createElement("span",null,__("提交中..."))):i.a.createElement(n.a,{type:"primary",disabled:this.state.hasValue?"":"disabled",onClick:this.handleSubmit},i.a.createElement("span",null,__("提交"))),i.a.createElement("a",{className:"btn-cancel",onClick:this.handleCancel},i.a.createElement("span",null,__("取消"))))))}}])&&v(t.prototype,r),o&&v(t,o),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.Component);C.propTypes={type:c.a.oneOf(["Topic","Doc","Resource"]),target:c.a.object.isRequired,comment:c.a.object.isRequired,onSave:c.a.func,onCancel:c.a.func,getDefaultSuggestions:c.a.func,commentMoodChanged:c.a.bool,useMiniGuide:c.a.bool},t.a=C},3066:function(e,t,r){"use strict";r(251);var n=r(116),o=r(995),i=r.n(o),a=r(0),c=r.n(a),u=r(2),l=r.n(u),s=r(106),f=r.n(s),p=r(9),m=r.n(p),d=r(570),y=r(2961),h=r.n(y),v=r(33),b=r(2773),g=(r(62),r(21)),w=r(487),_=r.n(w),E=r(30),O=r(125),S=r(2998),j=r(970),C={miniGuide:"Editor-module_miniGuide_71Yr9",areaBtn:"Editor-module_areaBtn_aMxhW",active:"Editor-module_active_Nin9i",icon:"Editor-module_icon_tywji",miniGuideLeft:"Editor-module_miniGuideLeft_6qlDi",replyIcon:"Editor-module_replyIcon_YVDPO",text:"Editor-module_text_ayCNj",miniWrapper:"Editor-module_miniWrapper_bgh3f",editorInput:"Editor-module_editorInput_pjxNG"};function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function P(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==T(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===T(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(){R=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==T(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return P()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function k(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var A=f()("comment:editor"),N=function(e){var t,r,n=e.targetType,o=e.target,i=e.useMiniGuide,u=e.dispatch,l=e.onCancelCreate,s=e.showReply,f="autosave/".concat(n,"_comments/").concat(o.id,"/replyId"),p=c.a.createRef(),m=Object(a.useState)(function(){if(!s)return null;var e=O.a.get(f);return A("cached reply id: ","".concat(f," -> ").concat(e)),e?Number(e):null}()),d=L(m,2),y=d[0],h=d[1],b=L(Object(a.useState)(!!i),2),g=b[0],w=b[1],E=function(){l&&"function"==typeof l?l():w(!g)},S=function(){h(null),O.a.remove(f),e.onCloseReply()},j=L(Object(a.useState)(!1),2),C=j[0],T=j[1];return{state:{submitting:C,replyId:y,showMiniGuide:g},editorRef:p,handleReplyTo:function(e){h(e),i&&g&&E(),O.a.set(f,e)},cancelReply:S,toggleEditor:E,toggleAreaCommenting:function(e){e.stopPropagation(),u&&u({type:"litecomment/toggleAreaCommenting"})},createReply:(t=R().mark((function t(r,a){var c,u,l,s,f,p,m,d;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return T(!0),c=e.litecomment,l=(u=void 0===c?{}:c).page,s=u.rect,f=e.comments,p={commentable_type:n,commentable_id:o.id,parent_id:y,body_asl:r.value,body:r.html,format:r.format,page:l,rect:s},(l||s)&&(p.type=_.a.TYPE.AREA_COMMENT),y&&((null==(m=f.find((function(e){return e.id===y})))?void 0:m.type)===_.a.TYPE.WORDING_COMMENT&&(p.type=_.a.TYPE.WORDING_COMMENT,p.selection=m.selection),m&&(p.root_id=m.parent_id?m.root_id:m.id,p.to_user_id=m.user_id)),"lake"!==p.format&&(p.body=r.html),t.prev=6,t.next=9,v.a.comments.create(p);case 9:d=t.sent,T(!1),A("reply success: ",d),a&&a(),e.onCreate&&e.onCreate(d),S(),i&&w(!0),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(6),T(!1);case 21:case"end":return t.stop()}}),t,null,[[6,18]])})),r=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(e){k(i,n,o,a,c,"next",e)}function c(e){k(i,n,o,a,c,"throw",e)}a(void 0)}))},function(e,t){return r.apply(this,arguments)})}},M=c.a.forwardRef((function(e,t){var r=N(e),n=r.state,o=n.replyId,i=n.showMiniGuide,u=n.submitting,l=c.a.createRef();Object(a.useImperativeHandle)(t,(function(){return{handleReplyTo:function(e){r.handleReplyTo(e),l&&l.current&&l.current.focusEditor()},cancelReply:r.cancelReply,focusEditor:function(){l&&l.current&&l.current.focusEditor()}}}));var s=e.className,f=e.group,p=e.targetType,d=e.target,y=e.comments,h=e.canComment,v=e.useMiniGuide,b=e.isMiniSize,w=e.areaCommenting,_=e.withAreaSelection,O=e.disableYuqueCardEmbedView,T=e.cancelable,R=e.me,k=e.showReply,L=e.placeholder,x=e.commentTipText;if(!h)return null;var A=m()(C.areaBtn,P({},C.active,w));return c.a.createElement("div",{className:m()(s,C.wrapper,P({},C.miniWrapper,b))},c.a.createElement(j.a,{me:R,place:"comment"},i?c.a.createElement("div",{className:C.miniGuide,onClick:r.toggleEditor,"data-testid":"comment-mini-guide"},c.a.createElement("div",{className:C.miniGuideLeft},c.a.createElement(E.b,{name:"comment-reply",className:C.replyIcon}),c.a.createElement("span",{className:C.text},x||__("点击添加评论"))),_&&c.a.createElement(g.a,{onClick:r.toggleAreaCommenting,className:A,"data-testid":"area-selection-button"},c.a.createElement(E.b,{name:"area-comment",size:14,className:C.icon}),__("框选评论"))):c.a.createElement("div",{className:C.editorInput,"data-testid":"comment-editor"},c.a.createElement(S.a,{me:R,group:f,type:p,submitting:u,target:d,replyId:o,cancelReplyTo:r.cancelReply,comments:y,onSubmit:r.createReply,getDefaultSuggestions:e.getDefaultSuggestions,showAvatar:!v,useMiniGuide:v,onCancelCreate:r.toggleEditor,toggleTopicStatus:e.toggleTopicStatus,isMiniSize:b,ref:l,cancelable:T,disableYuqueCardEmbedView:O,showReply:k,placeholder:L}))))}));M.defaultProps={me:window.appData.me,onCloseReply:function(){}},M.propTypes={className:l.a.string,group:l.a.object.isRequired,target:l.a.object.isRequired,targetType:l.a.oneOf(b.a.TARGET_TYPES),comments:l.a.array,useMiniGuide:l.a.bool,canComment:l.a.bool,onCreate:l.a.func,cancelable:l.a.bool,onCancelCreate:l.a.func,getDefaultSuggestions:l.a.func,toggleTopicStatus:l.a.func,type:l.a.oneOf(["default","timeline"]),isMiniSize:l.a.bool,editorAffixed:l.a.bool,litecomment:l.a.object,withAreaSelection:l.a.bool,dispatch:l.a.func,areaCommenting:l.a.bool,disableYuqueCardEmbedView:l.a.bool,me:l.a.object,showReply:l.a.bool,placeholder:l.a.string,onCloseReply:l.a.func,commentTipText:l.a.string},M.displayName="LiteCommentEditor";var I=M,D=r(51),F=r(264),U=r(2993),G=r(3050),q=r(206),B=r(272),V=r(254),Y=r(869),z=r(3073),H=r(2972),W=r(85),K=r(3051),$="wordCommentSelection-module_container_LBNIq",J="wordCommentSelection-module_prefixIcon_nL7Bk",Z="wordCommentSelection-module_quotation_qfH3Q",Q="wordCommentSelection-module_quotationTip_S-QRh",X="wordCommentSelection-module_quotationContent_atDX4",ee="wordCommentSelection-module_quotationContentMini_5dM90";function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==te(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===te(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ie(e){var t,r=e.comment,n=e.getViewEngine,o=e.isMiniSize,i=Object(a.useCallback)((function(){var e,t=Object(K.b)(),o=null==r||null===(e=r.selection)||void 0===e?void 0:e.paragraph_id,i=n();i&&o&&i.execCommand("tryUnfold",o),t.emit(K.a.SCROLL,ne(ne({},r.selection),{},{comment_id:r.id}))}),[r,n,K.b]);return r.selection_type===_.a.SELECTION_TYPE.Review?null:c.a.createElement("div",{className:$},c.a.createElement("span",{className:J}),c.a.createElement("div",{className:Z,onClick:i},c.a.createElement("span",{className:m()((t={},oe(t,X,!o),oe(t,ee,o),t))},c.a.createElement("span",{className:Q},__("引用原文：")),r.selection.text)))}ie.defaultProps={isMiniSize:!1},ie.propTypes={comment:l.a.object.isRequired,getViewEngine:l.a.func.isRequired,isMiniSize:l.a.bool};var ae=ie,ce=r(2909),ue=r(3063),le=r(1458),se=r(2921),fe=["children"],pe=["children"];function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},de.apply(this,arguments)}function ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function ve(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=be(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function be(e,t){if(e){if("string"==typeof e)return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ge(e,t):void 0}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_e(n.key),n)}}function _e(e){var t=function(e,t){if("object"!==me(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===me(t)?t:String(t)}function Ee(){return window.WeakMap?new WeakMap:new(function(){function e(){var t,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n={},(r=_e(r="_map"))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}var t,r,n;return t=e,(r=[{key:"has",value:function(e){return!!this._map[e]}},{key:"delete",value:function(e){this._map[e]=void 0,delete this._map[e]}},{key:"get",value:function(e){return this._map[e]}}])&&we(t.prototype,r),n&&we(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())}var Oe=Ee(),Se=Ee(),je=window.IntersectionObserver?new IntersectionObserver((function(e){var t,r=ve(e);try{for(r.s();!(t=r.n()).done;){var n,o=t.value;if(Oe.has(o.target))null===(n=Oe.get(o.target))||void 0===n||n(o.intersectionRatio,o.intersectionRect.height)}}catch(e){r.e(e)}finally{r.f()}}),{rootMargin:"100%",threshold:[0,.1,1]}):null,Ce=window.ResizeObserver?new window.ResizeObserver((function(e){var t,r=ve(e);try{for(r.s();!(t=r.n()).done;){var n,o=t.value;if(Se.has(o.target))null===(n=Se.get(o.target))||void 0===n||n(o.contentRect)}}catch(e){r.e(e)}finally{r.f()}})):null;function Te(e){var t=e.children,r=he(e,fe);return c.a.createElement("div",r,t)}Te.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired};var Pe=window.DELAY_COMMENTS_DEFAULT_HEIGHT||400;function Re(){var e=ye(Object(a.useState)(null),2),t=e[0],r=e[1],n=Object(a.useCallback)((function(e){e!==t&&r(e)}),[t]);return{current:t,setRef:n}}function ke(e){var t=e.children,r=he(e,pe),n=Re(),o=Re(),i=ye(Object(a.useState)(!0),2),u=i[0],l=i[1],s=ye(Object(a.useState)(0),2),f=s[0],p=s[1],m=ye(Object(a.useState)(Pe),2),d=m[0],y=m[1];return Object(a.useEffect)((function(){if(n.current){var e=n.current;return Oe.set(e,(function(e){e>0&&u&&l(!1),p(e)})),je.observe(e),function(){Oe.delete(e),je.unobserve(e)}}}),[n,u,p]),Object(a.useEffect)((function(){if(o.current){var e=o.current;return Se.set(e,(function(e){0!==e.height&&y(e.height)})),Ce.observe(e),function(){Se.delete(e),Ce.unobserve(e)}}}),[o,y]),c.a.createElement("div",de({ref:n.setRef},r,{style:{minHeight:d}}),u?null:c.a.createElement("div",{style:{display:f>0?"block":"none"},ref:o.setRef},t))}ke.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired};var Le=function(e){var t;return!je||null!==(t=window.appData.settings)&&void 0!==t&&t.disable_comment_delay?c.a.createElement(Te,e):c.a.createElement(ke,e)};Le.propTypes={children:l.a.oneOfType([l.a.arrayOf(l.a.node),l.a.node]).isRequired};var xe=Le;function Ae(e){var t=e.comment,r=e.group,n=e.target,o=e.commentableType,i=e.onClick,a=e.mode,u=e.onCancelEdit,l=e.onSave,s=e.getDefaultSuggestions,f=e.useMiniGuide,p=e.disableYuqueCardEmbedView,m={read_status:-1===t.status?99:0,id:t.id};if("edit"===a)return c.a.createElement("div",{style:{marginBottom:16}},c.a.createElement(ue.a,{type:o,group:r,comment:t,target:n,onCancel:u,onSave:l,getDefaultSuggestions:s,useMiniGuide:f}));var d=Object(ce.a)()||Object(ce.b)();return c.a.createElement(c.a.Fragment,null,c.a.createElement(xe,{className:"content-detail",onClick:function(){return i(t)}},d&&c.a.createElement("div",{style:{marginBottom:6}},c.a.createElement(se.default,{key:"audits",doc:m,type:"Comment"})),c.a.createElement(le.default,{id:t.id,key:"reply-".concat(t.id),genOutline:!1,genAnchor:!1,content:t.body_asl,disableYuqueCardEmbedView:p,simpleUI:!0,imageLazyLoad:!0})))}function Ne(){}Ae.defaultProps={onCancelEdit:Ne,onSave:Ne,onClick:Ne},Ae.propTypes={comment:l.a.object.isRequired,group:l.a.object.isRequired,target:l.a.object.isRequired,getDefaultSuggestions:l.a.func.isRequired,commentableType:l.a.oneOf(b.a.TARGET_TYPES),mode:l.a.oneOf(["edit","view"]),useMiniGuide:l.a.bool,disableYuqueCardEmbedView:l.a.bool,onCancelEdit:l.a.func,onSave:l.a.func,onClick:l.a.func};var Me=Ae,Ie=r(2913),De=r(3023),Fe=Ie.a.REACTIONS;function Ue(e){var t=e.comment,r=e.onReactionUpdate,n=e.reactionMap,o=e.reactions,i=e.myReaction,a=e.reactionViewModel,u=e.reactionUserMap;return o.length>0?c.a.createElement("div",{className:"post-interaction",style:{marginTop:12}},c.a.createElement("div",{className:"post-interaction-reaction-summary"},c.a.createElement("ul",null,Fe.map((function(e){var o=n[e.id].count;return 0===o?null:c.a.createElement("li",{key:e.id},c.a.createElement(De.a,{myReaction:i,reaction:e,users:u[e.id]||[],total:o,loadUsers:function(){a.loadReactionUser(e.id)},reset:function(){a.resetReactionUser(e.id)},onReactionClick:function(){(i&&i.action_option.includes(e.id)?a.cancelReaction(e.id):a.reaction(e.id)).then((function(){a.loadReactionUser(e.id),r(e,t)}))}}))}))))):null}Ue.defaultProps={onReactionUpdate:function(){}},Ue.propTypes={comment:l.a.object.isRequired,onReactionUpdate:l.a.func,reactionMap:l.a.object.isRequired,reactions:l.a.array.isRequired,myReaction:l.a.object,reactionViewModel:l.a.object.isRequired,reactionUserMap:l.a.object.isRequired};var Ge=Ue,qe=(r(279),r(136)),Be=(r(166),r(31)),Ve=(r(280),r(102)),Ye=r(2991),ze=r(3024),He={container:"commentActions-module_container_Pd8UE",actionsHiddenArea:"commentActions-module_actionsHiddenArea_rwxN3",actionItem:"commentActions-module_actionItem_IYkZw",actionItemWithoutMargin:"commentActions-module_actionItemWithoutMargin_UTjq4"},We="commentFloorListItem-module_commentFloorListItem_hEa7c",Ke="commentFloorListItem-module_listItemWrapper_WP5Au",$e="commentFloorListItem-module_hashActive_QOVC4",Je="commentFloorListItem-module_isSelected_KRAD2",Ze="commentFloorListItem-module_isMiniSize_LwzVw",Qe="commentFloorListItem-module_avatar_MHjSF",Xe="commentFloorListItem-module_commentOrder_Iuwe4",et="commentFloorListItem-module_main_gfOyp",tt="commentFloorListItem-module_commentMain_sXNkM",rt="commentFloorListItem-module_actionsHiddenArea_sIy27",nt="commentFloorListItem-module_head_HFLrS",ot="commentFloorListItem-module_name_pqKOI",it="commentFloorListItem-module_miniName_SV4Rr",at="commentFloorListItem-module_toUserName_ODbN0",ct="commentFloorListItem-module_miniToUserName_tSChh",ut="commentFloorListItem-module_arrowRight_KtPw0",lt="commentFloorListItem-module_time_juhkg",st="commentFloorListItem-module_commentIpRegion_jl233",ft="commentFloorListItem-module_wordCommentSelectionWrapper_7T0sG",pt="commentFloorListItem-module_content_Zn013",mt="commentFloorListItem-module_replyEditor_PeaGC",dt="commentFloorListItem-module_deleted_2GyFb",yt="commentFloorListItem-module_rootCommentFloorListItem_KZW6g";function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function vt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==ht(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ht(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bt(e){var t=e.comment,r=e.me,n=e.isMobile,o=e.canComment,i=e.canEdit,a=e.canReport,u=e.canDelete,l=e.onRemove,s=e.onEdit,f=e.onReplyTo,p=e.onCopyCommentLink,d=e.reactionViewModel,y=e.myReaction,h=e.onReactionUpdate;return r&&r.id?c.a.createElement("div",{className:He.container},o&&c.a.createElement("span",{className:He.actionItem},c.a.createElement(E.b,{name:"comment-bubble",color:"#8C8C8C",width:16,height:16,onClick:f})),o&&c.a.createElement(ze.a,{placement:n?"topLeft":void 0,reactionIcon:c.a.createElement("span",{className:He.actionItemWithoutMargin},c.a.createElement(E.b,{className:He.action,name:"comment-reaction",color:"#8C8C8C",width:16,height:16})),active:(null==y?void 0:y.reaction_types)||[],onReaction:d.reaction,onCancelReaction:d.cancelReaction,onReactionUpdate:function(e){return h(e,t)}}),c.a.createElement("div",{className:m()(He.actionsHiddenArea,vt({},rt,!n))},i&&c.a.createElement("span",{className:He.actionItem},c.a.createElement(E.b,{className:He.action,name:"edit-border",width:16,height:16,color:"#8C8C8C",onClick:s})),u&&c.a.createElement(Ve.a,{title:__("确认删除该评论么？"),onConfirm:l},c.a.createElement("span",{className:He.actionItem},c.a.createElement(E.b,{className:He.action,name:"icon-delete",color:"#8C8C8C",width:16,height:16}))),c.a.createElement(qe.a,{type:"menu",getPopupContainer:function(e){return e.parentNode},placement:"bottomRight",arrowPointAtCenter:!0,trigger:n?"click":"hover",content:c.a.createElement(Be.a,null,c.a.createElement(Be.a.Item,{key:"copy"},c.a.createElement("span",{onClick:p},__("复制评论链接"))),a&&c.a.createElement(Be.a.Item,{key:"report"},c.a.createElement(Ye.a,{targetId:t.id,targetType:"Comment"},(function(e){return c.a.createElement("span",{className:"action-link",onClick:e.onShowPanel},__("举报"))})))),hideWhenInactive:!0},c.a.createElement("span",{className:He.actionItem},c.a.createElement(E.b,{className:He.action,name:"comment-more",color:"#8C8C8C",width:16,height:16}))))):null}bt.defaultProps={isMobile:!1},bt.propTypes={comment:l.a.object.isRequired,me:l.a.object,canComment:l.a.bool,canEdit:l.a.bool,canReport:l.a.bool,canDelete:l.a.bool,onRemove:l.a.func.isRequired,onEdit:l.a.func.isRequired,onReplyTo:l.a.func.isRequired,onCopyCommentLink:l.a.func,onReactionUpdate:l.a.func,reactionViewModel:l.a.object,myReaction:l.a.object,isMobile:l.a.bool};var gt=bt;function wt(e){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(e)}function _t(){_t=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==wt(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function Et(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return St(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return St(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var jt=f()("comment:editor"),Ct=function(e){var t,r=e.commentableType,n=e.target,o=e.dispatch,i=e.rootId,u=e.replyToComment,l=e.litecomment,s=void 0===l?{}:l,f=e.onCancelReply,p=e.onCreate,m=c.a.createRef(),d=Ot(Object(a.useState)(!1),2),y=d[0],h=d[1];t=u.user?u.user.name:__("用户已注销");var b,g;return{state:{submitting:y,replyId:u.id,placeholder:__("回复 {user}",{user:t})},editorRef:m,handleCancelReply:function(){f()},toggleAreaCommenting:function(e){e.stopPropagation(),o&&o({type:"litecomment/toggleAreaCommenting"})},createReply:(b=_t().mark((function e(t,o){var a,c,l,m;return _t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),a=s.page,c=s.rect,l={commentable_type:r,commentable_id:n.id,parent_id:u.id,to_user_id:u.user_id,body_asl:t.value,body:t.html,format:t.format,page:a,rect:c},(a||c)&&(l.type=_.a.TYPE.AREA_COMMENT),u&&(u.type===_.a.TYPE.WORDING_COMMENT&&(l.type=_.a.TYPE.WORDING_COMMENT,l.selection=u.selection),l.root_id=i),"lake"!==l.format&&(l.body=t.html),e.prev=6,e.next=9,v.a.comments.create(l);case 9:(m=e.sent).to_user=u.user,h(!1),jt("reply success: ",m),o&&o(),p&&p(m),f(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),h(!1);case 21:case"end":return e.stop()}}),e,null,[[6,18]])})),g=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=b.apply(e,t);function i(e){Et(o,r,n,i,a,"next",e)}function a(e){Et(o,r,n,i,a,"throw",e)}i(void 0)}))},function(e,t){return g.apply(this,arguments)})}},Tt=c.a.forwardRef((function(e,t){var r=Ct(e),n=r.state,o=n.replyId,i=n.submitting,u=n.placeholder,l=c.a.createRef();Object(a.useImperativeHandle)(t,(function(){return{focusEditor:function(){l&&l.current&&l.current.focusEditor()}}}));var s=e.group,f=e.canComment,p=e.isMiniSize,m=e.disableYuqueCardEmbedView,d=e.cancelable,y=e.me,h=e.comments,v=e.useMiniGuide,b=e.replyToComment,g=e.commentableType,w=e.target,_=e.reverseReplyButton;return f?c.a.createElement(j.a,{me:y,place:"comment"},c.a.createElement(S.a,{ref:l,placeholder:u,me:y,group:s,type:g,submitting:i,target:w,replyId:o,replyToComment:b,showReply:!1,cancelReplyTo:r.cancelReply,comments:h,onSubmit:r.createReply,getDefaultSuggestions:e.getDefaultSuggestions,showAvatar:!1,useMiniGuide:v,onCancelCreate:r.handleCancelReply,isMiniSize:p,cancelable:d,disableYuqueCardEmbedView:m,reverseReplyButton:_})):null}));Tt.defaultProps={me:window.appData.me,onCancelReply:function(){}},Tt.propTypes={group:l.a.object.isRequired,target:l.a.object.isRequired,commentableType:l.a.oneOf(b.a.TARGET_TYPES),comments:l.a.array,canComment:l.a.bool,cancelable:l.a.bool,getDefaultSuggestions:l.a.func,isMiniSize:l.a.bool,useMiniGuide:l.a.bool,litecomment:l.a.object,dispatch:l.a.func,disableYuqueCardEmbedView:l.a.bool,me:l.a.object,rootId:l.a.number,replyToComment:l.a.object,onCancelReply:l.a.func,onCreate:l.a.func,reverseReplyButton:l.a.bool},Tt.displayName="CommentReplyEditor";var Pt=Tt,Rt=(r(63),r(23)),kt=r(288),Lt=r.n(kt),xt=r(3025);function At(e){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},At(e)}function Nt(){Nt=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==At(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function Mt(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function It(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Mt(i,n,o,a,c,"next",e)}function c(e){Mt(i,n,o,a,c,"throw",e)}a(void 0)}))}}function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(r),!0).forEach((function(t){Ut(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ut(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==At(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===At(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Bt=function(e){var t,r,n,o,i,c=e.isRootComment,u=e.comment,l=e.commentableType,s=e.me,f=e.target,p=e.dispatch,m=e.onRemoveComment,d=e.onUpdateComment,y=e.canComment,h=e.onCreateComment,g=e.isMobile,E=e.onReplyToComment,O=Object(a.useContext)(U.a),S=Gt(Object(a.useState)("view"),2),j=S[0],C=S[1],T=Object(a.useRef)(null),P=Gt(Object(a.useState)(!1),2),R=P[0],k=P[1],L=!window.h5&&u.meta&&u.meta.ip,x=!c&&u.parent_id&&u.parent_id!==u.root_id,A=b.a.getAnchorId(u.id,l),N=c&&u.type===_.a.TYPE.WORDING_COMMENT,M=!!u.deleted_at,I=Object(xt.a)({me:s,comment:u,onReactionUpdate:function(e,t){var r=Ft(Ft({},u),{},{reactions:e});p({type:"litecomment/updateOne",payload:r}),null==O||O.updateReaction(null,r,t)}}),D=I.state,F=D.reactions,G=D.reactionUserMap,q=Object(a.useMemo)((function(){var e={reactionMap:Ie.a.classifyReactions(F),myReaction:I.getMyReaction(),totalReaction:0};return Object.keys(e.reactionMap).forEach((function(t){e.totalReaction+=e.reactionMap[t].count})),e}),[F]),B=q.reactionMap,V=q.myReaction;return{state:{showReplyToUser:x,anchor:A,wordingCommentVisible:N,contentEditorMode:j,isDeleted:M,reactionMap:B,myReaction:V,reactions:F,reactionUserMap:G,replyEditorVisible:R,metaInfoVisible:L},reactionViewModel:I,editorRef:T,handleEdit:function(){C("edit")},handleCancelEdit:function(){C("view")},handleEditorSave:(i=It(Nt().mark((function e(t,r,n){var o,i;return Nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={id:t,format:r.format,body_asl:r.value,body:r.html},e.next=3,v.a.comments.update(o);case 3:(i=e.sent).to_user=u.to_user,i.reactions=u.reactions,i.sub_comments=u.sub_comments,n&&n(),d(i),p({type:"litecomment/updateOne",payload:i}),null==O||O.updateComment(i);case 11:case"end":return e.stop()}}),e)}))),function(e,t,r){return i.apply(this,arguments)}),handleCommentContentClick:function(){"Resource"===l&&p({type:"litecomment/updateCurrentCommentId",payload:u.id})},canComment:function(){return!M&&y},canEdit:function(){return!M&&(s&&s.id===u.user_id)},canReport:function(){if(M)return!1;if(!window.appData.isPublicCloud)return!1;var e=Object(ce.a)()||Object(ce.b)();return u.status===w.STATUS.normal&&e&&s&&s.id!==u.user_id},canDelete:function(){var e;return!M&&(!!s&&(s.id===u.user_id||"Doc"===l&&(null===(e=f.abilities)||void 0===e?void 0:e.destroy_comment)))},handleReplyToComment:(o=It(Nt().mark((function e(){return Nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g?E(u):(k(!0),setTimeout((function(){var e;null===(e=T.current)||void 0===e||e.focusEditor()}),200));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),handleCreateComment:(n=It(Nt().mark((function e(t){return Nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.to_user=u.user,p({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==O||O.createComment(t),h(t);case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),handleCancelReply:(r=It(Nt().mark((function e(){return Nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(!1);case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)}),handleRemoveComment:(t=It(Nt().mark((function e(){var t;return Nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={id:u.id},v.a.comments.destroy(t).then((function(){p({type:"litecomment/remove",payload:t}),Rt.a.success(__("操作成功"),3),m(t),null==O||O.destroyComment(u)}));case 2:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),handleReactionUpdate:function(){},handleCopyCommentLink:function(){var e=Ie.a.getPostUrl(u.id);Lt()(e),Rt.a.success(__("评论链接复制成功"))}}};function Vt(e){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vt(e)}function Yt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Vt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Vt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zt(e){var t,r=e.comment,n=e.flattenFloorComments,o=e.isRootComment,i=e.commentableType,a=e.getViewEngine,u=e.target,l=e.useMiniGuide,s=e.getDefaultSuggestions,f=e.disableYuqueCardEmbedView,p=e.group,d=e.me,y=e.canComment,h=e.dispatch,v=e.onUpdateComment,b=(e.editorAffixed,e.isMobile),g=e.isMiniSize,w=(e.areaCommenting,e.cancelable,e.onCancelCreate,e.litecomment),_=e.urlHash,O=e.currentCommentId,S=e.onCreateComment,j=e.onEditComment,C=e.onRemoveComment,T=e.onReplyToComment,P=e.reverseReplyButton,R=r.user,k=r.to_user,L=Bt({isRootComment:o,comment:r,commentableType:i,me:d,target:u,onRemoveComment:C,onEditComment:j,dispatch:h,onUpdateComment:v,canComment:y,onCreateComment:S,onReplyToComment:T,isMobile:b}),x=L.state,A=x.showReplyToUser,N=x.anchor,M=x.wordingCommentVisible,I=x.contentEditorMode,F=x.replyEditorVisible,U=x.isDeleted,G=x.reactionMap,K=x.myReaction,$=x.reactions,J=x.reactionUserMap,Z=L.reactionViewModel,Q=L.editorRef,X=o?r.id:r.root_id,ee=_==="#".concat(N),te=O===r.id,re=g?24:32,ne={paddingLeft:re+12};return c.a.createElement("div",{id:N,className:m()(We,Yt({},yt,o)),style:o?null:ne},c.a.createElement("div",{className:m()(Ke,(t={},Yt(t,$e,ee),Yt(t,Je,te),Yt(t,Ze,g),t))},R?c.a.createElement("div",{className:Qe},c.a.createElement(H.a,{url:"/".concat(R.login),disableLink:W.a.isInOrg()},c.a.createElement(c.a.Fragment,null,c.a.createElement(Y.a,{user:R},c.a.createElement(V.a,{src:R.avatar_url,size:re,name:R.name})),r.order&&c.a.createElement("span",{className:Xe},r.order)))):c.a.createElement("div",{className:Qe},c.a.createElement(V.a,{src:q.avatar.user,size:re,name:__("用户已注销")}),r.order&&c.a.createElement("span",{className:Xe},r.order)),c.a.createElement("div",{className:et},c.a.createElement("div",{className:tt},c.a.createElement("div",{className:nt},R?c.a.createElement(H.a,{url:"/".concat(R.login),disableLink:W.a.isInOrg(),className:m()(ot,Yt({},it,g))},c.a.createElement(c.a.Fragment,null,R.name,(null==d?void 0:d.isAdmin)&&[D.STATUS.banned,D.STATUS.blocked].includes(R.status)&&c.a.createElement("span",{className:"book-name-scope"},c.a.createElement(E.b,{name:"doc-has-content-risk",width:13,style:{opacity:.375,marginLeft:4}})))):c.a.createElement("a",{className:ot},__("用户已注销")),A&&(k?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:ut}),g?c.a.createElement(H.a,{url:"/".concat(k.login),disableLink:W.a.isInOrg(),className:m()(at,ct)},k.name):c.a.createElement(Y.a,{user:k},c.a.createElement(H.a,{url:"/".concat(k.login),disableLink:W.a.isInOrg(),className:at},k.name))):c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:ut}),c.a.createElement("a",{className:at},__("用户已注销")))),!g&&c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{href:"#".concat(N),className:lt},c.a.createElement(B.a,{time:r.created_at})),c.a.createElement("span",{className:st},c.a.createElement(z.a,{target:r,type:"Comment"})))),g&&c.a.createElement("div",null,c.a.createElement("a",{href:"#".concat(N),className:lt},c.a.createElement(B.a,{time:r.created_at})),c.a.createElement("span",{className:st},c.a.createElement(z.a,{target:r,type:"Comment"}))),M&&c.a.createElement("div",{className:ft},c.a.createElement(ae,{isMiniSize:g,comment:r,getViewEngine:a})),U?c.a.createElement("div",{className:pt},c.a.createElement("div",{className:dt},__("该评论已删除"))):c.a.createElement("div",{className:pt},c.a.createElement(Me,{comment:r,group:p,target:u,getDefaultSuggestions:s,commentableType:i,mode:I,useMiniGuide:l,disableYuqueCardEmbedView:f,onCancelEdit:L.handleCancelEdit,onSave:L.handleEditorSave,onClick:L.handleCommentContentClick})),!U&&c.a.createElement(Ge,{comment:r,onReactionUpdate:L.handleReactionUpdate,reactionViewModel:Z,myReaction:K,reactionMap:G,reactions:$,reactionUserMap:J}),!U&&c.a.createElement(gt,{isMobile:b,comment:r,me:d,canComment:L.canComment(),canEdit:L.canEdit(),canReport:L.canReport(),canDelete:L.canDelete(),onReplyTo:L.handleReplyToComment,onEdit:L.handleEdit,onRemove:L.handleRemoveComment,onCopyCommentLink:L.handleCopyCommentLink,reactionViewModel:Z,reactionMap:G,myReaction:K,reactions:$,reactionUserMap:J,onReactionUpdate:L.handleReactionUpdate}),F&&c.a.createElement("div",{className:mt},c.a.createElement(Pt,{ref:Q,rootId:X,replyToComment:r,group:p,me:d,target:u,commentableType:i,litecomment:w,comments:n,cancelable:!0,isMiniSize:g,disableYuqueCardEmbedView:f,getDefaultSuggestions:s,dispatch:h,canComment:y,onCancelReply:L.handleCancelReply,onCreate:L.handleCreateComment,reverseReplyButton:P}))))))}zt.defaultProps={canComment:!0,onEditComment:function(){},onRemoveComment:function(){},onCreateComment:function(){},getViewEngine:function(){}},zt.propTypes={comment:l.a.object.isRequired,flattenFloorComments:l.a.arrayOf(l.a.object),getViewEngine:l.a.func,isRootComment:l.a.bool,commentableType:l.a.oneOf(b.a.TARGET_TYPES),target:l.a.object.isRequired,useMiniGuide:l.a.bool,getDefaultSuggestions:l.a.func,disableYuqueCardEmbedView:l.a.bool,group:l.a.object.isRequired,me:l.a.object.isRequired,canComment:l.a.bool,onEditComment:l.a.func,onCreateComment:l.a.func,onRemoveComment:l.a.func,onUpdateComment:l.a.func,dispatch:l.a.func,editorAffixed:l.a.bool,isMobile:l.a.bool,isMiniSize:l.a.bool,areaCommenting:l.a.bool,cancelable:l.a.bool,onCancelCreate:l.a.func,litecomment:l.a.object,urlHash:l.a.string,currentCommentId:l.a.number,onReplyToComment:l.a.func.isRequired};var Ht=zt,Wt="index-module_default_FTDOK",Kt="index-module_commentEditor_yI7Ow",$t="index-module_mini_6PdDj",Jt="index-module_emptyView_t1FqB",Zt="index-module_miniEditor_CRXwG",Qt="index-module_editorMobile_0VdOM",Xt="index-module_miniFloorList_+ysrM";function er(e){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er(e)}function tr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==er(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===er(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function or(e){var t=e.flattenFloorComments,r=e.commentableType,n=e.getViewEngine,o=e.target,i=e.useMiniGuide,u=e.getDefaultSuggestions,l=e.disableYuqueCardEmbedView,s=e.group,f=e.me,p=e.canComment,d=e.onReplyToComment,y=e.onEditComment,h=e.onCreateComment,v=e.onRemoveComment,b=e.onUpdateComment,g=e.dispatch,w=e.litecomment,_=e.isMiniSize,E=e.currentCommentId,O=e.isMobile,S=e.reverseReplyButton,j="";try{j=decodeURIComponent(window.location.hash)}catch(e){}var C=rr(Object(a.useState)(j),2),T=C[0],P=C[1];return Object(a.useEffect)((function(){var e=function(){try{P(decodeURIComponent(window.location.hash))}catch(e){}};return window.addEventListener("hashchange",e,!1),function(){window.removeEventListener("hashchange",e,!1)}}),[]),c.a.createElement("div",{className:m()(tr({},Xt,_))},t.map((function(e){return c.a.createElement(Ht,{key:e.id,flattenFloorComments:t,isRootComment:!e.parent_id,comment:e,commentableType:r,getViewEngine:n,target:o,useMiniGuide:i,getDefaultSuggestions:u,disableYuqueCardEmbedView:l,group:s,me:f,canComment:p,dispatch:g,onReplyToComment:d,onCreateComment:h,onEditComment:y,onRemoveComment:v,onUpdateComment:b,litecomment:w,isMiniSize:_,urlHash:T,currentCommentId:E,isMobile:O,reverseReplyButton:S})})))}or.defaultProps={onReplyToComment:function(){},onEditComment:function(){},onCreateComment:function(){},onRemoveComment:function(){},onUpdateComment:function(){},getViewEngine:function(){}},or.propTypes={flattenFloorComments:l.a.arrayOf(l.a.object),getViewEngine:l.a.func,commentableType:l.a.oneOf(b.a.TARGET_TYPES),target:l.a.object.isRequired,useMiniGuide:l.a.bool,getDefaultSuggestions:l.a.func,disableYuqueCardEmbedView:l.a.bool,group:l.a.object.isRequired,me:l.a.object,canComment:l.a.bool,dispatch:l.a.func,onReplyToComment:l.a.func,onEditComment:l.a.func,onRemoveComment:l.a.func,onCreateComment:l.a.func,onUpdateComment:l.a.func,litecomment:l.a.object,isMiniSize:l.a.bool,currentCommentId:l.a.number,isMobile:l.a.bool,reverseReplyButton:l.a.bool};var ir=or;function ar(e){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ar(e)}function cr(){return cr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cr.apply(this,arguments)}function ur(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ur(Object(r),!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ur(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==ar(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ar(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fr(){fr=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,o){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),c=new j(o||[]);return n(a,"_invoke",{value:_(e,r,c)}),a}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f={};function p(){}function m(){}function d(){}var y={};u(y,i,(function(){return this}));var h=Object.getPrototypeOf,v=h&&h(h(C([])));v&&v!==t&&r.call(v,i)&&(y=v);var b=d.prototype=p.prototype=Object.create(y);function g(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function o(n,i,a,c){var u=s(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==ar(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){o("next",e,a,c)}),(function(e){o("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return o("throw",e,a,c)}))}c(u.arg)}var i;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){o(e,r,t,n)}))}return i=i?i.then(n,n):n()}})}function _(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return T()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return m.prototype=d,n(b,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:m,configurable:!0}),m.displayName=u(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},g(w.prototype),u(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=C,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function pr(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function mr(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){pr(i,n,o,a,c,"next",e)}function c(e){pr(i,n,o,a,c,"throw",e)}a(void 0)}))}}function dr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hr=f()("commnent_floor");function vr(e){var t=e.commentableType,r=e.target,n=e.group,o=e.me,c=e.litecomment.comments,u=e.canMentionMembers,l=e.dispatch,s=e.isMobile,f=dr(Object(a.useState)(!0),2),p=f[0],m=f[1],d=dr(Object(a.useState)(!1),2),y=d[0],h=d[1],g=dr(Object(a.useState)(0),2),_=g[0],E=g[1],O=dr(Object(a.useState)(""),2),S=O[0],j=O[1],C=dr(Object(a.useState)(null),2),T=C[0],P=C[1],R=Object(a.useRef)([]),k=Object(a.useContext)(U.a),L=function(){var e=document.querySelector("#scroll-to-comment");if(e){e.scrollIntoView();var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;window.scrollTo(0,t-40)}},x=function(){var e=mr(fr().mark((function e(){var i,a,c,s,f;return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e){var t;return"Review"===e.selection_type?!(![w.TYPE.REVIEW_APPROVAL,w.TYPE.REVIEW_REJECTION,w.TYPE.REVIEW_OPINION].includes(e.type)||!e.body)&&(e.body_asl=e.body,!0):!!((null==o?void 0:o.id)===e.user_id||null!=o&&o.isAdmin)||![D.STATUS.banned,D.STATUS.blocked].includes(null==e||null===(t=e.user)||void 0===t?void 0:t.status)},i={commentable_type:t,commentable_id:r.id,include_section:!0,include_to_user:!0,include_reactions:!0},y||m(!0),e.next=5,v.a.comments.floorComments(i,{useOriginResp:!0});case 5:a=e.sent,c=(c=a.data.comments).filter((function(e){return e.sub_comments=(e.sub_comments||[]).filter(s),s(e)})),f=c.reduce((function(e,t){var r;return e++,null===(r=t.sub_comments)||void 0===r||r.forEach((function(t){e++})),e}),0),l({type:"litecomment/updateModel",payload:{comments:c,commentCount:f}}),m(!1),h(!0),u&&(n.members.length>0||(hr("load members"),l({type:"group/getMembers",payload:{data:{group_id:n.id,with_invited:!1}}})));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=Object(a.useMemo)((function(){var e=null==c?void 0:c.filter((function(e){var t;return e.comment_area&&(null===(t=e.comment_area)||void 0===t?void 0:t.rect)}));return e?(e.forEach((function(e,t){e.order=t+1})),c.sort((function(e,t){return new Date(e.created_at)-new Date(t.created_at)}))):c}),[c]),N=Object(a.useMemo)((function(){var e=A.reduce((function(e,t){var r;return e.push(t),null===(r=t.sub_comments)||void 0===r||r.forEach((function(t){e.push(t)})),e}),[]);return R.current=e,e}),[A]),M=function(){var t=i()(N,e.pageSize).length;E(t)};return Object(a.useEffect)((function(){function e(){return(e=mr(fr().mark((function e(){return fr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),m(!1);case 8:null==k||k.on("broadcast",(function(e){var t=e.type,r=e.body;if(t===G.a.MESSAGE.REACTION_UPDATE){var n=r.reactionAction,o=n.actionType,i=n.userId,a=n.actionOption,c=r.comment,u=N.find((function(e){return e.id===c.id}));if(u){var s=u.reactions||[],f=s;"create"===o?(f=s.filter((function(e){return e.user_id!==i}))).push({user_id:i,action_type:"reaction",action_option:a}):"delete"===o&&(f=s.filter((function(e){return e.user_id!==i}))),l({type:"litecomment/updateOne",payload:lr(lr({},u),{},{reactions:f})})}}else if(t===G.a.MESSAGE.COMMENT_CREATE){if(R.current.find((function(e){return e.id===r.comment.id})))return;l({type:"litecomment/create",payload:{data:r.comment,commentListStyle:"floor",insertToBottom:!0}})}else t===G.a.MESSAGE.COMMENT_UPDATE?l({type:"litecomment/updateOne",payload:r.comment}):t===G.a.MESSAGE.COMMENT_DELETE&&l({type:"litecomment/remove",payload:r.comment})}));case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){null==k||k.reset()}}),[]),{state:{loading:p,loaded:y,pageNo:_,flattenFloorComments:N,bottomEditorPlaceholder:S,replyToComment:T,commentCollab:k},setBottomEditorPlaceHolder:j,setReplyToComment:P,setPageNo:E,getDefaultSuggestions:function(){return b.a.getParticipants(r,N,{groupMembers:n.members,targetType:t})},handleCreateRootComment:function(t){l({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==k||k.createComment(t),M(),"mini"===e.size&&L(),e.onCreate&&e.onCreate(t)},handleCreateReplyToComment:function(t){t.to_user=null==T?void 0:T.user,l({type:"litecomment/create",payload:{data:t,showEditorAtBottom:!0,commentListStyle:"floor"}}),null==k||k.createComment(t),M(),e.onCreate&&e.onCreate(t),s&&setTimeout((function(){var e=document.querySelector("#comment-".concat(t.id));null==e||e.scrollIntoView({behavior:"smooth",block:"center"})}),100)},renderAllComments:M,scrollToEditor:L}}function br(e){var t,r,o=e.group,u=e.book,l=e.doc,s=e.target,f=e.commentableType,p=e.canComment,d=e.useMiniGuide,y=e.size,v=e.withAreaSelection,b=e.cancelable,g=e.onCancelCreate,w=e.dispatch,_=e.litecomment,E=void 0===_?{}:_,O=E.areaCommenting,S=void 0!==O&&O,j=E.currentCommentId,C=e.me,T=e.isMobile,P=e.getViewEngine,R=e.openInfiniteScroll,k=e.pageSize,L=e.onCommentLoaded,x=e.commentTipText,A=e.reverseReplyButton,N=dr(Object(a.useState)(!1),2),M=N[0],D=N[1],U=dr(Object(a.useState)(!1),2),G=U[0],q=U[1],B=Object(a.useRef)(null),V=Object(a.useRef)(!1),Y=vr(e),z=Y.state,H=z.loading,W=z.pageNo,K=z.flattenFloorComments,$=z.bottomEditorPlaceholder;Object(a.useEffect)((function(){H||V.current||(V.current=!0,null==L||L())}),[H,L]);var J=F.a.isPrivate(l,u,o),Z=c.a.createRef(),Q=function(e){Z&&Z.current&&(Y.setReplyToComment(e),R&&(Y.renderAllComments(),q(!0)),Y.setBottomEditorPlaceHolder(__("回复 {user}",{user:e.user.name})),Z.current.handleReplyTo(e.id),Y.scrollToEditor())},X=function(){var e=document.querySelector("#lark-mini-editor");e&&e.scrollIntoView({block:"center"})};if(Object(a.useEffect)((function(){e.focusToEditor&&Z&&Z.current&&Z.current.focusEditor()}),[e.focusToEditor]),Object(a.useEffect)((function(){M||e.onEditorReady&&Z&&Z.current&&(D(!0),e.onEditorReady(Z.current))}),[Z]),Object(a.useEffect)((function(){var e;G&&(X(),null==Z||null===(e=Z.current)||void 0===e||e.focusEditor())}),[G]),Object(a.useImperativeHandle)(e.forwardedRef,(function(){return{renderAllComments:Y.renderAllComments}})),H)return c.a.createElement(n.a,{justify:"block"});var ee="mini"===y||T,te=ee&&d,re=i()(K,k).length,ne=K.slice(0,k*(W+1));return c.a.createElement("div",{className:m()((t={},sr(t,Wt,!ee),sr(t,$t,ee),t),"comment-floor-mini"),ref:B},R?c.a.createElement(h.a,{loadMore:function(){Y.setPageNo(W+1)},hasMore:W<re,useWindow:"mini"!==y,getScrollParent:function(){return B.current}},c.a.createElement(ir,{comments:ne,flattenFloorComments:K,me:C,group:o,target:s,commentableType:f,currentCommentId:j,isMiniSize:ee,useMiniGuide:d,disableYuqueCardEmbedView:!J,canComment:p,getViewEngine:P,getDefaultSuggestions:Y.getDefaultSuggestions,onReplyToComment:Q,onEditComment:X,onRemoveComment:e.onRemove,onCreateComment:e.onCreate,dispatch:w,editorAffixed:te,isMobile:T,areaCommenting:S,cancelable:b,onCancelCreate:g,litecomment:e.litecomment,reverseReplyButton:A})):c.a.createElement(ir,{comments:K,flattenFloorComments:K,me:C,group:o,target:s,commentableType:f,currentCommentId:j,isMiniSize:ee,useMiniGuide:d,disableYuqueCardEmbedView:!J,canComment:p,getViewEngine:P,getDefaultSuggestions:Y.getDefaultSuggestions,onReplyToComment:Q,onEditComment:X,onRemoveComment:e.onRemove,onCreateComment:e.onCreate,dispatch:w,editorAffixed:te,isMobile:T,areaCommenting:S,cancelable:b,onCancelCreate:g,litecomment:e.litecomment,reverseReplyButton:A}),te&&!K.length&&c.a.createElement("div",{className:Jt},__("暂无回复")),c.a.createElement("div",{id:"scroll-to-comment"}),c.a.createElement("div",{className:m()(Kt,(r={},sr(r,Zt,te),sr(r,Qt,T),r))},c.a.createElement(I,{ref:Z,disableYuqueCardEmbedView:!J,group:o,target:s,targetType:f,comments:K,litecomment:e.litecomment,useMiniGuide:d,canComment:p,onCreate:T?Y.handleCreateReplyToComment:Y.handleCreateRootComment,getDefaultSuggestions:Y.getDefaultSuggestions,isMiniSize:ee,editorAffixed:te,withAreaSelection:v,dispatch:w,areaCommenting:S,cancelable:b,onCancelCreate:g,me:C,showReply:T,placeholder:$,onCloseReply:function(){Y.setBottomEditorPlaceHolder("")},commentTipText:x})))}br.defaultProps={canComment:!0,canMentionMembers:!1,useMiniGuide:!1,size:"default",me:window.appData.me,isMobile:window.h5,openInfiniteScroll:!1,pageSize:15},br.propTypes={commentableType:l.a.oneOf(b.a.TARGET_TYPES),group:l.a.object.isRequired,book:l.a.object,doc:l.a.object,target:l.a.object.isRequired,canMentionMembers:l.a.bool,cancelable:l.a.bool,onCancelCreate:l.a.func,useMiniGuide:l.a.bool,onCreate:l.a.func,onRemove:l.a.func,focusToEditor:l.a.bool,canComment:l.a.bool,size:l.a.oneOf(["default","mini"]),withAreaSelection:l.a.bool,litecomment:l.a.object,onEditorReady:l.a.func,me:l.a.object,isMobile:l.a.bool,dispatch:l.a.func,getViewEngine:l.a.func,openInfiniteScroll:l.a.bool,pageSize:l.a.number,onCommentLoaded:l.a.func,commentTipText:l.a.string,reverseReplyButton:l.a.boolean};Object(d.d)((function(e){return{litecomment:e.litecomment}}))(br);var gr=Object(d.d)((function(e){return{litecomment:e.litecomment,group:e.group}}))(br);t.a=Object(a.forwardRef)((function(e,t){return c.a.createElement(gr,cr({},e,{forwardedRef:t}))}))},3073:function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(2909),a=r(2),c=r.n(a),u=function(e){var t,r=e.type,n=void 0===r?"Doc":r,a=e.target,c=e.style;return n&&a&&window.appData.isYuque?((null===(t=window.appData)||void 0===t?void 0:t.settings)||{}).disable_ip_region_model?null:(Object(i.a)()||Object(i.b)())&&("Doc"!==n||a.first_published_at)&&a.region?o.a.createElement("span",{style:c},__("IP 属地"),a.region||__("未知")):null:null};u.propTypes={target:c.a.object.isRequired,type:c.a.string},t.a=u},3255:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),i=r(2),a=r.n(i),c=r(9),u=r.n(c),l=r(570),s=r(30),f=r(3066),p=r(147),m=r(2975),d=r(264),y={commmentHeader:"ReaderComment-module_commmentHeader_U8YZ5",mobileCommmentHeaderWrapper:"ReaderComment-module_mobileCommmentHeaderWrapper_MxoIa",mobileCommmentHeader:"ReaderComment-module_mobileCommmentHeader_O2gLE",count:"ReaderComment-module_count_6syjv",replayBtn:"ReaderComment-module_replayBtn_YG364",text:"ReaderComment-module_text_E5A0E",commentFloorContainer:"ReaderComment-module_commentFloorContainer_hYRys",mobileCommentFloorContainer:"ReaderComment-module_mobileCommentFloorContainer_6CVJy",header:"ReaderComment-module_header_9Ej69",headerTitle:"ReaderComment-module_headerTitle_MaqXh",headerBtn:"ReaderComment-module_headerBtn_YdQfC",mobile:"ReaderComment-module_mobile_f+LqA"};function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function v(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===h(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w=function(e){var t,r,i=e.target,a=e.isShare,c=e.group,l=e.book,p=e.withCornerBubble,h=e.getViewEngine,g=e.onRemoveComment,w=e.onCreateComment,_=e.litecomment,E=e.autoScrollToComment,O=a?"share":"read",S=null===(t=window.location.hash)||void 0===t?void 0:t.match(/#comment-(\d+)/),j=S?S[1]:void 0,C=!!j,T=!C,P=b(Object(n.useState)(!1),2),R=P[0],k=P[1],L=Object(n.useRef)(),x=function(){var e=document.querySelector("#lark-mini-editor");e?(T&&L.current&&L.current.renderAllComments(),e.scrollIntoView(),k(!0)):document.querySelector("#scroll-to-comment").scrollIntoView()},A=_.commentCount>0?o.a.createElement("div",{className:y.commmentHeader},__("所有评论（{count}）",{count:_.commentCount})):null,N=_.commentCount>0?o.a.createElement("div",{className:y.mobileCommmentHeaderWrapper},o.a.createElement("div",{className:y.mobileCommmentHeader},o.a.createElement("span",{className:y.count},__("所有评论（{count}）",{count:_.commentCount})),o.a.createElement("a",{className:y.replayBtn,onClick:x},o.a.createElement(s.b,{name:"edit-border",width:20}),o.a.createElement("span",{className:y.text},__("回复"))))):null,M=window.h5,I=o.a.createElement("div",{className:y.wrapper},M?N:A,o.a.createElement("div",{className:u()((r={},v(r,y.mobileCommentFloorContainer,M),v(r,y.commentFloorContainer,!M),r))},o.a.createElement(f.a,{ref:L,key:i.id,commentableType:e.targetType,target:e.target,group:c,book:l,doc:i,canMentionMembers:d.a.canMentionMembers(O,{group:c}),onCreate:w,onRemove:g,canComment:d.a.canPostCommentToDoc(i),focusToEditor:R,getViewEngine:h,openInfiniteScroll:T,onCommentLoaded:function(){E&&j&&setTimeout((function(){var e=document.querySelector("#comment-".concat(j));null==e||e.scrollIntoView(!0)}),1e3)}})),p&&o.a.createElement(m.a,{iconName:"comment-bubble",style:{bottom:"86px"},onClick:x,count:_.commentCount>0?_.commentCount:0})),D=b(Object(n.useState)(C?I:null),2),F=D[0],U=D[1];return Object(n.useEffect)((function(){U(I)}),[R]),Object(n.useEffect)((function(){U(I)}),[_.commentCount]),o.a.createElement(o.a.Fragment,null,F)};w.defaultProps={isShare:!1,onCreateComment:function(){},onRemoveComment:function(){}},w.propTypes={target:a.a.object.isRequired,litecomment:a.a.object.isRequired,targetType:a.a.oneOf(["Doc","DocVersion"]).isRequired,book:a.a.object.isRequired,group:a.a.object.isRequired,autoScrollToComment:a.a.bool,isShare:a.a.bool,onCreateComment:a.a.func,onRemoveComment:a.a.func,withCornerBubble:a.a.bool,getViewEngine:a.a.func};t.default=Object(p.b)(Object(l.d)((function(e){return{litecomment:e.litecomment}}))(w),!0)},970:function(e,t,r){"use strict";var n=r(0),o=r.n(n),i=r(570),a=r(2),c=r.n(a),u=r(1356),l=r(471);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===s(i)?i:String(i)),n)}var o,i}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var t,r,n,i=d(a);function a(){return f(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e=this.props,t=e.me,r=e.children,n=e.place,i=e.registerWithScene;return!window.appData.isYuque||t&&t.id?r:"comment"===n?o.a.createElement("div",{className:"comment-action"},__("{registerLogin} 语雀进行评论",{registerLogin:o.a.createElement("a",{onClick:function(){l.a.login()},"data-aspm-click":"d65962"},__("注册 / 登录"))})):o.a.createElement("div",{className:"login-action"},o.a.createElement(u.default.Login,{registerWithScene:i}))}}])&&p(t.prototype,r),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.Component);v.propTypes={me:c.a.object,place:c.a.string,children:c.a.node,registerWithScene:c.a.bool};t.a=Object(i.d)((function(e){return{me:e.me}}))(v)}}]);